{
  "timestamp": "2025-06-06T01:02:11.130Z",
  "tests": {
    "total": 0,
    "passed": 0,
    "failed": 0,
    "passRate": 0,
    "coverage": 0,
    "duration": 0,
    "error": "Command failed: npm run test:unit -- --json --outputFile=test-results.json\nPASS tests/unit/ingestion/handlers/DynamicUnstructuredSourceHandler.test.js (10.573 s)\n  DynamicUnstructuredSourceHandler\n    Configuration Validation\n      ✓ should validate valid configuration (1 ms)\n      ✓ should reject configuration without targets (12 ms)\n      ✓ should reject configuration with empty targets array (1 ms)\n      ✓ should validate target configurations (1 ms)\n      ✓ should validate selector configurations (1 ms)\n    Initialization\n      ✓ should initialize successfully with valid configuration (1 ms)\n      ✓ should handle browser initialization failure\n    Discovery\n      ✓ should discover articles from target sites (4020 ms)\n      ✓ should handle pagination (3009 ms)\n      ✓ should respect robots.txt when enabled (4 ms)\n      ✓ should handle discovery errors gracefully (3 ms)\n    Content Extraction\n      ✓ should extract article content using selectors (3 ms)\n      ✓ should handle missing content elements (2 ms)\n      ✓ should handle extraction errors (3 ms)\n      ✓ should apply content filters (2 ms)\n    Content Transformation\n      ✓ should transform extracted content (2 ms)\n      ✓ should handle missing title in metadata (1 ms)\n    Selector Evaluation\n      ✓ should evaluate selectors correctly (1 ms)\n    Pagination Handling\n      ✓ should handle pagination correctly (2004 ms)\n      ✓ should respect maxPages limit (1006 ms)\n    Helper Methods\n      ✓ should generate document ID from URL (3 ms)\n      ✓ should clean extracted content (4 ms)\n      ✓ should validate content against filters (2 ms)\n      ✓ should check robots.txt compliance (3 ms)\n      ✓ should count words correctly (4 ms)\n      ✓ should apply delay between requests (103 ms)\n    Cleanup\n      ✓ should cleanup browser resources (4 ms)\n      ✓ should handle cleanup when browser not initialized (2 ms)\n\nPASS tests/unit/enrichment/providers/AnthropicProvider.test.js (7.277 s)\n  AnthropicProvider\n    constructor\n      ✓ should throw error without API key (5 ms)\n      ✓ should initialize with API key\n      ✓ should use default configuration (2 ms)\n      ✓ should use custom configuration (1 ms)\n    getSupportedModels\n      ✓ should return list of supported models\n    calculateCost\n      ✓ should calculate cost for claude-3-sonnet (1 ms)\n      ✓ should calculate cost for claude-3-haiku\n      ✓ should calculate cost for claude-3-opus\n      ✓ should throw error for unsupported model\n      ✓ should handle fractional costs correctly (1 ms)\n    complete\n      ✓ should complete successfully with default model (1 ms)\n      ✓ should complete with custom model and options (2 ms)\n      ✓ should throw error for unsupported model (1 ms)\n      ✓ should retry on retryable errors (1003 ms)\n      ✓ should not retry on non-retryable errors (3 ms)\n      ✓ should fail after max retries (3006 ms)\n      ✓ should increment request and error counters (3005 ms)\n      ○ skipped should handle timeout\n    makeRequest\n      ✓ should make request with correct headers (3 ms)\n      ✓ should handle HTTP errors (2 ms)\n      ✓ should handle network errors (2 ms)\n    isNonRetryableError\n      ✓ should identify non-retryable status codes (5 ms)\n      ✓ should identify non-retryable error types (5 ms)\n      ✓ should identify retryable errors (1 ms)\n\nPASS tests/unit/enrichment/providers/OpenAIProvider.test.js (7.192 s)\n  OpenAIProvider\n    constructor\n      ✓ should throw error without API key (5 ms)\n      ✓ should initialize with API key (1 ms)\n      ✓ should use default configuration\n      ✓ should use custom configuration (1 ms)\n    getSupportedModels\n      ✓ should return list of supported models\n    calculateCost\n      ✓ should calculate cost for gpt-4-turbo (2 ms)\n      ✓ should calculate cost for gpt-3.5-turbo (1 ms)\n      ✓ should throw error for unsupported model\n      ✓ should handle fractional costs correctly (1 ms)\n    complete\n      ✓ should complete successfully with default model (1 ms)\n      ✓ should complete with custom model and options (1 ms)\n      ✓ should throw error for unsupported model (1 ms)\n      ✓ should retry on retryable errors (1002 ms)\n      ✓ should not retry on non-retryable errors (3 ms)\n      ✓ should fail after max retries (3006 ms)\n      ✓ should increment request and error counters (3007 ms)\n      ○ skipped should handle timeout\n    makeRequest\n      ✓ should make request with correct headers (3 ms)\n      ✓ should handle HTTP errors (2 ms)\n      ✓ should handle network errors (2 ms)\n    isNonRetryableError\n      ✓ should identify non-retryable status codes (1 ms)\n      ✓ should identify retryable status codes (1 ms)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.717Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.726Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 10000,\n        complexityThreshold: 0.7,\n        costThreshold: 0.1,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 10\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.727Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.729Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.730Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.731Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.731Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.731Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.732Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.732Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.733Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.734Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.734Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.734Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.735Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.735Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.735Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.736Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.736Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.736Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.737Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.738Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.739Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.739Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.739Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.740Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.740Z] INFO: Processing strategy selected\u001b[0m {\n      strategy: 'monolithic',\n      analysis: {\n        size: 500,\n        complexity: 0.3,\n        sensitivity: 0,\n        estimatedCost: 0.01,\n        estimatedLatency: 1000\n      },\n      constraints: {\n        maxCost: Infinity,\n        maxLatency: Infinity,\n        requiresLocalProcessing: false\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.740Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.741Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.741Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.741Z] INFO: Processing strategy selected\u001b[0m {\n      strategy: 'chunked',\n      analysis: {\n        size: 2000,\n        complexity: 0.4,\n        sensitivity: 0,\n        estimatedCost: 0.03,\n        estimatedLatency: 2000\n      },\n      constraints: {\n        maxCost: Infinity,\n        maxLatency: Infinity,\n        requiresLocalProcessing: false\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.742Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.742Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.742Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.743Z] INFO: Processing strategy selected\u001b[0m {\n      strategy: 'agent',\n      analysis: {\n        size: 800,\n        complexity: 0.8,\n        sensitivity: 0,\n        estimatedCost: 0.02,\n        estimatedLatency: 1500\n      },\n      constraints: {\n        maxCost: Infinity,\n        maxLatency: Infinity,\n        requiresLocalProcessing: false\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.743Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.743Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.743Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.744Z] INFO: Processing strategy selected\u001b[0m {\n      strategy: 'monolithic',\n      analysis: {\n        size: 500,\n        complexity: 0.3,\n        sensitivity: 2,\n        estimatedCost: 0.01,\n        estimatedLatency: 1000\n      },\n      constraints: {\n        maxCost: Infinity,\n        maxLatency: Infinity,\n        requiresLocalProcessing: true\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.744Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.744Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.744Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.745Z] INFO: Processing strategy selected\u001b[0m {\n      strategy: 'monolithic',\n      analysis: {\n        size: 500,\n        complexity: 0.3,\n        sensitivity: 0,\n        estimatedCost: 0.1,\n        estimatedLatency: 1000\n      },\n      constraints: {\n        maxCost: Infinity,\n        maxLatency: Infinity,\n        requiresLocalProcessing: false\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.745Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.745Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.746Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.746Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.746Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.747Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.747Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.747Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.747Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.749Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.749Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.749Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.750Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.750Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.750Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.751Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.751Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.751Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.751Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.752Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.752Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.752Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.753Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.753Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.753Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.754Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.754Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.754Z] INFO: Processing strategy selected\u001b[0m {\n      strategy: 'agent',\n      analysis: {\n        size: 24,\n        complexity: 0.5024,\n        sensitivity: 0,\n        contentType: 'text',\n        estimatedCost: 0.00018028800000000002,\n        estimatedLatency: 47.54689256239524\n      },\n      constraints: {\n        maxCost: Infinity,\n        maxLatency: Infinity,\n        requiresLocalProcessing: false\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.754Z] INFO: Processing completed successfully\u001b[0m {\n      processId: 'proc_1749171756754_ifqyz7vt2',\n      strategy: 'agent',\n      processingTime: 0,\n      documentId: 'test-1'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.755Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.755Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.755Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.755Z] INFO: Processing strategy selected\u001b[0m {\n      strategy: 'monolithic',\n      analysis: {\n        size: 13,\n        complexity: 0.4013,\n        sensitivity: 0,\n        contentType: 'text',\n        estimatedCost: 0.0000910845,\n        estimatedLatency: 23.28278766547623\n      },\n      constraints: {\n        maxCost: Infinity,\n        maxLatency: Infinity,\n        requiresLocalProcessing: false\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.756Z] INFO: Processing completed successfully\u001b[0m {\n      processId: 'proc_1749171756755_vyzgqo1th',\n      strategy: 'monolithic',\n      processingTime: 0,\n      documentId: 'test-1'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.756Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.756Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.756Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.756Z] INFO: Processing strategy selected\u001b[0m {\n      strategy: 'monolithic',\n      analysis: {\n        size: 13,\n        complexity: 0.4013,\n        sensitivity: 0,\n        contentType: 'text',\n        estimatedCost: 0.0000910845,\n        estimatedLatency: 23.28278766547623\n      },\n      constraints: {\n        maxCost: Infinity,\n        maxLatency: Infinity,\n        requiresLocalProcessing: false\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:36.757Z] ERROR: Processing failed\u001b[0m {\n      processId: 'proc_1749171756757_43nbx3izh',\n      strategy: 'monolithic',\n      processingTime: 0,\n      documentId: 'test-1',\n      error: 'Provider error'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.761Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.761Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.762Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.762Z] INFO: Processing strategy selected\u001b[0m {\n      strategy: 'monolithic',\n      analysis: {\n        size: 13,\n        complexity: 0.4013,\n        sensitivity: 0,\n        contentType: 'text',\n        estimatedCost: 0.0000910845,\n        estimatedLatency: 23.28278766547623\n      },\n      constraints: {\n        maxCost: Infinity,\n        maxLatency: Infinity,\n        requiresLocalProcessing: false\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.762Z] INFO: Processing completed successfully\u001b[0m {\n      processId: 'proc_1749171756762_sd9s1ts4h',\n      strategy: 'monolithic',\n      processingTime: 0,\n      documentId: 'test-1'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.763Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.763Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.763Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.764Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.764Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.764Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.765Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.765Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.765Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.766Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.766Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.766Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.766Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.767Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.767Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.767Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.767Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.768Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.768Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.768Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.768Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.769Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.769Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.769Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.770Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.770Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.770Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.770Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.771Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.771Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.772Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.772Z] INFO: Hybrid processing manager initialized\u001b[0m {\n      strategies: [ 'monolithic', 'chunked', 'agent', 'hybrid' ],\n      config: {\n        documentSizeThreshold: 1000,\n        complexityThreshold: 0.5,\n        costThreshold: 0.05,\n        maxConcurrentLocal: 2,\n        maxConcurrentCloud: 5\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:36.772Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:37.774Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:37.776Z] INFO: Shutting down hybrid processing manager\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:37.777Z] INFO: Hybrid processing manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/enrichment/HybridProcessingManager.test.js\n  HybridProcessingManager\n    initialization\n      ✓ should initialize with default configuration (13 ms)\n      ✓ should initialize with custom configuration (1 ms)\n      ✓ should initialize strategy usage metrics (2 ms)\n    document analysis\n      ✓ should analyze simple document correctly (1 ms)\n      ✓ should detect code content type (1 ms)\n      ✓ should detect markdown content type (1 ms)\n      ✓ should calculate complexity based on document characteristics (2 ms)\n      ✓ should determine sensitivity from metadata (1 ms)\n    strategy selection\n      ✓ should select monolithic strategy for simple documents (1 ms)\n      ✓ should select chunked strategy for large documents (1 ms)\n      ✓ should select agent strategy for complex documents (1 ms)\n      ✓ should enforce local processing for sensitive data (1 ms)\n      ✓ should consider cost constraints in strategy selection (1 ms)\n    provider routing\n      ✓ should route to local providers for sensitive data\n      ✓ should route to cloud providers for non-sensitive data (1 ms)\n      ✓ should allocate appropriate resources based on strategy (2 ms)\n    monolithic processing\n      ✓ should execute monolithic processing successfully (1 ms)\n    chunked processing\n      ✓ should split document into chunks and process them (2 ms)\n    agent processing\n      ✓ should execute multi-step agent processing (1 ms)\n    hybrid processing\n      ✓ should analyze sections and apply different strategies (1 ms)\n    full processing workflow\n      ✓ should complete full processing workflow for simple document (1 ms)\n      ✓ should emit processing events (1 ms)\n      ✓ should handle processing failures gracefully (5 ms)\n    resource management\n      ✓ should track resource usage correctly (1 ms)\n      ✓ should respect concurrency limits (1 ms)\n    metrics and recommendations\n      ✓ should provide processing metrics (1 ms)\n      ✓ should provide processing recommendations (1 ms)\n      ✓ should recommend latency optimization for slow processing (1 ms)\n    utility functions\n      ✓ should calculate document size correctly\n      ✓ should split documents into chunks correctly\n      ✓ should analyze document sections correctly (1 ms)\n      ✓ should generate unique process IDs (1 ms)\n    shutdown\n      ✓ should shutdown gracefully (2 ms)\n      ✓ should wait for active processes during shutdown (1006 ms)\n\nPASS tests/unit/enrichment/FailoverManager.test.js\n  FailoverManager\n    Constructor and Initialization\n      ✓ should initialize with default configuration (2 ms)\n      ✓ should initialize with custom configuration\n      ✓ should initialize provider states when providers are set (2 ms)\n    Provider Selection\n      ✓ should select providers based on score (1 ms)\n      ✓ should exclude specified providers\n      ✓ should exclude providers with open circuit breakers (1 ms)\n    Execution with Failover\n      ✓ should execute successfully with first provider (1 ms)\n      ✓ should failover to second provider when first fails (203 ms)\n      ✓ should throw error when all providers fail (15 ms)\n      ✓ should emit events during execution (1 ms)\n    Retry Logic\n      ✓ should retry on retryable errors (204 ms)\n      ✓ should not retry on non-retryable errors (3 ms)\n      ✓ should calculate retry delay with exponential backoff (2 ms)\n    Circuit Breaker\n      ✓ should open circuit breaker after threshold failures (3 ms)\n      ✓ should transition to half-open after timeout (2 ms)\n      ✓ should close circuit breaker on successful execution (1 ms)\n    Health Monitoring\n      ✓ should perform health checks on providers (4 ms)\n      ✓ should restore unhealthy provider to healthy on successful health check (2 ms)\n      ✓ should handle health check failures gracefully (1 ms)\n    Performance Metrics\n      ✓ should record success metrics (2 ms)\n      ✓ should record failure metrics (1 ms)\n      ✓ should calculate provider reliability (1 ms)\n      ✓ should calculate average cost (2 ms)\n    Error Classification\n      ✓ should identify retryable errors correctly (1 ms)\n      ✓ should identify non-retryable errors correctly (1 ms)\n    Statistics and Reporting\n      ✓ should return comprehensive failover statistics (2 ms)\n      ✓ should track provider failure counts (2 ms)\n    Provider Scoring\n      ✓ should calculate provider scores based on performance (1 ms)\n      ✓ should penalize providers with recent failures (1 ms)\n    Shutdown\n      ✓ should clear health check intervals on shutdown\n    Event Emission\n      ✓ should emit circuit breaker opened event (1 ms)\n      ✓ should emit provider recovered event (1 ms)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.575Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.577Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.578Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.578Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.578Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.579Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.579Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.579Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.580Z] INFO: Starting sequential performance benchmark\u001b[0m { queryCount: 2, iterations: 1 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.580Z] INFO: Sequential benchmark completed successfully\u001b[0m { totalQueries: 2, averageTime: 0 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.581Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.581Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.581Z] INFO: Starting sequential performance benchmark\u001b[0m { queryCount: 2, iterations: 1 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.582Z] INFO: Sequential benchmark completed successfully\u001b[0m { totalQueries: 2, averageTime: 0 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.584Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.584Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.585Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.585Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.585Z] INFO: Starting parallel performance benchmark\u001b[0m { queryCount: 2, iterations: 1 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.586Z] INFO: Parallel performance benchmark completed\u001b[0m { totalQueries: 2, averageTime: 0 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.586Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.587Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.587Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.587Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.587Z] INFO: Starting parallel performance benchmark\u001b[0m { queryCount: 0, iterations: 1 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:38.587Z] ERROR: Parallel performance benchmark failed:\u001b[0m Error: Parallel Search Manager not available\n        at PerformanceBenchmark.benchmarkParallelSearch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/PerformanceBenchmark.js:418:13)\n        at PerformanceBenchmark.benchmarkParallelSearch [as runParallelBenchmark] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/PerformanceBenchmark.js:214:38)\n        at Object.runParallelBenchmark (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/PerformanceBenchmark.test.js:187:19)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.589Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.589Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.589Z] INFO: Starting comparison performance benchmark\u001b[0m { queryCount: 1, iterations: 1 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.590Z] INFO: Comparison benchmark completed successfully\u001b[0m { performanceImprovement: 0 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.590Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.590Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.591Z] INFO: Starting comparison performance benchmark\u001b[0m { queryCount: 1, iterations: 1 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.894Z] INFO: Comparison benchmark completed successfully\u001b[0m { performanceImprovement: 49 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.898Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.898Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.901Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.902Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.903Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.904Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.908Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.909Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.911Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.911Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.913Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.914Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.916Z] INFO: Initializing Performance Benchmark...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:38.916Z] INFO: Performance Benchmark initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/rag/performance/PerformanceBenchmark.test.js\n  PerformanceBenchmark\n    constructor\n      ✓ should initialize with required dependencies (1 ms)\n      ✓ should throw error without rag manager (9 ms)\n    initialize\n      ✓ should initialize successfully (4 ms)\n      ✓ should not initialize twice (1 ms)\n    runSequentialBenchmark\n      ✓ should run sequential benchmark successfully (2 ms)\n      ✓ should handle query errors in sequential benchmark (1 ms)\n      ✓ should throw error if not initialized (2 ms)\n    runParallelBenchmark\n      ✓ should run parallel benchmark successfully (1 ms)\n      ✓ should handle missing parallel search manager (2 ms)\n    runComparisonBenchmark\n      ✓ should run comparison benchmark successfully (2 ms)\n      ✓ should provide performance recommendations (306 ms)\n    analyzeTrends\n      ✓ should analyze performance trends (4 ms)\n      ✓ should handle insufficient data for trends (3 ms)\n    getBenchmarkHistory\n      ✓ should return benchmark history (2 ms)\n      ✓ should limit history size (5 ms)\n    clearBenchmarkHistory\n      ✓ should clear benchmark history (2 ms)\n    getStatus\n      ✓ should return status when not initialized (1 ms)\n      ✓ should return status when initialized (1 ms)\n      ✓ should indicate missing dependencies (1 ms)\n    shutdown\n      ✓ should shutdown gracefully (1 ms)\n      ✓ should handle shutdown when not initialized (1 ms)\n    performance calculations\n      ✓ should calculate throughput correctly (1 ms)\n      ✓ should calculate speedup factor correctly\n      ✓ should handle edge cases in calculations (1 ms)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.174Z] INFO: Getting source reliability score\u001b[0m { sourceId: 'source-1', recalculate: false, userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.185Z] INFO: Getting source reliability score\u001b[0m { sourceId: 'source-1', recalculate: false, userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.197Z] INFO: Getting source reliability score\u001b[0m { sourceId: 'nonexistent', recalculate: false, userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:39.198Z] ERROR: Failed to get source reliability score\u001b[0m {\n      sourceId: 'nonexistent',\n      error: 'Source not found',\n      userId: 'test-user-id'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.201Z] INFO: Getting source reliability score\u001b[0m { sourceId: 'source-1', recalculate: false, userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:39.202Z] ERROR: Failed to get source reliability score\u001b[0m {\n      sourceId: 'source-1',\n      error: 'Database connection failed',\n      userId: 'test-user-id'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.204Z] INFO: Getting all source reliability scores\u001b[0m {\n      page: 1,\n      limit: 50,\n      orderBy: 'overall_score',\n      order: 'desc',\n      reliabilityLevel: undefined,\n      userId: 'test-user-id'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.208Z] INFO: Getting all source reliability scores\u001b[0m {\n      page: 2,\n      limit: 10,\n      orderBy: 'reliability_level',\n      order: 'asc',\n      reliabilityLevel: undefined,\n      userId: 'test-user-id'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.211Z] INFO: Getting all source reliability scores\u001b[0m {\n      page: 1,\n      limit: 50,\n      orderBy: 'overall_score',\n      order: 'desc',\n      reliabilityLevel: 'high',\n      userId: 'test-user-id'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.220Z] INFO: Starting bulk reliability score calculation\u001b[0m { batchSize: 5, userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.221Z] INFO: Completed bulk reliability score calculation\u001b[0m {\n      result: {\n        totalSources: 5,\n        successfulUpdates: 4,\n        failedUpdates: 1,\n        errors: [ 'Error calculating source-5' ]\n      },\n      userId: 'test-user-id'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.225Z] INFO: Starting bulk reliability score calculation\u001b[0m { batchSize: 10, userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.226Z] INFO: Completed bulk reliability score calculation\u001b[0m {\n      result: { totalSources: 10, successfulUpdates: 10, failedUpdates: 0 },\n      userId: 'test-user-id'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.228Z] INFO: Starting bulk reliability score calculation\u001b[0m { batchSize: 10, userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:39.229Z] ERROR: Failed to calculate all reliability scores\u001b[0m { error: 'Batch calculation failed', userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.231Z] INFO: Getting source reliability breakdown\u001b[0m { sourceId: 'source-1', userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.234Z] INFO: Getting source reliability breakdown\u001b[0m { sourceId: 'source-1', userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.237Z] INFO: Getting reliability statistics\u001b[0m { userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.240Z] INFO: Getting reliability statistics\u001b[0m { userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.243Z] INFO: Updating source reliability score\u001b[0m { sourceId: 'source-1', timeframe: '60 days', userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.246Z] INFO: Updating source reliability score\u001b[0m { sourceId: 'source-1', timeframe: '30 days', userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.249Z] INFO: Updating source reliability score\u001b[0m {\n      sourceId: 'nonexistent',\n      timeframe: '30 days',\n      userId: 'test-user-id'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:39.250Z] ERROR: Failed to update source reliability score\u001b[0m {\n      sourceId: 'nonexistent',\n      error: 'Source not found',\n      userId: 'test-user-id'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.252Z] INFO: Getting source reliability trends\u001b[0m { sourceId: 'source-1', days: '90', userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.255Z] INFO: Getting source reliability trends\u001b[0m { sourceId: 'source-1', days: 90, userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:39.258Z] INFO: Getting source reliability trends\u001b[0m { sourceId: 'source-1', days: 90, userId: 'test-user-id' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nFAIL tests/unit/web/routes/reliability.test.js\n  Reliability Routes\n    GET /sources/:sourceId\n      ✓ should get existing reliability score (24 ms)\n      ✓ should calculate score if none exists (3 ms)\n      ✕ should force recalculation when requested (9 ms)\n      ✓ should handle source not found error (3 ms)\n      ✓ should handle service errors (3 ms)\n    GET /sources\n      ✓ should get all reliability scores with default pagination (3 ms)\n      ✓ should handle custom pagination parameters (4 ms)\n      ✓ should filter by reliability level (2 ms)\n    POST /calculate-all\n      ✓ should calculate reliability scores for all sources (10 ms)\n      ✓ should use default batch size if not provided (5 ms)\n      ✓ should handle calculation errors (3 ms)\n    GET /sources/:sourceId/breakdown\n      ✓ should get reliability score breakdown (3 ms)\n      ✓ should handle missing reliability score (3 ms)\n    GET /statistics\n      ✓ should get reliability statistics summary (3 ms)\n      ✓ should handle empty scores (3 ms)\n    PUT /sources/:sourceId\n      ✓ should update reliability score for specific source (2 ms)\n      ✓ should use default timeframe if not provided (3 ms)\n      ✓ should handle source not found error (4 ms)\n    GET /sources/:sourceId/trends\n      ✓ should get reliability trends for source (3 ms)\n      ✓ should handle missing reliability score for trends (3 ms)\n      ✓ should handle missing historical data (3 ms)\n    Error handling\n      ✓ should handle missing sourceReliabilityService dependency (89 ms)\n      ✓ should handle service initialization error (3 ms)\n    Permission requirements\n      ✓ should require read permission for GET endpoints\n      ✓ should require write permission for POST/PUT endpoints\n\n  ● Reliability Routes › GET /sources/:sourceId › should force recalculation when requested\n\n    expected 200 \"OK\", got 401 \"Unauthorized\"\n\n      101 |       const response = await request(app)\n      102 |         .get('/api/v1/reliability/sources/source-1?recalculate=true')\n    > 103 |         .expect(200);\n          |          ^\n      104 |\n      105 |       expect(response.body.success).toBe(true);\n      106 |       expect(response.body.data).toEqual(mockScore);\n\n      at Object.expect (tests/unit/web/routes/reliability.test.js:103:10)\n      ----\n      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)\n      at node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)\n\nPASS tests/unit/web/routes/review.test.js\n  Review Routes\n    GET /pending\n      ✓ should return pending documents from queue (11 ms)\n      ✓ should handle search and filter parameters (5 ms)\n      ✓ should handle errors from queue manager (4 ms)\n    GET /document/:id\n      ✓ should return document details from queue job (4 ms)\n      ✓ should handle document not found (7 ms)\n    POST /approve/:id\n      ✓ should approve document successfully (4 ms)\n      ✓ should require valid approval data (2 ms)\n    POST /reject/:id\n      ✓ should reject document successfully (3 ms)\n      ✓ should require rejection reason (2 ms)\n    POST /flag/:id\n      ✓ should flag document successfully (3 ms)\n      ✓ should require flag type (3 ms)\n    GET /stats\n      ✓ should return review statistics from queue (2 ms)\n    POST /bulk/flag\n      ✓ should bulk flag multiple documents (3 ms)\n      ✓ should handle partial failures in bulk flag (3 ms)\n      ✓ should return 400 if documentIds is not provided (2 ms)\n      ✓ should return 400 if type is not provided (2 ms)\n    POST /bulk/assign\n      ✓ should bulk assign multiple documents (2 ms)\n      ✓ should handle partial failures in bulk assign (2 ms)\n      ✓ should return 400 if documentIds is not provided (2 ms)\n      ✓ should return 400 if assignTo is not provided (2 ms)\n    POST /bulk/add-tags\n      ✓ should bulk add tags to multiple documents (2 ms)\n      ✓ should handle partial failures in bulk add tags (3 ms)\n      ✓ should return 400 if documentIds is not provided (3 ms)\n      ✓ should return 400 if tags is not provided (3 ms)\n    POST /bulk/remove-tags\n      ✓ should bulk remove tags from multiple documents (2 ms)\n      ✓ should handle partial failures in bulk remove tags (3 ms)\n      ✓ should return 400 if documentIds is not provided (2 ms)\n      ✓ should return 400 if tags is not provided (2 ms)\n\nPASS tests/unit/config/ConfigManager.test.js\n  ConfigManager\n    constructor\n      ✓ should initialize with default options (5 ms)\n      ✓ should initialize with custom options (2 ms)\n      ✓ should register default validators (1 ms)\n    validator registration\n      ✓ should register a new validator (1 ms)\n      ✓ should throw error for invalid validator registration (8 ms)\n    configuration file handling\n      ✓ should read JSON configuration file (3 ms)\n      ✓ should read JavaScript configuration file (5 ms)\n      ✓ should return null for non-existent file (2 ms)\n      ✓ should throw error for invalid JSON (2 ms)\n    configuration type detection\n      ✓ should detect sources configuration (1 ms)\n      ✓ should detect ingestion configuration (1 ms)\n      ✓ should detect queue configuration (2 ms)\n      ✓ should return null for unknown configuration type (1 ms)\n    configuration validation\n      ✓ should validate sources configuration (3 ms)\n      ✓ should validate ingestion configuration (1 ms)\n      ✓ should validate queue configuration (1 ms)\n      ✓ should reject invalid sources configuration (2 ms)\n      ✓ should handle missing validator gracefully (1 ms)\n    configuration loading\n      ✓ should load and validate configuration file (2 ms)\n      ✓ should emit config-changed event when loading (2 ms)\n    file watching\n      ✓ should start and stop watching (13 ms)\n      ✓ should not start watching if already watching (12 ms)\n      ✓ should handle file changes (2 ms)\n    configuration management\n      ✓ should get specific configuration (1 ms)\n      ✓ should get all configurations (1 ms)\n      ✓ should return undefined for non-existent configuration (2 ms)\n    statistics\n      ✓ should return configuration statistics (1 ms)\n    error handling\n      ✓ should handle watcher errors (1 ms)\n      ✓ should handle configuration change errors (2 ms)\n    directory management\n      ✓ should create config directory if it does not exist (2 ms)\n      ✓ should not fail if config directory already exists (1 ms)\n\nPASS tests/unit/web/routes/curation-workflow.test.js\n  Curation Workflow Routes\n    POST /start-review/:id\n      ✓ should start review workflow for a document (11 ms)\n      ✓ should return 404 if document not found (7 ms)\n    POST /bulk/approve\n      ✓ should bulk approve multiple documents (4 ms)\n      ✓ should handle errors for some documents in bulk operation (3 ms)\n      ✓ should return 400 if documentIds is not provided (4 ms)\n    POST /bulk/reject\n      ✓ should bulk reject multiple documents (4 ms)\n      ✓ should return 400 if reason is not provided (3 ms)\n    POST /bulk/start-review\n      ✓ should bulk start review for multiple documents (3 ms)\n    GET /workflow/status\n      ✓ should get workflow status for multiple documents (3 ms)\n      ✓ should return 400 if documentIds not provided (2 ms)\n    GET /workflow/metrics\n      ✓ should get workflow metrics (3 ms)\n    Error handling\n      ✓ should handle queue manager errors gracefully (2 ms)\n      ✓ should handle job update errors in bulk operations (2 ms)\n    Permission checks\n      ✓ should require appropriate permissions for each endpoint\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.185Z] ERROR: HTTP Error\u001b[0m {\n      error: 'Async error',\n      stack: 'Error: Async error\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/middleware/errorHandler.test.js:34:15\\n' +\n        '    at fn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/web/middleware/errorHandler.js:98:21)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:149:13)\\n' +\n        '    at Route.dispatch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:119:3)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:284:15\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at jsonParser (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/body-parser/lib/types/json.js:113:7)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at expressInit (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/init.js:40:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at query (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/query.js:45:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:175:3)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/application.js:181:10)\\n' +\n        '    at Server.app (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/express.js:39:9)\\n' +\n        '    at Server.emit (node:events:518:28)\\n' +\n        '    at parserOnIncoming (node:_http_server:1153:12)\\n' +\n        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:117:17)',\n      method: 'GET',\n      url: '/test',\n      ip: '::ffff:127.0.0.1',\n      userAgent: undefined,\n      body: {}\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.189Z] ERROR: HTTP Error\u001b[0m {\n      error: 'Promise rejection',\n      stack: 'Error: Promise rejection\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/middleware/errorHandler.test.js:49:31\\n' +\n        '    at fn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/web/middleware/errorHandler.js:98:21)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:149:13)\\n' +\n        '    at Route.dispatch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:119:3)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:284:15\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at jsonParser (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/body-parser/lib/types/json.js:113:7)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at expressInit (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/init.js:40:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at query (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/query.js:45:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:175:3)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/application.js:181:10)\\n' +\n        '    at Server.app (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/express.js:39:9)\\n' +\n        '    at Server.emit (node:events:518:28)\\n' +\n        '    at parserOnIncoming (node:_http_server:1153:12)\\n' +\n        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:117:17)',\n      method: 'GET',\n      url: '/test',\n      ip: '::ffff:127.0.0.1',\n      userAgent: undefined,\n      body: {}\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.192Z] ERROR: HTTP Error\u001b[0m {\n      error: 'Invalid input',\n      stack: 'ValidationError: Invalid input\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/middleware/errorHandler.test.js:66:23\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:149:13)\\n' +\n        '    at Route.dispatch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:119:3)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:284:15\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at jsonParser (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/body-parser/lib/types/json.js:113:7)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at expressInit (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/init.js:40:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at query (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/query.js:45:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:175:3)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/application.js:181:10)\\n' +\n        '    at Server.app (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/express.js:39:9)\\n' +\n        '    at Server.emit (node:events:518:28)\\n' +\n        '    at parserOnIncoming (node:_http_server:1153:12)\\n' +\n        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:117:17)',\n      method: 'GET',\n      url: '/test',\n      ip: '::ffff:127.0.0.1',\n      userAgent: undefined,\n      body: {}\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.195Z] ERROR: HTTP Error\u001b[0m {\n      error: 'Invalid credentials',\n      stack: 'AuthenticationError: Invalid credentials\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/middleware/errorHandler.test.js:82:23\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:149:13)\\n' +\n        '    at Route.dispatch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:119:3)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:284:15\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at jsonParser (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/body-parser/lib/types/json.js:113:7)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at expressInit (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/init.js:40:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at query (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/query.js:45:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:175:3)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/application.js:181:10)\\n' +\n        '    at Server.app (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/express.js:39:9)\\n' +\n        '    at Server.emit (node:events:518:28)\\n' +\n        '    at parserOnIncoming (node:_http_server:1153:12)\\n' +\n        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:117:17)',\n      method: 'GET',\n      url: '/test',\n      ip: '::ffff:127.0.0.1',\n      userAgent: undefined,\n      body: {}\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.199Z] ERROR: HTTP Error\u001b[0m {\n      error: 'Access denied',\n      stack: 'AuthorizationError: Access denied\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/middleware/errorHandler.test.js:98:23\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:149:13)\\n' +\n        '    at Route.dispatch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:119:3)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:284:15\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at jsonParser (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/body-parser/lib/types/json.js:113:7)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at expressInit (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/init.js:40:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at query (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/query.js:45:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:175:3)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/application.js:181:10)\\n' +\n        '    at Server.app (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/express.js:39:9)\\n' +\n        '    at Server.emit (node:events:518:28)\\n' +\n        '    at parserOnIncoming (node:_http_server:1153:12)\\n' +\n        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:117:17)',\n      method: 'GET',\n      url: '/test',\n      ip: '::ffff:127.0.0.1',\n      userAgent: undefined,\n      body: {}\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.203Z] ERROR: HTTP Error\u001b[0m {\n      error: 'Resource not found',\n      stack: 'NotFoundError: Resource not found\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/middleware/errorHandler.test.js:114:23\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:149:13)\\n' +\n        '    at Route.dispatch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:119:3)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:284:15\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at jsonParser (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/body-parser/lib/types/json.js:113:7)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at expressInit (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/init.js:40:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at query (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/query.js:45:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:175:3)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/application.js:181:10)\\n' +\n        '    at Server.app (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/express.js:39:9)\\n' +\n        '    at Server.emit (node:events:518:28)\\n' +\n        '    at parserOnIncoming (node:_http_server:1153:12)\\n' +\n        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:117:17)',\n      method: 'GET',\n      url: '/test',\n      ip: '::ffff:127.0.0.1',\n      userAgent: undefined,\n      body: {}\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.207Z] ERROR: HTTP Error\u001b[0m {\n      error: 'Something went wrong',\n      stack: 'Error: Something went wrong\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/middleware/errorHandler.test.js:130:23\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:149:13)\\n' +\n        '    at Route.dispatch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:119:3)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:284:15\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at jsonParser (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/body-parser/lib/types/json.js:113:7)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at expressInit (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/init.js:40:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at query (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/query.js:45:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:175:3)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/application.js:181:10)\\n' +\n        '    at Server.app (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/express.js:39:9)\\n' +\n        '    at Server.emit (node:events:518:28)\\n' +\n        '    at parserOnIncoming (node:_http_server:1153:12)\\n' +\n        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:117:17)',\n      method: 'GET',\n      url: '/test',\n      ip: '::ffff:127.0.0.1',\n      userAgent: undefined,\n      body: {}\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.209Z] ERROR: HTTP Error\u001b[0m {\n      error: 'Development error',\n      stack: 'Error: Development error\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/middleware/errorHandler.test.js:148:14\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:149:13)\\n' +\n        '    at Route.dispatch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:119:3)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:284:15\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at jsonParser (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/body-parser/lib/types/json.js:113:7)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at expressInit (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/init.js:40:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at query (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/query.js:45:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:175:3)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/application.js:181:10)\\n' +\n        '    at Server.app (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/express.js:39:9)\\n' +\n        '    at Server.emit (node:events:518:28)\\n' +\n        '    at parserOnIncoming (node:_http_server:1153:12)\\n' +\n        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:117:17)',\n      method: 'GET',\n      url: '/test',\n      ip: '::ffff:127.0.0.1',\n      userAgent: undefined,\n      body: {}\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.212Z] ERROR: HTTP Error\u001b[0m {\n      error: 'Production error',\n      stack: 'Error: Production error\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/middleware/errorHandler.test.js:168:14\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:149:13)\\n' +\n        '    at Route.dispatch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/route.js:119:3)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:284:15\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at jsonParser (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/body-parser/lib/types/json.js:113:7)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at expressInit (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/init.js:40:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at query (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/middleware/query.js:45:5)\\n' +\n        '    at Layer.handle [as handle_request] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/layer.js:95:5)\\n' +\n        '    at trim_prefix (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:328:13)\\n' +\n        '    at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:286:9\\n' +\n        '    at Function.process_params (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:346:12)\\n' +\n        '    at next (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:280:10)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/router/index.js:175:3)\\n' +\n        '    at Function.handle (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/application.js:181:10)\\n' +\n        '    at Server.app (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/express/lib/express.js:39:9)\\n' +\n        '    at Server.emit (node:events:518:28)\\n' +\n        '    at parserOnIncoming (node:_http_server:1153:12)\\n' +\n        '    at HTTPParser.parserOnHeadersComplete (node:_http_common:117:17)',\n      method: 'GET',\n      url: '/test',\n      ip: '::ffff:127.0.0.1',\n      userAgent: undefined,\n      body: {}\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/web/middleware/errorHandler.test.js\n  Error Handler Middleware\n    asyncHandler\n      ✓ should handle successful async operations (8 ms)\n      ✓ should catch async errors and pass to error handler (4 ms)\n      ✓ should handle rejected promises (5 ms)\n    errorHandler\n      ✓ should handle ValidationError with 400 status (3 ms)\n      ✓ should handle AuthenticationError with 401 status (3 ms)\n      ✓ should handle AuthorizationError with 403 status (4 ms)\n      ✓ should handle NotFoundError with 404 status (4 ms)\n      ✓ should handle generic errors with 500 status (3 ms)\n      ✓ should include error details in development mode (3 ms)\n      ✓ should hide error details in production mode (2 ms)\n    Custom Error Classes\n      ✓ should create ValidationError with correct properties (1 ms)\n      ✓ should create AuthenticationError with correct properties (1 ms)\n      ✓ should create AuthorizationError with correct properties\n      ✓ should create NotFoundError with correct properties\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:40.359Z] WARN: Authentication failed\u001b[0m { ip: '::ffff:127.0.0.1', userAgent: undefined, path: '/test' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:40.362Z] WARN: Authentication failed\u001b[0m { ip: '::ffff:127.0.0.1', userAgent: undefined, path: '/test' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:40.365Z] WARN: Authentication bypassed in development mode\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.373Z] ERROR: Permission check failed\u001b[0m {\n      userId: undefined,\n      permissionName: 'review:read',\n      resourceType: null,\n      resourceId: null,\n      error: \"Cannot read properties of null (reading 'connect')\"\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.383Z] ERROR: Permission check failed\u001b[0m {\n      userId: undefined,\n      permissionName: 'review:read',\n      resourceType: null,\n      resourceId: null,\n      error: \"Cannot read properties of null (reading 'connect')\"\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/web/middleware/auth.test.js\n  Authentication Middleware\n    authenticateRequest\n      ✓ should allow requests with valid API key (6 ms)\n      ✓ should reject requests without API key (4 ms)\n      ✓ should reject requests with invalid API key (2 ms)\n      ✓ should bypass authentication in development mode (3 ms)\n    requirePermission\n      ✓ should allow access with correct permission (3 ms)\n      ✓ should deny access without required permission (3 ms)\n      ✓ should deny access when user has no permissions (3 ms)\n    requireRole\n      ✓ should allow access with correct role (2 ms)\n      ✓ should deny access with incorrect role (2 ms)\n      ✓ should deny access when user has no role (2 ms)\n    utility functions\n      hasPermission\n        ✓ should return true for valid permission\n        ✓ should return false for invalid permission\n        ✓ should return false when user has no permissions (1 ms)\n      hasRole\n        ✓ should return true for correct role (1 ms)\n        ✓ should return false for incorrect role\n        ✓ should return false when user has no role\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:40.542Z] INFO: Fetching jobs\u001b[0m {\n      page: 1,\n      limit: 20,\n      status: 'all',\n      queue: 'all',\n      search: '',\n      userId: undefined\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:40.549Z] INFO: Fetching jobs\u001b[0m {\n      page: 2,\n      limit: 25,\n      status: 'failed',\n      queue: 'ingestion',\n      search: '',\n      userId: undefined\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:40.553Z] INFO: Fetching job details\u001b[0m { queueName: 'ingestion', jobId: 'job-1', userId: undefined }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:40.556Z] INFO: Fetching job details\u001b[0m { queueName: 'ingestion', jobId: 'nonexistent', userId: undefined }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:40.564Z] INFO: Retrying job\u001b[0m { queueName: 'ingestion', jobId: 'job-1', userId: undefined }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:40.564Z] INFO: Job retried successfully\u001b[0m { queueName: 'ingestion', jobId: 'job-1', userId: undefined }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:40.567Z] INFO: Retrying job\u001b[0m { queueName: 'ingestion', jobId: 'job-1', userId: undefined }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:40.569Z] INFO: Removing job\u001b[0m {\n      queueName: 'ingestion',\n      jobId: 'job-1',\n      force: false,\n      userId: undefined\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:40.570Z] INFO: Job removed successfully\u001b[0m {\n      queueName: 'ingestion',\n      jobId: 'job-1',\n      force: false,\n      userId: undefined\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:40.574Z] INFO: Removing job\u001b[0m {\n      queueName: 'ingestion',\n      jobId: 'job-1',\n      force: false,\n      userId: undefined\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:40.577Z] INFO: Fetching job overview statistics\u001b[0m { userId: undefined }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/web/routes/jobs.test.js\n  Jobs Routes\n    GET /\n      ✓ should return jobs list from queue manager (10 ms)\n      ✓ should handle query parameters correctly (5 ms)\n    GET /:queue/:jobId\n      ✓ should return job details (5 ms)\n      ✓ should handle job not found (6 ms)\n    POST /:queue/:jobId/retry\n      ✓ should retry failed job successfully (3 ms)\n      ✓ should handle retry errors (3 ms)\n    DELETE /:queue/:jobId\n      ✓ should remove job successfully (3 ms)\n      ✓ should handle removal errors (4 ms)\n    GET /stats/overview\n      ✓ should return queue statistics (3 ms)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:40.731Z] ERROR: Failed to fetch enrichment pipeline data\u001b[0m { error: 'Database error' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/web/routes/dashboard-enrichment.test.js\n  Dashboard Enrichment API\n    GET /api/dashboard/admin/data/enrichment\n      ✓ should return enrichment pipeline data with real statistics when available (10 ms)\n      ✓ should return fallback mock data when enrichment manager is not available (3 ms)\n      ✓ should return fallback mock data when dashboard manager is not available (3 ms)\n      ✓ should handle errors gracefully (2 ms)\n      ✓ should include all required pipeline stages (3 ms)\n      ✓ should include strategy information (3 ms)\n      ✓ should include provider performance data (2 ms)\n\nPASS tests/unit/enrichment/PromptVersionManager.test.js\n  PromptVersionManager\n    Constructor\n      ✓ should initialize with default configuration (1 ms)\n      ✓ should merge custom configuration\n      ✓ should initialize empty collections\n    initialize()\n      ✓ should initialize successfully with git enabled (1 ms)\n      ✓ should initialize without git when disabled\n      ✓ should load existing prompts during initialization (1 ms)\n      ✓ should handle initialization errors (7 ms)\n    savePrompt()\n      ✓ should save a new prompt successfully\n      ✓ should increment version for existing prompts (1 ms)\n      ✓ should extract variables from prompt content\n      ✓ should commit to git when autoCommit is enabled (1 ms)\n      ✓ should handle save errors\n    getPrompt()\n      ✓ should get latest prompt from cache\n      ✓ should return null for non-existent prompt\n      ✓ should get specific version from git (1 ms)\n      ✓ should handle get errors (2 ms)\n    generateNextVersion()\n      ✓ should return 1.0.0 for new prompts\n      ✓ should increment patch version\n      ✓ should handle missing version (1 ms)\n    extractVariables()\n      ✓ should extract variables from template strings\n      ✓ should handle duplicate variables (1 ms)\n      ✓ should return empty array for no variables (1 ms)\n      ✓ should handle non-string content\n    listPrompts()\n      ✓ should return list of prompt IDs\n      ✓ should return empty array when no prompts (1 ms)\n    getVersionHistory()\n      ✓ should return version history for prompt\n      ✓ should return empty array for unknown prompt\n    rollbackPrompt()\n      ✓ should rollback to previous version (1 ms)\n      ✓ should require git to be enabled\n    getStatistics()\n      ✓ should return system statistics (1 ms)\n      ✓ should handle empty system\n    shutdown()\n      ✓ should clean up resources (1 ms)\n      ✓ should emit shutdown event\n    Event Handling\n      ✓ should emit promptSaved event (2 ms)\n      ✓ should emit error events (2 ms)\n\nFAIL tests/unit/web/components/CurationBoard.test.js\n  ● Test suite failed to run\n\n    Jest encountered an unexpected token\n\n    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.\n\n    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.\n\n    By default \"node_modules\" folder is ignored by transformers.\n\n    Here's what you can do:\n     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.\n     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript\n     • To have some of your \"node_modules\" files transformed, you can specify a custom \"transformIgnorePatterns\" in your config.\n     • If you need a custom transformation specify a \"transform\" option in your config.\n     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the \"moduleNameMapper\" config option.\n\n    You'll find more details and examples of these config options in the docs:\n    https://jestjs.io/docs/configuration\n    For information about custom transformations, see:\n    https://jestjs.io/docs/code-transformation\n\n    Details:\n\n    SyntaxError: /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/components/CurationBoard.test.js: Unexpected token (8:6)\n\n       6 | const { render, screen, fireEvent, waitFor, within } = require('@testing-library/react');\n       7 | const userEvent = require('@testing-library/user-event');\n    >  8 | const '@testing-library/jest-dom';\n         |       ^\n       9 | const CurationBoard = require('../../../../src/web/components/curation/CurationBoard');\n      10 |\n      11 | // Mock fetch\n\n      at constructor (node_modules/@babel/parser/src/parse-error.ts:95:45)\n      at Parser.toParseError [as raise] (node_modules/@babel/parser/src/tokenizer/index.ts:1503:19)\n      at Parser.raise [as unexpected] (node_modules/@babel/parser/src/tokenizer/index.ts:1543:16)\n      at Parser.unexpected [as parseIdentifierName] (node_modules/@babel/parser/src/parser/expression.ts:2790:12)\n      at Parser.parseIdentifierName [as parseIdentifier] (node_modules/@babel/parser/src/parser/expression.ts:2759:23)\n      at Parser.parseIdentifier [as parseBindingAtom] (node_modules/@babel/parser/src/parser/lval.ts:391:17)\n      at Parser.parseBindingAtom [as parseVarId] (node_modules/@babel/parser/src/parser/statement.ts:1603:21)\n      at Parser.parseVarId [as parseVar] (node_modules/@babel/parser/src/parser/statement.ts:1562:12)\n      at Parser.parseVar [as parseVarStatement] (node_modules/@babel/parser/src/parser/statement.ts:1231:10)\n      at Parser.parseVarStatement [as parseStatementContent] (node_modules/@babel/parser/src/parser/statement.ts:587:21)\n      at Parser.parseStatementContent [as parseStatementLike] (node_modules/@babel/parser/src/parser/statement.ts:456:17)\n      at Parser.parseStatementLike [as parseModuleItem] (node_modules/@babel/parser/src/parser/statement.ts:393:17)\n      at Parser.parseModuleItem [as parseBlockOrModuleBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1423:16)\n      at Parser.parseBlockOrModuleBlockBody [as parseBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1397:10)\n      at Parser.parseBlockBody [as parseProgram] (node_modules/@babel/parser/src/parser/statement.ts:225:10)\n      at Parser.parseProgram [as parseTopLevel] (node_modules/@babel/parser/src/parser/statement.ts:203:25)\n      at Parser.parseTopLevel [as parse] (node_modules/@babel/parser/src/parser/index.ts:93:10)\n      at parse (node_modules/@babel/parser/src/index.ts:92:38)\n      at parser (node_modules/@babel/core/src/parser/index.ts:28:19)\n          at parser.next (<anonymous>)\n      at normalizeFile (node_modules/@babel/core/src/transformation/normalize-file.ts:49:24)\n          at normalizeFile.next (<anonymous>)\n      at run (node_modules/@babel/core/src/transformation/index.ts:40:36)\n          at run.next (<anonymous>)\n      at transform (node_modules/@babel/core/src/transform.ts:29:20)\n          at transform.next (<anonymous>)\n      at evaluateSync (node_modules/gensync/index.js:251:28)\n      at sync (node_modules/gensync/index.js:89:14)\n      at fn (node_modules/@babel/core/src/errors/rewrite-stack-trace.ts:99:14)\n      at transformSync (node_modules/@babel/core/src/transform.ts:66:52)\n      at ScriptTransformer.transformSource (node_modules/@jest/transform/build/ScriptTransformer.js:545:31)\n      at ScriptTransformer._transformAndBuildScript (node_modules/@jest/transform/build/ScriptTransformer.js:674:40)\n      at ScriptTransformer.transform (node_modules/@jest/transform/build/ScriptTransformer.js:726:19)\n\nFAIL tests/unit/web/components/AdminDashboard.test.js\n  ● Test suite failed to run\n\n    Jest encountered an unexpected token\n\n    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.\n\n    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.\n\n    By default \"node_modules\" folder is ignored by transformers.\n\n    Here's what you can do:\n     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.\n     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript\n     • To have some of your \"node_modules\" files transformed, you can specify a custom \"transformIgnorePatterns\" in your config.\n     • If you need a custom transformation specify a \"transform\" option in your config.\n     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the \"moduleNameMapper\" config option.\n\n    You'll find more details and examples of these config options in the docs:\n    https://jestjs.io/docs/configuration\n    For information about custom transformations, see:\n    https://jestjs.io/docs/code-transformation\n\n    Details:\n\n    SyntaxError: /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/components/AdminDashboard.test.js: Unexpected token (7:6)\n\n       5 | const React = require('react');\n       6 | const { render, screen, fireEvent, waitFor } = require('@testing-library/react');\n    >  7 | const '@testing-library/jest-dom';\n         |       ^\n       8 | const AdminDashboard = require('../../../../src/web/components/admin/AdminDashboard');\n       9 |\n      10 | // Mock the fetch API\n\n      at constructor (node_modules/@babel/parser/src/parse-error.ts:95:45)\n      at Parser.toParseError [as raise] (node_modules/@babel/parser/src/tokenizer/index.ts:1503:19)\n      at Parser.raise [as unexpected] (node_modules/@babel/parser/src/tokenizer/index.ts:1543:16)\n      at Parser.unexpected [as parseIdentifierName] (node_modules/@babel/parser/src/parser/expression.ts:2790:12)\n      at Parser.parseIdentifierName [as parseIdentifier] (node_modules/@babel/parser/src/parser/expression.ts:2759:23)\n      at Parser.parseIdentifier [as parseBindingAtom] (node_modules/@babel/parser/src/parser/lval.ts:391:17)\n      at Parser.parseBindingAtom [as parseVarId] (node_modules/@babel/parser/src/parser/statement.ts:1603:21)\n      at Parser.parseVarId [as parseVar] (node_modules/@babel/parser/src/parser/statement.ts:1562:12)\n      at Parser.parseVar [as parseVarStatement] (node_modules/@babel/parser/src/parser/statement.ts:1231:10)\n      at Parser.parseVarStatement [as parseStatementContent] (node_modules/@babel/parser/src/parser/statement.ts:587:21)\n      at Parser.parseStatementContent [as parseStatementLike] (node_modules/@babel/parser/src/parser/statement.ts:456:17)\n      at Parser.parseStatementLike [as parseModuleItem] (node_modules/@babel/parser/src/parser/statement.ts:393:17)\n      at Parser.parseModuleItem [as parseBlockOrModuleBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1423:16)\n      at Parser.parseBlockOrModuleBlockBody [as parseBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1397:10)\n      at Parser.parseBlockBody [as parseProgram] (node_modules/@babel/parser/src/parser/statement.ts:225:10)\n      at Parser.parseProgram [as parseTopLevel] (node_modules/@babel/parser/src/parser/statement.ts:203:25)\n      at Parser.parseTopLevel [as parse] (node_modules/@babel/parser/src/parser/index.ts:93:10)\n      at parse (node_modules/@babel/parser/src/index.ts:92:38)\n      at parser (node_modules/@babel/core/src/parser/index.ts:28:19)\n          at parser.next (<anonymous>)\n      at normalizeFile (node_modules/@babel/core/src/transformation/normalize-file.ts:49:24)\n          at normalizeFile.next (<anonymous>)\n      at run (node_modules/@babel/core/src/transformation/index.ts:40:36)\n          at run.next (<anonymous>)\n      at transform (node_modules/@babel/core/src/transform.ts:29:20)\n          at transform.next (<anonymous>)\n      at evaluateSync (node_modules/gensync/index.js:251:28)\n      at sync (node_modules/gensync/index.js:89:14)\n      at fn (node_modules/@babel/core/src/errors/rewrite-stack-trace.ts:99:14)\n      at transformSync (node_modules/@babel/core/src/transform.ts:66:52)\n      at ScriptTransformer.transformSource (node_modules/@jest/transform/build/ScriptTransformer.js:545:31)\n      at ScriptTransformer._transformAndBuildScript (node_modules/@jest/transform/build/ScriptTransformer.js:674:40)\n      at ScriptTransformer.transform (node_modules/@jest/transform/build/ScriptTransformer.js:726:19)\n\n  console.warn\n    ManualReviewApp not available, skipping test\n\n      183 |     it('should initialize with default properties', () => {\n      184 |       if (!app) {\n    > 185 |         console.warn('ManualReviewApp not available, skipping test');\n          |                 ^\n      186 |         return;\n      187 |       }\n      188 |\n\n      at Object.warn (tests/unit/web/ui/dashboard-components.test.js:185:17)\n\n  console.warn\n    ManualReviewApp not available, skipping test\n\n      199 |     it('should have required methods', () => {\n      200 |       if (!app) {\n    > 201 |         console.warn('ManualReviewApp not available, skipping test');\n          |                 ^\n      202 |         return;\n      203 |       }\n      204 |\n\n      at Object.warn (tests/unit/web/ui/dashboard-components.test.js:201:17)\n\nPASS tests/unit/web/ui/dashboard-components.test.js\n  Dashboard UI Components\n    Navigation Components\n      ✓ should have all required navigation elements (88 ms)\n      ✓ should have proper Bootstrap classes for responsive design (32 ms)\n    Kanban Board Structure\n      ✓ should have kanban board container (26 ms)\n      ✓ should have three kanban columns with correct structure (27 ms)\n      ✓ should have count badges for each column (26 ms)\n    View Containers\n      ✓ should have all required view containers (24 ms)\n      ✓ should have proper Bootstrap grid structure (26 ms)\n    ManualReviewApp Class\n      ✓ should initialize with default properties (22 ms)\n      ✓ should have required methods (27 ms)\n      View Management\n        ✓ should switch views correctly (22 ms)\n      Data Loading\n        ✓ should handle API responses correctly (20 ms)\n        ✓ should handle API errors gracefully (21 ms)\n      Kanban Board Rendering\n        ✓ should organize documents by status (20 ms)\n        ✓ should update column counts correctly (21 ms)\n    Form Components\n      ✓ should have search input with proper attributes (21 ms)\n      ✓ should have filter controls (22 ms)\n    Button Components\n      ✓ should have action buttons with proper data attributes (20 ms)\n      ✓ should have proper Bootstrap button classes (22 ms)\n    Loading States\n      ✓ should have loading indicator elements (20 ms)\n    Error Handling UI\n      ✓ should have error message containers (21 ms)\n    Accessibility Features\n      ✓ should have proper ARIA labels where needed (22 ms)\n      ✓ should have semantic HTML structure (21 ms)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:41.993Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:41.996Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:41.997Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:41.997Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:41.998Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:41.998Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:41.999Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:41.999Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:41.999Z] INFO: Alert created: alert_1749171761999_efzzoqbn7 - Test Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.000Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.000Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.002Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.002Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.002Z] INFO: Alert created: alert_1749171762002_vzy0kj9k3 - Test (info)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.002Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.003Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.003Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.003Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.003Z] INFO: Alert created: alert_1749171762003_nf72cnxrj - Test (info)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.004Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.004Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.005Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.005Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.005Z] INFO: Alert created: alert_1749171762005_kayq8l6er - Test 1 (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.005Z] INFO: Alert created: alert_1749171762005_83ixxzohh - Test 2 (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.006Z] INFO: Alert created: alert_1749171762006_jzbh2vdwr - Test 3 (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.006Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.006Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.007Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.007Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.007Z] INFO: Alert created: alert_1749171762007_twvgrw96r - Test Alert (info)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.007Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.008Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.008Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.008Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.009Z] INFO: Alert created: alert_1749171762009_8htgpc4sa - Test Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.009Z] INFO: Alert acknowledged: alert_1749171762009_8htgpc4sa by test-user\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.009Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.009Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.011Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.012Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.012Z] INFO: Alert created: alert_1749171762012_43oth28rt - Test Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.012Z] INFO: Alert acknowledged: alert_1749171762012_43oth28rt by system\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.012Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.013Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.013Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.013Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.014Z] INFO: Alert created: alert_1749171762014_n727c4yhi - Test Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.014Z] INFO: Alert resolved: alert_1749171762014_n727c4yhi by test-user\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.014Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.014Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.015Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.015Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.015Z] INFO: Alert created: alert_1749171762015_d0qjcfsy6 - Test Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.015Z] INFO: Alert resolved: alert_1749171762015_d0qjcfsy6 by system\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.016Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.016Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.017Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.018Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.018Z] INFO: Alert created: alert_1749171762018_hg4ouxqwe - Test Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.025Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.026Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.027Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.027Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.027Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.027Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.028Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.028Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.029Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.029Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.030Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.031Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.031Z] INFO: Alert created: alert_1749171762031_cyhye6oxg - Critical Test (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.534Z] INFO: Alert created: alert_1749171762533_z0gfoj82r - Alert Escalation: Critical Test (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.535Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.536Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.537Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.538Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.539Z] INFO: Alert created: alert_1749171762539_d4s7h57i7 - Critical Test (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.540Z] INFO: Alert acknowledged: alert_1749171762539_d4s7h57i7 by system\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.540Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.541Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.542Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.543Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.544Z] INFO: Alert created: alert_1749171762544_mjfew46x5 - Critical Test (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.544Z] INFO: Alert resolved: alert_1749171762544_mjfew46x5 by system\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.545Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.545Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.547Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.547Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.548Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.549Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.551Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.552Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.553Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.553Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.555Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.555Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.556Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.557Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.558Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.561Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.561Z] INFO: Alert created: alert_1749171762561_a1muyh4z7 - Critical Alert (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.561Z] INFO: Alert created: alert_1749171762561_dtnkxv7ap - Warning Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.561Z] INFO: Alert created: alert_1749171762561_oz4rlq7yp - Info Alert (info)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.562Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.562Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.563Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.563Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.564Z] INFO: Alert created: alert_1749171762564_hv9mtfhlq - Critical Alert (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.564Z] INFO: Alert created: alert_1749171762564_ne4ln6nu9 - Warning Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.564Z] INFO: Alert created: alert_1749171762564_ebbhej5gg - Info Alert (info)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.564Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.565Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.565Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.566Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.566Z] INFO: Alert created: alert_1749171762566_pbmv20vs9 - Critical Alert (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.566Z] INFO: Alert created: alert_1749171762566_h3a43s8r3 - Warning Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.566Z] INFO: Alert created: alert_1749171762566_udr2s9xh6 - Info Alert (info)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.567Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.567Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.568Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.568Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.569Z] INFO: Alert created: alert_1749171762569_63izlj0mr - Critical Alert (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.569Z] INFO: Alert created: alert_1749171762569_fu1lcp9hw - Warning Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.569Z] INFO: Alert created: alert_1749171762569_ovvu4fuul - Info Alert (info)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.569Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.570Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.570Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.571Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.571Z] INFO: Alert created: alert_1749171762571_wj2rts1u6 - Critical Alert (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.571Z] INFO: Alert created: alert_1749171762571_t4yztxlp3 - Warning Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.571Z] INFO: Alert created: alert_1749171762571_mhfepgnbm - Info Alert (info)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.571Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.572Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.572Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.573Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.573Z] INFO: Alert created: alert_1749171762573_jijwb7uke - Critical Alert (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.573Z] INFO: Alert created: alert_1749171762573_aodnxkn2i - Warning Alert (warning)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.573Z] INFO: Alert created: alert_1749171762573_5ipv1vug4 - Info Alert (info)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.573Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.574Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.575Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.575Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.576Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.577Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.577Z] INFO: Alert created: alert_1749171762577_55achv70h - Test (info)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.577Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.577Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.578Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.578Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.579Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.579Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.580Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.580Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.581Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.581Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.581Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.581Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.582Z] INFO: Initializing Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.582Z] INFO: Alert Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.582Z] INFO: Alert created: alert_1749171762582_6fh0acegi - Test (critical)\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.582Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.582Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.583Z] INFO: Shutting down Alert Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.583Z] INFO: Alert Manager shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/monitoring/AlertManager.test.js\n  AlertManager\n    Initialization\n      ✓ should initialize with default configuration (4 ms)\n      ✓ should initialize with custom configuration (1 ms)\n      ✓ should initialize empty state (1 ms)\n    Alert Creation\n      ✓ should create alert successfully (3 ms)\n      ✓ should add alert to active alerts (2 ms)\n      ✓ should add alert to history (1 ms)\n      ✓ should update statistics (2 ms)\n      ✓ should emit alert_created event (2 ms)\n    Alert Management\n      ✓ should acknowledge alert (1 ms)\n      ✓ should emit alert_acknowledged event (3 ms)\n      ✓ should resolve alert (2 ms)\n      ✓ should emit alert_resolved event (1 ms)\n      ✓ should throw error for non-existent alert (10 ms)\n    Notification Channel Selection\n      ✓ should select channels based on severity filter (2 ms)\n      ✓ should select channels based on type filter (1 ms)\n    Escalation\n      ✓ should set escalation timer for critical alerts (507 ms)\n      ✓ should clear escalation timer when alert is acknowledged (4 ms)\n      ✓ should clear escalation timer when alert is resolved (4 ms)\n    Integration\n      ✓ should integrate with cost tracker (4 ms)\n      ✓ should integrate with quality metrics (4 ms)\n      ✓ should handle missing integrations gracefully (3 ms)\n    Query Methods\n      ✓ should get active alerts sorted by severity and time (6 ms)\n      ✓ should filter active alerts by severity (2 ms)\n      ✓ should filter active alerts by type (2 ms)\n      ✓ should get alert history (2 ms)\n      ✓ should limit alert history (2 ms)\n      ✓ should get statistics (2 ms)\n    Status and Health\n      ✓ should return status when not initialized (2 ms)\n      ✓ should return status when initialized (2 ms)\n    Utility Methods\n      ✓ should generate unique alert IDs (1 ms)\n      ✓ should generate unique notification IDs (1 ms)\n    Shutdown\n      ✓ should shutdown gracefully (1 ms)\n      ✓ should clear timers on shutdown (2 ms)\n\nPASS tests/unit/web/visibility-management.test.js\n  Visibility Management Frontend\n    loadVisibilityData\n      ✓ should load all visibility data when current view is visibility (8 ms)\n      ✓ should not load data when current view is not visibility (4 ms)\n    loadVisibilityDocuments\n      ✓ should render documents when API call succeeds (26 ms)\n      ✓ should show error message when API call fails (3 ms)\n      ✓ should show empty state when no documents (9 ms)\n    getVisibilityBadge\n      ✓ should return correct badge for each visibility type (3 ms)\n    loadPendingApprovals\n      ✓ should render pending approvals when API call succeeds (5 ms)\n      ✓ should show empty state when no pending approvals (5 ms)\n    setDocumentVisibility\n      ✓ should update document visibility successfully (2 ms)\n      ✓ should throw error when API call fails (7 ms)\n    bulkUpdateVisibility\n      ✓ should update multiple documents successfully (3 ms)\n    approveVisibilityChange\n      ✓ should approve visibility change successfully (4 ms)\n    rejectVisibilityChange\n      ✓ should reject visibility change successfully (3 ms)\n    addVisibilityRule\n      ✓ should add visibility rule successfully (3 ms)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.977Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.980Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.981Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.981Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.981Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.982Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.982Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.982Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.982Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.983Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.989Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.990Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.990Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.990Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.991Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.991Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.992Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.992Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.992Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.992Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.994Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.994Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.994Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.994Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.995Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.995Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.995Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:42.995Z] ERROR: Error processing feedback batch:\u001b[0m TypeError: this.extractPattern is not a function\n        at Object.extractPattern [as detectTrends] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:150:33)\n        at FeedbackProcessor.detectTrends (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:489:41)\n        at FeedbackProcessor.processBatch [as shutdown] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:686:20)\n        at Object.shutdown (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/services/FeedbackProcessor.test.js:23:23)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusHook (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:281:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:254:5)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.996Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.996Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.996Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.997Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:42.997Z] ERROR: Error processing feedback batch:\u001b[0m TypeError: this.extractPattern is not a function\n        at Object.extractPattern [as detectTrends] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:150:33)\n        at FeedbackProcessor.detectTrends (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:489:41)\n        at FeedbackProcessor.processBatch [as shutdown] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:686:20)\n        at Object.shutdown (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/services/FeedbackProcessor.test.js:23:23)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusHook (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:281:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:254:5)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.997Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.997Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.998Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.998Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.998Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.998Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.998Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.999Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.999Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.999Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.999Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.999Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:42.999Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.000Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.000Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.000Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.000Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.001Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.001Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:43.001Z] ERROR: Error processing feedback batch:\u001b[0m TypeError: this.extractPattern is not a function\n        at Object.extractPattern [as detectTrends] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:150:33)\n        at FeedbackProcessor.detectTrends (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:489:41)\n        at Object.processBatch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/services/FeedbackProcessor.test.js:243:23)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.001Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:43.001Z] ERROR: Error processing feedback batch:\u001b[0m TypeError: this.extractPattern is not a function\n        at Object.extractPattern [as detectTrends] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:150:33)\n        at FeedbackProcessor.detectTrends (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:489:41)\n        at FeedbackProcessor.processBatch [as shutdown] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:686:20)\n        at Object.shutdown (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/services/FeedbackProcessor.test.js:23:23)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusHook (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:281:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:254:5)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.002Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.002Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.002Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.003Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.003Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.004Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.004Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.004Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.005Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.005Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.005Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.005Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.006Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.006Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.006Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.006Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.006Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.007Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.007Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.007Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.007Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.008Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.008Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.008Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.008Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.009Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.009Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.009Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.009Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.009Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.010Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.010Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.010Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.010Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.011Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:43.011Z] ERROR: Error processing feedback:\u001b[0m Error: Missing required field: type\n        at FeedbackProcessor.validateFeedback (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:219:15)\n        at FeedbackProcessor.validateFeedback [as processFeedback] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/services/FeedbackProcessor.js:183:38)\n        at Object.processFeedback (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/services/FeedbackProcessor.test.js:412:30)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:316:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:252:3)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.011Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.011Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.012Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.012Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.012Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.012Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.013Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.013Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.014Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.014Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.014Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.014Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.015Z] INFO: Initializing Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.015Z] INFO: Feedback Processor initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.015Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.015Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.015Z] INFO: Shutting down Feedback Processor...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:43.015Z] INFO: Feedback Processor shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/services/FeedbackProcessor.test.js\n  FeedbackProcessor\n    Initialization\n      ✓ should initialize successfully (5 ms)\n      ✓ should have correct default configuration (1 ms)\n    Feedback Processing\n      ✓ should validate feedback data (8 ms)\n      ✓ should process valid feedback (1 ms)\n      ✓ should analyze sentiment correctly (1 ms)\n      ✓ should extract topics correctly (3 ms)\n    Pattern Detection\n      ✓ should detect similar feedback patterns (1 ms)\n      ✓ should update trending patterns (1 ms)\n    Real-time Processing\n      ✓ should detect immediate issues (2 ms)\n      ✓ should generate real-time insights (1 ms)\n    Batch Processing\n      ✓ should process feedback in batches (2 ms)\n      ✓ should detect trends in batch processing (1 ms)\n    Trend Analysis\n      ✓ should calculate trend severity correctly (2 ms)\n      ✓ should generate action recommendations (1 ms)\n    Performance Metrics\n      ✓ should track processing metrics (1 ms)\n      ✓ should provide status information\n    Query Methods\n      ✓ should return feedback patterns\n      ✓ should return trending issues (1 ms)\n      ✓ should return performance metrics (1 ms)\n    Error Handling\n      ✓ should handle invalid feedback gracefully (1 ms)\n      ✓ should handle analysis errors gracefully (1 ms)\n    Shutdown\n      ✓ should shutdown gracefully (2 ms)\n      ✓ should process remaining queue on shutdown (1 ms)\n\nPASS tests/unit/ingestion/queue/JobScheduler.test.js\n  JobScheduler\n    Initialization\n      ✓ should initialize successfully (1 ms)\n      ✓ should emit initialized event (1 ms)\n      ✓ should handle initialization errors (6 ms)\n      ✓ should set up event forwarding\n    Single Job Scheduling\n      ✓ should schedule ingestion job successfully (2 ms)\n      ✓ should schedule job with custom options (1 ms)\n      ✓ should emit job-scheduled event\n      ✓ should fail when not initialized (1 ms)\n    Batch Job Scheduling\n      ✓ should schedule batch job successfully (1 ms)\n      ✓ should schedule batch with custom batch ID\n      ✓ should emit batch-scheduled event\n      ✓ should fail with empty sources array (1 ms)\n      ✓ should fail with non-array sources\n    Recurring Job Scheduling\n      ✓ should schedule recurring job successfully (1 ms)\n      ✓ should emit recurring-scheduled event\n      ✓ should cancel recurring job (1 ms)\n      ✓ should fail to cancel non-existent recurring job (1 ms)\n    Job Status and Management\n      ✓ should get job status (1 ms)\n      ✓ should return null for non-existent job\n      ✓ should get statistics (1 ms)\n      ✓ should retry job\n      ✓ should remove job (1 ms)\n    Queue Control\n      ✓ should pause processing\n      ✓ should resume processing (1 ms)\n      ✓ should cleanup old jobs\n    Priority Handling\n      ✓ should handle string priorities (1 ms)\n      ✓ should handle numeric priorities\n      ✓ should default to normal priority for unknown strings (2 ms)\n    Job Processing Integration\n      ✓ should process single job through processor\n      ✓ should process batch job through processor (1 ms)\n      ✓ should handle unknown job type\n    Shutdown\n      ✓ should shutdown successfully (1 ms)\n      ✓ should handle shutdown when not initialized\n      ✓ should handle shutdown errors (1 ms)\n\nPASS tests/unit/ingestion/handlers/SourceHandlerRegistry.test.js\n  SourceHandlerRegistry\n    Initialization\n      ✓ should initialize with empty registry (2 ms)\n      ✓ should initialize factory correctly (1 ms)\n    Handler Registration\n      ✓ should register single handler\n      ✓ should register multiple handlers\n      ✓ should reject duplicate handler IDs (6 ms)\n      ✓ should handle registration validation errors (1 ms)\n      ✓ should handle handler creation errors\n      ✓ should handle handler initialization errors (1 ms)\n    Handler Retrieval\n      ✓ should get handler by ID\n      ✓ should return null for non-existent handler\n      ✓ should get all handlers (2 ms)\n      ✓ should get handlers by type (1 ms)\n      ✓ should get enabled handlers only\n      ✓ should get handlers by visibility\n    Handler Management\n      ✓ should enable handler (1 ms)\n      ✓ should disable handler\n      ✓ should unregister handler (1 ms)\n      ✓ should handle enable/disable of non-existent handler\n      ✓ should handle unregister of non-existent handler (1 ms)\n    Batch Operations\n      ✓ should discover from all enabled handlers\n      ✓ should skip disabled handlers in discovery (1 ms)\n      ✓ should handle discovery errors gracefully\n      ✓ should cleanup all handlers\n      ✓ should handle cleanup errors gracefully (2 ms)\n    Registry Statistics\n      ✓ should return correct handler count\n      ✓ should return correct enabled handler count\n      ✓ should return handler statistics (1 ms)\n      ✓ should return all handler IDs\n    Configuration Management\n      ✓ should update handler configuration\n      ✓ should validate configuration before update (1 ms)\n    Event Handling\n      ✓ should emit events on handler registration\n      ✓ should emit events on handler unregistration\n\nPASS tests/unit/rag/components/InputProcessor.test.js\n  InputProcessor\n    constructor\n      ✓ should initialize with default options (2 ms)\n      ✓ should initialize with custom options (1 ms)\n    initialize\n      ✓ should initialize successfully (1 ms)\n    process\n      ✓ should process valid input successfully (1 ms)\n      ✓ should validate query length (7 ms)\n      ✓ should require non-empty query (1 ms)\n      ✓ should handle missing query (1 ms)\n      ✓ should validate date range filters (1 ms)\n      ✓ should validate maxResults option (1 ms)\n      ✓ should validate response format\n      ✓ should handle query normalization (1 ms)\n      ✓ should detect language when enabled (1 ms)\n      ✓ should classify query type when enabled (1 ms)\n      ✓ should handle different query types (1 ms)\n      ✓ should add user context to filters (1 ms)\n      ✓ should require initialization (1 ms)\n    getStatus\n      ✓ should return status when not initialized (1 ms)\n      ✓ should return status when initialized (1 ms)\n    shutdown\n      ✓ should shutdown successfully\n      ✓ should handle shutdown when not initialized (1 ms)\n    private methods\n      preprocessQuery\n        ✓ should normalize query correctly (1 ms)\n      classifyQuery\n        ✓ should classify different query types\n      detectLanguage\n        ✓ should detect language correctly (1 ms)\n      processFilters\n        ✓ should process filters with user context (1 ms)\n        ✓ should handle empty filters (1 ms)\n\nPASS tests/unit/config/ConfigIntegration.test.js\n  ConfigIntegration\n    constructor\n      ✓ should initialize with default options (1 ms)\n      ✓ should initialize with custom options (1 ms)\n      ✓ should use provided configManager instance\n    initialization\n      ✓ should initialize successfully (1 ms)\n      ✓ should not initialize if already initialized (1 ms)\n      ✓ should handle initialization errors (5 ms)\n    shutdown\n      ✓ should shutdown successfully (1 ms)\n      ✓ should not shutdown if not initialized\n      ✓ should handle shutdown errors (1 ms)\n    component registration\n      ✓ should register a component\n      ✓ should throw error for invalid component registration (2 ms)\n      ✓ should unregister a component (1 ms)\n      ✓ should handle unregistering non-existent component\n    configuration access\n      ✓ should get specific configuration (1 ms)\n      ✓ should get all configurations (1 ms)\n    configuration reloading\n      ✓ should reload configuration successfully (1 ms)\n      ✓ should handle reload errors (1 ms)\n    configuration change handling\n      ✓ should handle configuration changes\n      ✓ should handle component update errors with rollback (1 ms)\n      ✓ should handle rollback failure\n    configuration removal handling\n      ✓ should handle configuration removal (1 ms)\n      ✓ should handle components without handleConfigRemoval method (1 ms)\n    component filtering\n      ✓ should get applicable components with handlesConfigType method\n      ✓ should include all components without handlesConfigType method\n    configuration validation\n      ✓ should validate all configurations\n    statistics\n      ✓ should return integration statistics (2 ms)\n    error handling\n      ✓ should handle configuration errors\n      ✓ should emit integration-error event when listeners exist\n\nPASS tests/unit/enrichment/providers/BaseProvider.test.js\n  BaseProvider\n    constructor\n      ✓ should throw error when instantiated directly (4 ms)\n      ✓ should allow instantiation of subclasses\n      ✓ should set default configuration (1 ms)\n      ✓ should merge custom configuration (1 ms)\n      ✓ should initialize health properties (1 ms)\n    abstract methods\n      ✓ should throw error for getName\n      ✓ should throw error for getSupportedModels (1 ms)\n      ✓ should throw error for complete (1 ms)\n      ✓ should throw error for calculateCost\n    healthCheck\n      ✓ should return healthy status on successful completion (1 ms)\n      ✓ should return unhealthy status on completion failure (1 ms)\n      ✓ should use first supported model for health check\n    getStats\n      ✓ should return provider statistics (1 ms)\n    counter methods\n      ✓ should increment request count\n      ✓ should increment error count (2 ms)\n      ✓ should reset error count\n\nPASS tests/unit/cache/EmbeddingCache.test.js\n  EmbeddingCache\n    Initialization\n      ✓ should initialize with default TTL configuration (1 ms)\n      ✓ should initialize with custom TTL configuration (1 ms)\n      ✓ should initialize embedding statistics\n    Document Embedding Caching\n      ✓ should cache document embedding (2 ms)\n      ✓ should get cached document embedding (1 ms)\n      ✓ should return null for cache miss (1 ms)\n      ✓ should update embedding statistics on cache hit\n    Text Embedding Caching\n      ✓ should cache text embedding (1 ms)\n      ✓ should get cached text embedding (1 ms)\n      ✓ should generate consistent keys for same text and model\n      ✓ should generate different keys for different text (1 ms)\n    Similarity Results Caching\n      ✓ should cache similarity results (1 ms)\n      ✓ should get cached similarity results (1 ms)\n    Batch Operations\n      ✓ should cache multiple embeddings in batch (1 ms)\n      ✓ should handle batch caching errors gracefully (1 ms)\n      ✓ should get multiple embeddings in batch (1 ms)\n    Cache Invalidation\n      ✓ should invalidate document embeddings\n      ✓ should invalidate embeddings by model (1 ms)\n      ✓ should invalidate all embeddings for document\n    Cache Warming\n      ✓ should warm embedding cache (1 ms)\n      ✓ should identify already cached embeddings\n    Statistics and Metrics\n      ✓ should get embedding-specific statistics (1 ms)\n      ✓ should estimate cache size\n      ✓ should calculate cache efficiency (2 ms)\n    Error Handling\n      ✓ should handle cache set errors gracefully\n      ✓ should handle cache get errors gracefully\n      ✓ should handle invalidation errors gracefully\n    Vector Operations\n      ✓ should calculate vector size correctly (1 ms)\n      ✓ should handle empty vectors (1 ms)\n      ✓ should handle invalid vectors\n    Integration with CacheManager\n      ✓ should extend CacheManager functionality (1 ms)\n      ✓ should call parent methods\n\nPASS tests/unit/rag/RAGManager.test.js\n  RAGManager\n    constructor\n      ✓ should initialize with required dependencies (1 ms)\n      ✓ should initialize components (2 ms)\n    initialize\n      ✓ should initialize all components successfully (1 ms)\n      ✓ should handle initialization errors (6 ms)\n    processQuery\n      ✓ should process query successfully (1 ms)\n      ✓ should handle input processing errors (1 ms)\n      ✓ should handle document retrieval errors\n      ✓ should handle response generation errors (2 ms)\n      ✓ should require initialization before processing (3 ms)\n    getHealthStatus\n      ✓ should return health status when not initialized (1 ms)\n      ✓ should return health status when initialized (1 ms)\n      ✓ should handle component status errors\n    shutdown\n      ✓ should shutdown all components (1 ms)\n      ✓ should handle shutdown when not initialized\n  RAGManager with Performance Features\n    initialization with performance features\n      ✓ should initialize with performance components (5 ms)\n      ✓ should include performance components in health status (1 ms)\n      ✓ should shutdown performance components (1 ms)\n\nPASS tests/unit/monitoring/QualityMetrics.test.js\n  QualityMetrics\n    Constructor\n      ✓ should initialize with default SLOs (6 ms)\n      ✓ should initialize time windows\n    recordMetric\n      ✓ should record metric with timestamp\n      ✓ should emit metric event (1 ms)\n      ✓ should keep only recent metrics\n    recordAPIRequest\n      ✓ should record response time and request count (1 ms)\n      ✓ should record error for 4xx/5xx status codes (1 ms)\n      ✓ should record success for 2xx/3xx status codes\n      ✓ should record availability based on status code (1 ms)\n    recordLLMProcessing\n      ✓ should record processing time and success rate\n      ✓ should record error on failure (2 ms)\n    calculateMetrics\n      ✓ should calculate basic statistics\n      ✓ should calculate percentiles (1 ms)\n      ✓ should return zeros for no data (1 ms)\n      ✓ should filter by time window\n    calculateErrorRate\n      ✓ should calculate error rate correctly\n      ✓ should return 0 for no requests\n    checkSLOCompliance\n      ✓ should check response time SLO\n      ✓ should check error rate SLO (1 ms)\n      ✓ should throw error for unknown SLO (7 ms)\n    generateQualityReport\n      ✓ should generate comprehensive report (2 ms)\n      ✓ should handle DAO save failure gracefully (1 ms)\n    SLO Violation Events\n      ✓ should emit SLO violation event\n    Helper Methods\n      ✓ getMetricKey should generate consistent keys (1 ms)\n      ✓ percentile should calculate correctly\n\nPASS tests/unit/enrichment/LLMProviderManager.test.js\n  LLMProviderManager\n    constructor\n      ✓ should throw error with no providers configured (8 ms)\n      ✓ should initialize OpenAI provider when configured (1 ms)\n      ✓ should initialize Anthropic provider when configured (1 ms)\n      ✓ should initialize both providers when both configured\n      ✓ should handle provider initialization errors gracefully (2 ms)\n      ✓ should start health monitoring (1 ms)\n    getProvider\n      ✓ should return available provider (1 ms)\n      ✓ should exclude specified providers\n      ✓ should throw error when no providers available (1 ms)\n      ✓ should select provider based on document size strategy (1 ms)\n      ✓ should select provider based on task type strategy\n      ✓ should select provider with lowest error rate as fallback (1 ms)\n    executeWithFailover\n      ✓ should execute successfully with first provider (1 ms)\n      ✓ should failover to second provider on first provider failure\n      ✓ should throw error when all providers fail (4 ms)\n      ✓ should handle provider failure and update health (1 ms)\n    executeWithProvider\n      ✓ should execute and add metadata\n      ✓ should enhance error with provider context (1 ms)\n    getAvailableProviders\n      ✓ should return only healthy and available providers (1 ms)\n      ✓ should exclude specified providers\n      ✓ should exclude unavailable providers (1 ms)\n    handleProviderFailure\n      ✓ should increment consecutive failures\n      ✓ should mark provider unavailable after threshold (1 ms)\n      ✓ should handle unknown provider gracefully (1 ms)\n    performHealthChecks\n      ✓ should perform health checks on all providers\n      ✓ should handle health check failures (1 ms)\n    getSystemHealth\n      ✓ should return system health summary\n    shutdown\n      ✓ should clear health check interval (1 ms)\n\nPASS tests/unit/orm/document-model.test.js\n  Document Model\n    Model Definition\n      ✓ should define Document model with correct attributes (1 ms)\n    Instance Methods\n      hasEmbedding\n        ✓ should return true when embedding exists\n        ✓ should return false when embedding is null (1 ms)\n      getEmbedding\n        ✓ should return parsed embedding array\n        ✓ should return null for invalid embedding\n      setEmbedding\n        ✓ should set embedding from array (1 ms)\n        ✓ should handle null embedding (2 ms)\n      calculateWordCount\n        ✓ should calculate word count from content\n        ✓ should return 0 for empty content (1 ms)\n      isEnriched\n        ✓ should return true for completed enrichment\n        ✓ should return false for pending enrichment\n    Class Methods\n      findBySource\n        ✓ should find documents by source ID (1 ms)\n        ✓ should return empty array for non-existent source\n      findByContentHash\n        ✓ should find document by content hash\n        ✓ should return null for non-existent hash (1 ms)\n      findSimilar\n        ✓ should find similar documents by embedding\n        ✓ should use default parameters\n      searchByVector\n        ✓ should search documents by vector similarity (1 ms)\n    CRUD Operations\n      create\n        ✓ should create new document\n      findAll\n        ✓ should find all documents\n        ✓ should find documents with conditions (2 ms)\n      update\n        ✓ should update document\n    Validations\n      ✓ should validate required fields (1 ms)\n    Hooks\n      ✓ should have hooks for word count and timestamps\n    Vector Operations\n      ✓ should handle vector embedding storage\n\nPASS tests/unit/enrichment/EmbeddingService.test.js\n  EmbeddingService\n    Constructor\n      ✓ should initialize with default configuration (1 ms)\n      ✓ should throw error when API key is missing (6 ms)\n      ✓ should accept custom configuration\n    generateEmbedding\n      ✓ should generate embedding for valid text (3 ms)\n      ✓ should handle text truncation for long inputs (1 ms)\n      ✓ should validate input text (1 ms)\n      ✓ should handle API errors\n      ✓ should handle network timeouts (1 ms)\n      ✓ should handle invalid response format\n      ✓ should work with different models (1 ms)\n      ✓ should reject unsupported models\n    generateBatchEmbeddings\n      ✓ should generate embeddings for multiple texts (1 ms)\n      ✓ should handle batch processing for large arrays\n      ✓ should validate input array (2 ms)\n      ✓ should handle batch API errors (1 ms)\n    Utility Methods\n      ✓ should return correct embedding dimensions\n      ✓ should throw error for unknown model dimensions (1 ms)\n      ✓ should calculate costs correctly\n      ✓ should throw error for unknown model costs (1 ms)\n      ✓ should report readiness status\n      ✓ should return service status\n    Request Handling\n      ✓ should include proper headers in requests (1 ms)\n      ✓ should handle JSON parsing errors\n      ✓ should handle network errors (1 ms)\n\nPASS tests/unit/cache/ResponseCache.test.js\n  ResponseCache\n    Initialization\n      ✓ should initialize with default TTL configuration (1 ms)\n      ✓ should initialize with custom TTL configuration\n      ✓ should initialize response statistics (1 ms)\n    Response Caching\n      ✓ should cache enrichment response (1 ms)\n      ✓ should get cached response\n      ✓ should return null for cache miss (1 ms)\n      ✓ should update response statistics on cache hit (1 ms)\n    Response Type Specific Caching\n      ✓ should cache enrichment response with correct TTL\n      ✓ should cache summary response with correct TTL (2 ms)\n      ✓ should cache translation response with correct TTL (1 ms)\n      ✓ should cache classification response with correct TTL\n      ✓ should cache extraction response with correct TTL (1 ms)\n      ✓ should cache generation response with correct TTL\n    Key Generation\n      ✓ should generate consistent keys for same inputs (1 ms)\n      ✓ should generate different keys for different response types\n      ✓ should generate different keys for different parameters (1 ms)\n      ✓ should handle parameters with different order\n    Cache Invalidation\n      ✓ should invalidate responses by model (1 ms)\n      ✓ should invalidate responses by type\n      ✓ should invalidate document enrichment responses (1 ms)\n      ✓ should invalidate all responses\n    Cache Warming\n      ✓ should warm response cache (1 ms)\n      ✓ should identify already cached responses\n      ✓ should preload common responses (2 ms)\n    Statistics and Metrics\n      ✓ should get response-specific statistics\n      ✓ should calculate cost savings (1 ms)\n      ✓ should get response type breakdown\n    Cost Estimation\n      ✓ should estimate cost for GPT-4 (1 ms)\n      ✓ should estimate cost for GPT-3.5-turbo\n      ✓ should use default cost for unknown models\n      ✓ should handle zero tokens (1 ms)\n    Error Handling\n      ✓ should handle cache set errors gracefully\n      ✓ should handle cache get errors gracefully\n      ✓ should handle invalidation errors gracefully (1 ms)\n      ✓ should handle warming errors gracefully\n    Token Counting\n      ✓ should extract token count from response usage (1 ms)\n      ✓ should estimate token count from content length\n      ✓ should handle responses without content\n    Integration with CacheManager\n      ✓ should extend CacheManager functionality (2 ms)\n      ✓ should call parent methods\n\nPASS tests/unit/monitoring/dashboard/DashboardManager.test.js\n  DashboardManager\n    constructor\n      ✓ should initialize with default config (1 ms)\n      ✓ should initialize with custom config (1 ms)\n      ✓ should initialize dashboard data structure\n    initialize\n      ✓ should initialize successfully (1 ms)\n      ✓ should handle initialization errors (9 ms)\n    setupEventListeners\n      ✓ should set up cost tracker event listeners\n      ✓ should set up quality metrics event listeners (1 ms)\n      ✓ should handle missing cost tracker\n      ✓ should handle missing quality metrics (1 ms)\n    refreshCostDashboard\n      ✓ should refresh cost dashboard data (1 ms)\n      ✓ should handle missing cost tracker\n      ✓ should handle cost tracker errors\n    refreshQualityDashboard\n      ✓ should refresh quality dashboard data\n      ✓ should handle missing quality metrics (1 ms)\n      ✓ should handle quality metrics errors\n    refreshOperationalDashboard\n      ✓ should refresh operational dashboard data (2 ms)\n    calculateCostTrends\n      ✓ should calculate increasing trend (1 ms)\n      ✓ should calculate stable trend\n      ✓ should handle insufficient data (1 ms)\n      ✓ should handle empty data\n    calculateQualityTrends\n      ✓ should calculate improving trend\n      ✓ should calculate degrading trend (1 ms)\n      ✓ should handle insufficient data\n    real-time updates\n      ✓ should update real-time cost data (1 ms)\n      ✓ should update real-time quality data\n      ✓ should handle budget alerts\n      ✓ should handle SLO violations\n    data getters\n      ✓ should get cost dashboard data\n      ✓ should get quality dashboard data (1 ms)\n      ✓ should get operational dashboard data (1 ms)\n      ✓ should get all dashboard data (1 ms)\n    periodic refresh\n      ✓ should start periodic refresh\n      ✓ should stop periodic refresh (1 ms)\n      ✓ should handle refresh errors gracefully\n    shutdown\n      ✓ should shutdown gracefully (1 ms)\n      ✓ should handle shutdown errors\n\nPASS tests/unit/database/FeedbackDAO.test.js\n  FeedbackDAO\n    createFeedback\n      ✓ should create feedback successfully (1 ms)\n      ✓ should handle errors during feedback creation (7 ms)\n    createDocumentFeedback\n      ✓ should create legacy document feedback successfully (1 ms)\n    getFeedbackById\n      ✓ should get feedback by ID successfully\n      ✓ should return null when feedback not found (1 ms)\n      ✓ should handle get feedback by ID errors\n    getFeedbackByDocumentId\n      ✓ should get feedback by document ID with default options (1 ms)\n      ✓ should get feedback by document ID with feedback type filter\n      ✓ should get feedback by document ID with custom pagination (1 ms)\n      ✓ should handle get feedback by document ID errors (1 ms)\n    getFeedbackByUserId\n      ✓ should get feedback by user ID successfully\n      ✓ should handle get feedback by user ID errors (2 ms)\n    updateFeedback\n      ✓ should update feedback successfully (1 ms)\n      ✓ should throw error when no valid fields to update (3 ms)\n      ✓ should throw error when feedback not found\n      ✓ should handle update feedback errors\n    deleteFeedback\n      ✓ should delete feedback successfully (1 ms)\n      ✓ should throw error when feedback not found for deletion\n      ✓ should handle delete feedback errors (1 ms)\n    getFeedbackAggregates\n      ✓ should get feedback aggregates successfully\n      ✓ should return null when aggregates not found (1 ms)\n      ✓ should handle get feedback aggregates errors\n    updateFeedbackAggregates\n      ✓ should update feedback aggregates successfully\n      ✓ should handle null values in aggregates calculation (1 ms)\n      ✓ should handle update feedback aggregates errors\n    getFeedbackStatistics\n      ✓ should get feedback statistics for all documents (2 ms)\n      ✓ should get feedback statistics for specific documents (1 ms)\n      ✓ should handle get feedback statistics errors\n    getFeedbackTrends\n      ✓ should get feedback trends with default options (1 ms)\n      ✓ should get feedback trends with filters\n      ✓ should handle get feedback trends errors (1 ms)\n    bulkCreateFeedback\n      ✓ should bulk create feedback successfully\n      ✓ should throw error for invalid feedback entries (1 ms)\n      ✓ should rollback on error\n\nPASS tests/unit/rag/DocumentRetriever.test.js\n  DocumentRetriever\n    Constructor\n      ✓ should initialize with default options (1 ms)\n      ✓ should initialize with embedding service when API key provided (1 ms)\n      ✓ should use custom embedding model when specified\n    Initialization\n      ✓ should initialize successfully\n      ✓ should throw error if database manager is missing (8 ms)\n    Query Embedding Generation\n      ✓ should generate real embeddings when service is available (1 ms)\n      ✓ should fall back to mock embeddings when service is not available (1 ms)\n      ✓ should handle embedding service errors gracefully\n    Vector Search\n      ✓ should perform vector search with similarity threshold (1 ms)\n      ✓ should handle empty vector search results\n    Keyword Search\n      ✓ should perform keyword search with ranking (2 ms)\n      ✓ should handle special characters in search query (1 ms)\n    Hybrid Search\n      ✓ should combine vector and keyword search results using RRF (1 ms)\n      ✓ should handle empty search results gracefully\n      ✓ should respect maxResults parameter (1 ms)\n    Result Ranking and Fusion\n      ✓ should implement Reciprocal Rank Fusion correctly\n      ✓ should handle results with only vector matches (1 ms)\n      ✓ should handle results with only keyword matches\n    Error Handling\n      ✓ should handle database errors gracefully (1 ms)\n      ✓ should handle visibility filtering errors (1 ms)\n      ✓ should validate query parameter\n      ✓ should validate user authentication (1 ms)\n\nPASS tests/unit/orm/source-model.test.js\n  Source Model\n    Model Definition\n      ✓ should define Source model with correct attributes (3 ms)\n    Instance Methods\n      isActive\n        ✓ should return true for active source (1 ms)\n        ✓ should return false for inactive source\n      getLastIngestion\n        ✓ should return last ingestion date (1 ms)\n        ✓ should return null if no ingestion date\n      updateLastIngestion\n        ✓ should update last ingestion timestamp\n        ✓ should use current date if no date provided (1 ms)\n    Class Methods\n      findActive\n        ✓ should find all active sources\n        ✓ should return empty array if no active sources\n      findByType\n        ✓ should find sources by type (1 ms)\n        ✓ should return empty array for unknown type\n      findByName\n        ✓ should find source by name\n        ✓ should return null for non-existent source (1 ms)\n    CRUD Operations\n      create\n        ✓ should create new source (2 ms)\n      findAll\n        ✓ should find all sources\n        ✓ should find sources with conditions (1 ms)\n      findOne\n        ✓ should find single source\n      findByPk\n        ✓ should find source by primary key\n      update\n        ✓ should update source (1 ms)\n      destroy\n        ✓ should delete source\n    Validations\n      ✓ should validate required fields\n    Hooks\n      ✓ should have beforeCreate hook for timestamps\n\nPASS tests/unit/ingestion/handlers/StaticSourceHandler.test.js\n  StaticSourceHandler\n    Configuration Validation\n      ✓ should validate valid configuration (3 ms)\n      ✓ should reject configuration without basePath (5 ms)\n      ✓ should reject configuration with non-existent path (1 ms)\n    Initialization\n      ✓ should initialize successfully with valid configuration\n      ✓ should fail initialization with invalid path\n    Discovery\n      ✓ should discover files in directory (1 ms)\n      ✓ should filter files by extension\n    Content Extraction\n      ✓ should extract text file content (1 ms)\n      ✓ should handle binary files\n    Content Transformation\n      ✓ should transform extracted content (1 ms)\n      ✓ should extract title from file path\n    Helper Methods\n      ✓ should check if file is allowed\n      ✓ should determine if file is binary\n      ✓ should clean content properly (1 ms)\n      ✓ should count words correctly (2 ms)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.980Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.984Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.985Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.985Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: false }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.986Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.987Z] INFO: CostReporter: Initialization complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.989Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.989Z] INFO: CostReporter: Initialization complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.990Z] INFO: CostReporter: Generating cost report\u001b[0m {\n      startDate: '2025-05-07T01:02:45.990Z',\n      endDate: '2025-06-06T01:02:45.990Z',\n      format: 'object',\n      groupBy: 'provider'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.990Z] INFO: CostReporter: Report generated successfully\u001b[0m { totalCost: 0.13, eventCount: 2, format: 'object' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.991Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.991Z] INFO: CostReporter: Initialization complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.991Z] INFO: CostReporter: Generating cost report\u001b[0m {\n      startDate: '2023-12-01T00:00:00.000Z',\n      endDate: '2023-12-31T00:00:00.000Z',\n      format: 'object',\n      groupBy: 'provider'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.992Z] INFO: CostReporter: Report generated successfully\u001b[0m { totalCost: 0.13, eventCount: 2, format: 'object' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.992Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.992Z] INFO: CostReporter: Initialization complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.992Z] INFO: CostReporter: Generating cost report\u001b[0m {\n      startDate: '2025-05-07T01:02:45.992Z',\n      endDate: '2025-06-06T01:02:45.992Z',\n      format: 'object',\n      groupBy: 'provider'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.993Z] INFO: CostReporter: Report generated successfully\u001b[0m { totalCost: 0.13, eventCount: 2, format: 'object' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.993Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.993Z] INFO: CostReporter: Initialization complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.994Z] INFO: CostReporter: Generating cost report\u001b[0m {\n      startDate: '2025-05-07T01:02:45.994Z',\n      endDate: '2025-06-06T01:02:45.994Z',\n      format: 'object',\n      groupBy: 'provider'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.994Z] INFO: CostReporter: Report generated successfully\u001b[0m { totalCost: 0.13, eventCount: 2, format: 'object' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.994Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.995Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:45.996Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.001Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.001Z] INFO: Cost report exported\u001b[0m {\n      filePath: '/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/exports/cost-reports/test-report.json',\n      format: 'json'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.002Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.003Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.003Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.004Z] INFO: CostReporter: Generating cost report\u001b[0m {\n      startDate: '2025-05-07T01:02:46.004Z',\n      endDate: '2025-06-06T01:02:46.004Z',\n      format: 'json',\n      groupBy: 'provider'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:46.004Z] ERROR: CostReporter: Failed to generate report\u001b[0m { error: 'Database error', options: {} }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.009Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:46.009Z] ERROR: CostReporter: Failed to generate report\u001b[0m {\n      error: 'Invalid date range: start date must be before or equal to end date',\n      options: {\n        startDate: 2023-12-31T00:00:00.000Z,\n        endDate: 2023-12-01T00:00:00.000Z\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.013Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.013Z] INFO: CostReporter: Generating cost report\u001b[0m {\n      startDate: '2025-05-07T01:02:46.013Z',\n      endDate: '2025-06-06T01:02:46.013Z',\n      format: 'object',\n      groupBy: 'provider'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.013Z] INFO: CostReporter: Report generated successfully\u001b[0m { totalCost: 0, eventCount: 0, format: 'object' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.014Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.014Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.015Z] INFO: CostReporter: Initialized\u001b[0m { outputDir: './reports/cost', enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/monitoring/CostReporter.test.js\n  CostReporter\n    Initialization\n      ✓ should initialize with default configuration (5 ms)\n      ✓ should initialize with custom configuration (1 ms)\n      ✓ should initialize DAO when persistence enabled (1 ms)\n    Report Generation\n      ✓ should generate basic report with default options (4 ms)\n      ✓ should generate report for specific date range (1 ms)\n      ✓ should generate report with analytics (1 ms)\n      ✓ should generate report with recommendations (1 ms)\n    Report Formatting\n      ✓ should format report as JSON by default (1 ms)\n      ✓ should format report as CSV\n      ✓ should format report as HTML (5 ms)\n    Report Export\n      ✓ should export report to file (2 ms)\n    Analytics Generation\n      ✓ should generate analytics from cost events\n    Trends Analysis\n      ✓ should generate trends from cost events (1 ms)\n    Error Handling\n      ✓ should handle DAO errors gracefully (6 ms)\n      ✓ should handle invalid date ranges (4 ms)\n      ✓ should handle empty cost events (1 ms)\n    Configuration Options\n      ✓ should respect timezone configuration (1 ms)\n      ✓ should use default start date when not specified\n\nPASS tests/unit/orm/orm-manager.test.js\n  ORMManager\n    constructor\n      ✓ should create ORM manager with default config\n      ✓ should create ORM manager with custom config (3 ms)\n    initialize\n      ✓ should initialize ORM successfully\n      ✓ should handle initialization errors (4 ms)\n    getModel\n      ✓ should get model when initialized\n      ✓ should throw error when not initialized (1 ms)\n    getModels\n      ✓ should get all models when initialized\n      ✓ should throw error when not initialized (1 ms)\n    getSequelize\n      ✓ should get Sequelize instance when initialized\n      ✓ should throw error when not initialized\n    isReady\n      ✓ should return true when initialized and ready\n      ✓ should return false when not initialized\n    transaction\n      ✓ should execute transaction when initialized (1 ms)\n      ✓ should throw error when not initialized\n    query\n      ✓ should execute query when initialized (2 ms)\n      ✓ should execute query with default options\n      ✓ should throw error when not initialized\n    sync\n      ✓ should sync models when initialized\n      ✓ should sync with default options (1 ms)\n      ✓ should throw error when not initialized\n    close\n      ✓ should close ORM when initialized (1 ms)\n      ✓ should handle close when not initialized\n    healthCheck\n      ✓ should return healthy status when initialized and connected (1 ms)\n      ✓ should return error status when not initialized\n      ✓ should return error status when authentication fails\n  ORM Module Functions\n    getORM\n      ✓ should create singleton ORM instance (1 ms)\n      ✓ should create ORM with config\n    initializeORM\n      ✓ should initialize ORM and return instance\n      ✓ should initialize ORM with config (1 ms)\n    closeORM\n      ✓ should close ORM instance (1 ms)\n      ✓ should handle close when no instance exists (1 ms)\n\nFAIL tests/unit/cache/CacheManager.test.js\n  CacheManager\n    Initialization\n      ✕ should initialize with default configuration (2 ms)\n      ✓ should initialize with custom configuration\n      ✓ should initialize Redis client and memory cache (1 ms)\n      ✓ should handle Redis connection failure gracefully\n    Cache Operations\n      set\n        ✓ should set value in memory cache (2 ms)\n        ✓ should set value in Redis cache (1 ms)\n        ✓ should handle custom TTL\n        ✓ should emit set event (1 ms)\n        ✓ should handle Redis set failure gracefully\n      get\n        ✓ should get value from memory cache (1 ms)\n        ✓ should get value from Redis when not in memory\n        ✓ should return null for non-existent key (1 ms)\n        ✓ should handle expired memory cache entries\n        ✓ should emit hit event for memory cache hit (1 ms)\n        ✓ should emit hit event for Redis cache hit (1 ms)\n        ✓ should emit miss event for cache miss (2 ms)\n        ✓ should handle Redis get failure gracefully\n      delete\n        ✓ should delete from both memory and Redis (1 ms)\n        ✓ should emit delete event\n        ✓ should handle Redis delete failure gracefully\n      clear\n        ✓ should clear memory cache with pattern (1 ms)\n        ✓ should clear Redis cache with pattern\n        ✓ should clear all caches when no pattern provided (1 ms)\n    Statistics\n      ✓ should track cache statistics\n      ✓ should calculate memory usage (1 ms)\n    Health Check\n      ✓ should return healthy status when connected\n      ✓ should return unhealthy status when Redis is disconnected (1 ms)\n      ✓ should handle Redis ping failure\n    Cache Warming\n      ✓ should warm cache with provided data (2 ms)\n      ✓ should handle warmup failures gracefully (1 ms)\n    Key Generation\n      ✓ should generate keys with prefix\n      ✓ should generate keys with multiple parts (1 ms)\n      ✓ should handle empty parts\n    Shutdown\n      ✓ should shutdown gracefully\n      ✓ should handle shutdown errors gracefully (1 ms)\n\n  ● CacheManager › Initialization › should initialize with default configuration\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: \"localhost\"\n    Received: \"redis\"\n\n      89 |       const cache = new CacheManager();\n      90 |       expect(cache.config).toBeDefined();\n    > 91 |       expect(cache.config.redis.host).toBe('localhost');\n         |                                       ^\n      92 |       expect(cache.config.redis.port).toBe(6379);\n      93 |       expect(cache.config.ttl.default).toBe(3600);\n      94 |     });\n\n      at Object.toBe (tests/unit/cache/CacheManager.test.js:91:39)\n\nPASS tests/unit/ingestion/handlers/SourceHandlerFactory.test.js\n  SourceHandlerFactory\n    Handler Registration\n      ✓ should register all default handlers (1 ms)\n      ✓ should register custom handler\n      ✓ should throw error when registering handler with existing type (6 ms)\n      ✓ should allow overriding existing handler when force is true\n    Handler Creation\n      ✓ should create StaticSourceHandler (1 ms)\n      ✓ should create SemiStaticSourceHandler\n      ✓ should create DynamicConsistentSourceHandler\n      ✓ should create DynamicUnstructuredSourceHandler\n      ✓ should throw error for unsupported handler type (1 ms)\n      ✓ should throw error for invalid configuration\n      ✓ should throw error for configuration without type (1 ms)\n    Handler Validation\n      ✓ should validate handler configuration before creation\n      ✓ should reject invalid handler configuration (4 ms)\n      ✓ should handle validation for unsupported type (1 ms)\n    Handler Introspection\n      ✓ should return list of registered handler types\n      ✓ should check if handler type is supported\n      ✓ should return handler class for registered type (1 ms)\n      ✓ should return null for unregistered type\n    Batch Operations\n      ✓ should create multiple handlers from configurations\n      ✓ should handle errors in batch creation gracefully (1 ms)\n      ✓ should validate multiple configurations\n    Error Handling\n      ✓ should handle handler constructor errors (1 ms)\n      ✓ should provide detailed error information\n    Configuration Helpers\n      ✓ should provide default configuration for handler type\n      ✓ should return null for unsupported type default config (1 ms)\n      ✓ should merge user config with defaults\n    Handler Lifecycle\n      ✓ should initialize handler after creation\n      ✓ should cleanup handler resources (1 ms)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.605Z] INFO: Reliability score calculated\u001b[0m { sourceId: 'source-1', score: 0.8425, level: 'high' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.609Z] INFO: Reliability score calculated\u001b[0m { sourceId: 'source-1', score: 0.8965000000000001, level: 'high' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.610Z] INFO: Reliability score calculated\u001b[0m { sourceId: 'source-1', score: 0.5, level: 'medium' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.610Z] INFO: Reliability score calculated\u001b[0m { sourceId: 'source-1', score: 0.8425, level: 'high' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.611Z] INFO: Reliability score calculated\u001b[0m { sourceId: 'source-1', score: 0.8425, level: 'high' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.612Z] INFO: Starting reliability score update for all sources\u001b[0m { totalSources: 2 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.612Z] INFO: Completed reliability score batch\u001b[0m { batchNumber: 1, totalBatches: 1, completed: 2, total: 2 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.612Z] INFO: Completed reliability score update for all sources\u001b[0m { totalSources: 2, successful: 2, failed: 0 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.613Z] INFO: Starting reliability score update for all sources\u001b[0m { totalSources: 3 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.613Z] INFO: Completed reliability score batch\u001b[0m { batchNumber: 1, totalBatches: 2, completed: 2, total: 3 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.613Z] INFO: Completed reliability score batch\u001b[0m { batchNumber: 2, totalBatches: 2, completed: 3, total: 3 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.613Z] INFO: Completed reliability score update for all sources\u001b[0m { totalSources: 3, successful: 3, failed: 0 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.614Z] INFO: Starting reliability score update for all sources\u001b[0m { totalSources: 2 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:46.614Z] ERROR: Failed to calculate reliability score\u001b[0m {\n      sourceId: 'source-2',\n      sourceName: undefined,\n      error: 'Calculation failed'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n          at async Promise.all (index 1)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.614Z] INFO: Completed reliability score batch\u001b[0m { batchNumber: 1, totalBatches: 1, completed: 2, total: 2 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.614Z] INFO: Completed reliability score update for all sources\u001b[0m { totalSources: 2, successful: 1, failed: 1 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/services/SourceReliabilityService.test.js\n  SourceReliabilityService\n    constructor\n      ✓ should initialize with required dependencies\n      ✓ should throw error if databaseManager is missing (18 ms)\n      ✓ should throw error if auditService is missing (1 ms)\n    getDocumentQualityMetrics\n      ✓ should fetch document quality metrics successfully\n      ✓ should handle no documents case\n      ✓ should handle database errors (2 ms)\n    getUserFeedbackMetrics\n      ✓ should fetch user feedback metrics successfully\n      ✓ should handle no feedback case\n    getContentConsistencyMetrics\n      ✓ should fetch content consistency metrics successfully (1 ms)\n    getErrorRateMetrics\n      ✓ should fetch error rate metrics successfully\n    getHistoricalPerformanceMetrics\n      ✓ should fetch historical performance metrics successfully (1 ms)\n      ✓ should handle insufficient data for trend calculation\n    calculateLinearRegression\n      ✓ should calculate trend correctly for increasing data\n      ✓ should calculate trend correctly for decreasing data (1 ms)\n      ✓ should handle stable data\n      ✓ should handle insufficient data\n    calculateReliabilityScore\n      ✓ should calculate reliability score successfully (5 ms)\n      ✓ should determine reliability level correctly\n      ✓ should handle sources with no data (1 ms)\n      ✓ should store calculated score in database\n      ✓ should log audit event (1 ms)\n    getReliabilityScore\n      ✓ should retrieve stored reliability score\n      ✓ should return null if no score found (1 ms)\n    getAllReliabilityScores\n      ✓ should retrieve all reliability scores with pagination\n    updateAllReliabilityScores\n      ✓ should update scores for all active sources (1 ms)\n      ✓ should handle batch processing\n      ✓ should handle individual calculation failures (1 ms)\n    determineReliabilityLevel\n      ✓ should classify high reliability correctly\n      ✓ should classify medium reliability correctly (1 ms)\n      ✓ should classify low reliability correctly (5 ms)\n      ✓ should handle edge cases\n    normalizeScore\n      ✓ should normalize scores correctly\n      ✓ should handle edge cases (1 ms)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.740Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.742Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.743Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.743Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.743Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.743Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.744Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 1000, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:46.744Z] ERROR: Failed to initialize Database Optimizer:\u001b[0m Error: Database manager is required\n        at DatabaseOptimizer.initialize (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/DatabaseOptimizer.js:47:15)\n        at Object.initialize (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/DatabaseOptimizer.test.js:65:30)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:316:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:252:3)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.750Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.750Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.751Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.751Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.751Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.751Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.752Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.752Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.752Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.752Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.752Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.752Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.753Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.753Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.753Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.753Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.753Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.754Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.754Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:46.754Z] WARN: Failed to create index:\u001b[0m {\n      error: 'Index creation failed',\n      query: 'CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_document_embeddings_vector \\n' +\n        '         ON document_embeddings USING ivfflat (embedding vector_cosine_ops) \\n' +\n        '         WITH (lists = 100)'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:46.754Z] WARN: Failed to create index:\u001b[0m {\n      error: 'Index creation failed',\n      query: 'CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_document_visibility_user_group \\n' +\n        '         ON document_visibility (user_id, group_id, visibility_level)'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:46.754Z] WARN: Failed to create index:\u001b[0m {\n      error: 'Index creation failed',\n      query: 'CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_documents_metadata_gin \\n' +\n        '         ON documents USING gin (metadata)'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:46.754Z] WARN: Failed to create index:\u001b[0m {\n      error: 'Index creation failed',\n      query: 'CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_documents_content_fts \\n' +\n        \"         ON documents USING gin (to_tsvector('english', content))\"\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:46.754Z] WARN: Failed to create index:\u001b[0m {\n      error: 'Index creation failed',\n      query: 'CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_document_enrichments_result_gin \\n' +\n        '         ON document_enrichments USING gin (result)'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:46.754Z] WARN: Failed to create index:\u001b[0m {\n      error: 'Index creation failed',\n      query: 'CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_jobs_status_created_at \\n' +\n        '         ON jobs (status, created_at DESC)'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:46.754Z] WARN: Failed to create index:\u001b[0m {\n      error: 'Index creation failed',\n      query: 'CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_job_dependencies_parent_child \\n' +\n        '         ON job_dependencies (parent_job_id, child_job_id)'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.755Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.755Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.755Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.756Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.756Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.756Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.756Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.760Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.760Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.761Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.761Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.761Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.761Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.762Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.762Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.762Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.762Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.763Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.763Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:46.763Z] ERROR: Optimized vector search failed:\u001b[0m Error: Database error\n        at Object.<anonymous> (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/DatabaseOptimizer.test.js:163:51)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:316:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:252:3)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.763Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.763Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.764Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.764Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.764Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.764Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.764Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.765Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.765Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.765Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.765Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.765Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.766Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.766Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.766Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.766Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.767Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.767Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.767Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.767Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.767Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.768Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.768Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.768Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.768Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.768Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.769Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.773Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.774Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.774Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.774Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.774Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.775Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.775Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.775Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.775Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.775Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.775Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.776Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.777Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.777Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.777Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.777Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.777Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.778Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.778Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.778Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.778Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.778Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.778Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.779Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.779Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.779Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.780Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.780Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.780Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.780Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.780Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.781Z] INFO: Initializing Database Optimizer...\u001b[0m { enableQueryCaching: true, cacheSize: 100, cacheTTL: 300000 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.781Z] INFO: Creating optimized database indexes...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.781Z] INFO: Database indexes optimization completed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.781Z] INFO: Database Optimizer initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.781Z] INFO: Shutting down Database Optimizer...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:46.781Z] INFO: Database Optimizer shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/rag/performance/DatabaseOptimizer.test.js\n  DatabaseOptimizer\n    constructor\n      ✓ should initialize with default options (1 ms)\n      ✓ should initialize with custom options\n    initialize\n      ✓ should initialize successfully (4 ms)\n      ✓ should throw error if database manager is missing (7 ms)\n      ✓ should create indexes during initialization (1 ms)\n    createOptimizedIndexes\n      ✓ should create vector search indexes (2 ms)\n      ✓ should handle index creation errors gracefully (2 ms)\n    optimizedVectorSearch\n      ✓ should perform vector search with caching (5 ms)\n      ✓ should return cached results when available (1 ms)\n      ✓ should handle query errors (1 ms)\n    optimizedKeywordSearch\n      ✓ should perform keyword search with caching (2 ms)\n      ✓ should return cached results when available (1 ms)\n    getQueryPerformanceMetrics\n      ✓ should return performance metrics (1 ms)\n      ✓ should track metrics after queries (1 ms)\n    getCacheStats\n      ✓ should return cache statistics (6 ms)\n    clearCache\n      ✓ should clear the cache (2 ms)\n    getStatus\n      ✓ should return status when not initialized\n      ✓ should return status when initialized (1 ms)\n      ✓ should indicate missing database manager (1 ms)\n    shutdown\n      ✓ should shutdown gracefully (1 ms)\n      ✓ should handle shutdown when not initialized\n    cache key generation\n      ✓ should generate consistent cache keys (1 ms)\n      ✓ should generate different keys for different parameters (2 ms)\n\nPASS tests/unit/permissions/PermissionManager.test.js\n  PermissionManager\n    initialization\n      ✓ should initialize successfully\n      ✓ should handle initialization errors (4 ms)\n    hasPermission\n      ✓ should return true when user has direct permission\n      ✓ should return false when user has explicit denial\n      ✓ should check role permissions when no direct permission exists\n      ✓ should return false when no permissions found\n      ✓ should use cache for repeated permission checks (1 ms)\n      ✓ should handle database errors gracefully (1 ms)\n      ✓ should handle resource-specific permissions\n    filterDocumentsByPermission\n      ✓ should return accessible documents\n      ✓ should return empty array for empty input (1 ms)\n      ✓ should return empty array for null input\n      ✓ should handle database errors gracefully\n    canAccessDocument\n      ✓ should return true when user can access document (1 ms)\n      ✓ should return false when user cannot access document\n      ✓ should handle errors gracefully\n    logAccess\n      ✓ should log access successfully (1 ms)\n      ✓ should handle logging errors gracefully\n      ✓ should handle missing metadata gracefully\n    cache management\n      ✓ should clear user cache (1 ms)\n      ✓ should clear all cache (1 ms)\n      ✓ should handle cache disabled (1 ms)\n    _getCacheKey\n      ✓ should generate consistent cache keys\n      ✓ should handle null values in cache key\n    error handling\n      ✓ should always release database connections (1 ms)\n      ✓ should handle connection errors\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.044Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.058Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.062Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.063Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.063Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.064Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.067Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.068Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.069Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.069Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.070Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.070Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.072Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.073Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.074Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.074Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.074Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.075Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.076Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.076Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.077Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.077Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.078Z] INFO: QueueManager: Using REDIS_URL for Bull queue: redis://localhost:6379\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nFAIL tests/unit/ingestion/queue/QueueManager.test.js\n  QueueManager\n    Initialization\n      ✕ should initialize successfully (3 ms)\n      ✓ should emit initialized event (1 ms)\n      ✓ should handle initialization errors (4 ms)\n    Job Management\n      ✓ should add ingestion job successfully\n      ✓ should add job with custom options (1 ms)\n      ✓ should emit job-added event\n      ✓ should fail to add job when not initialized (4 ms)\n    Job Processing\n      ✓ should start processing with processor function (1 ms)\n      ✓ should emit processing-started event\n      ✓ should handle job processing with processor wrapper (1 ms)\n      ✓ should handle job processing errors (1 ms)\n    Statistics\n      ✓ should return queue statistics\n      ✓ should return basic stats when not initialized (1 ms)\n    Job Operations\n      ✓ should get job by ID (2 ms)\n      ✓ should remove job by ID\n      ✓ should return false when removing non-existent job (1 ms)\n      ✓ should retry job by ID\n    Queue Control\n      ✓ should pause queue (1 ms)\n      ✓ should resume queue\n      ✓ should clean queue (1 ms)\n    Shutdown\n      ✓ should shutdown successfully\n      ✓ should handle shutdown when not initialized (1 ms)\n      ✓ should handle shutdown errors\n    Event Handling\n      ✓ should set up queue event listeners (1 ms)\n      ✓ should emit job events from queue events\n\n  ● QueueManager › Initialization › should initialize successfully\n\n    expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\n    Expected: \"ingestion-queue\", ObjectContaining {\"defaultJobOptions\": Any<Object>, \"redis\": ObjectContaining {\"socket\": {\"host\": \"localhost\", \"port\": 6379}}}\n    Received: \"ingestion-queue\", {\"defaultJobOptions\": {\"attempts\": 3, \"backoff\": {\"delay\": 2000, \"type\": \"exponential\"}, \"removeOnComplete\": 100, \"removeOnFail\": 50}, \"redis\": \"redis://localhost:6379\"}\n\n    Number of calls: 1\n\n      68 |       });\n      69 |       expect(mockRedisClient.connect).toHaveBeenCalled();\n    > 70 |       expect(Bull).toHaveBeenCalledWith('ingestion-queue', expect.objectContaining({\n         |                    ^\n      71 |         redis: expect.objectContaining({\n      72 |           socket: {\n      73 |             host: 'localhost',\n\n      at Object.toHaveBeenCalledWith (tests/unit/ingestion/queue/QueueManager.test.js:70:20)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.230Z] INFO: Job created\u001b[0m { job_id: 'job-123', type: 'ingestion' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.231Z] INFO: Job created\u001b[0m { job_id: 'job-123', type: 'processing' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.232Z] ERROR: Failed to create job\u001b[0m { error: 'Database error', jobData: { type: 'test' } }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.237Z] ERROR: Failed to find job by ID\u001b[0m { error: 'Database error', id: 'job-123' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.238Z] INFO: Job status updated\u001b[0m { job_id: 'job-123', status: 'completed', progress: 100 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.238Z] INFO: Job status updated\u001b[0m { job_id: 'job-123', status: 'running', progress: undefined }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.239Z] INFO: Job status updated\u001b[0m { job_id: 'job-123', status: 'completed', progress: undefined }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.239Z] ERROR: Failed to update job status\u001b[0m { error: 'Job not found', id: 'nonexistent', status: 'completed' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.246Z] INFO: Job dependency added\u001b[0m { job_id: 'job-123', depends_on: 'job-456' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.247Z] ERROR: Failed to add job dependency\u001b[0m { error: 'Dependency error', jobId: 'job-1', dependsOnJobId: 'job-2' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.250Z] ERROR: Failed to retry job\u001b[0m { error: 'Job not found', id: 'nonexistent' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.250Z] ERROR: Failed to retry job\u001b[0m { error: 'Only failed jobs can be retried', id: 'job-123' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.251Z] INFO: Job cleanup completed\u001b[0m { deleted_count: 150 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.252Z] INFO: Job cleanup completed\u001b[0m { deleted_count: 100 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/database/JobDAO.test.js\n  JobDAO\n    create\n      ✓ should create a job successfully (1 ms)\n      ✓ should use default values (1 ms)\n      ✓ should handle creation errors (4 ms)\n    findById\n      ✓ should find job by ID (1 ms)\n      ✓ should return null when job not found\n      ✓ should handle query errors\n    updateStatus\n      ✓ should update job status successfully (1 ms)\n      ✓ should add started_at when status is running (1 ms)\n      ✓ should add completed_at when status is completed\n      ✓ should throw error when job not found (2 ms)\n    findByStatus\n      ✓ should find jobs by status\n      ✓ should filter by type when provided (4 ms)\n    getNextPending\n      ✓ should get next pending job without dependencies\n      ✓ should filter by type when provided\n      ✓ should return null when no pending jobs (1 ms)\n    addDependency\n      ✓ should add job dependency successfully\n      ✓ should handle dependency creation errors (1 ms)\n    addLog\n      ✓ should add job log entry (1 ms)\n      ✓ should handle empty metadata\n    getLogs\n      ✓ should get job logs\n      ✓ should filter by level when provided (1 ms)\n    cancel\n      ✓ should cancel job successfully\n    retry\n      ✓ should retry failed job successfully\n      ✓ should throw error when job not found\n      ✓ should throw error when job is not failed\n    getStats\n      ✓ should return job statistics (1 ms)\n    cleanup\n      ✓ should cleanup old jobs\n      ✓ should use default retention period (1 ms)\n    getQueueStatus\n      ✓ should return queue status\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.387Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.387Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.391Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.391Z] ERROR: Failed to initialize Parallel Search Manager:\u001b[0m Error: Document retriever is required\n        at ParallelSearchManager.initialize (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/ParallelSearchManager.js:25:15)\n        at Object.initialize (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/ParallelSearchManager.test.js:71:28)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:316:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:252:3)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.402Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.402Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.402Z] ERROR: Parallel search failed:\u001b[0m Error: Parallel Search Manager not initialized\n        at ParallelSearchManager.performParallelSearch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/ParallelSearchManager.js:48:15)\n        at Object.performParallelSearch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/ParallelSearchManager.test.js:86:17)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:316:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:252:3)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.405Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.405Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.405Z] ERROR: Parallel search failed:\u001b[0m Error: Query is required\n        at ParallelSearchManager.performParallelSearch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/ParallelSearchManager.js:53:15)\n        at Object.performParallelSearch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/ParallelSearchManager.test.js:92:31)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:316:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:252:3)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.405Z] ERROR: Parallel search failed:\u001b[0m Error: Query is required\n        at ParallelSearchManager.performParallelSearch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/ParallelSearchManager.js:53:15)\n        at Object.performParallelSearch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/ParallelSearchManager.test.js:96:31)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.407Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.407Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.407Z] ERROR: Parallel search failed:\u001b[0m Error: User authentication is required\n        at ParallelSearchManager.performParallelSearch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/ParallelSearchManager.js:57:15)\n        at Object.performParallelSearch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/ParallelSearchManager.test.js:102:31)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:316:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:252:3)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.407Z] ERROR: Parallel search failed:\u001b[0m Error: User authentication is required\n        at ParallelSearchManager.performParallelSearch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/ParallelSearchManager.js:57:15)\n        at Object.performParallelSearch (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/ParallelSearchManager.test.js:106:31)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.408Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.408Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.410Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.410Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:47.410Z] WARN: Query embedding generation failed:\u001b[0m Error: Embedding failed\n        at Object.<anonymous> (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/ParallelSearchManager.test.js:152:70)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:316:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:252:3)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n          at async Promise.allSettled (index 0)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:47.410Z] WARN: Embedding generation failed, falling back to keyword-only search\u001b[0m { error: 'Embedding failed' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.411Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.411Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:47.411Z] WARN: Vector search failed:\u001b[0m Error: Vector search failed\n        at Object.<anonymous> (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/ParallelSearchManager.test.js:176:67)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:316:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:252:3)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.413Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.413Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.415Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.415Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.415Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.415Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:48.415Z] WARN: Query embedding generation failed:\u001b[0m Error: Embedding generation timeout\n        at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/ParallelSearchManager.js:235:16\n        at callTimer (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:744:24)\n        at doTickInner (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1312:29)\n        at doTick (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1393:20)\n        at Object.tick (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1401:20)\n        at FakeTimers.advanceTimersByTime (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/@jest/fake-timers/build/modernFakeTimers.js:94:19)\n        at Object.advanceTimersByTime (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runtime/build/index.js:2027:26)\n        at Object.advanceTimersByTime (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/ParallelSearchManager.test.js:239:12)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n          at async Promise.allSettled (index 0)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:48.415Z] WARN: Embedding generation failed, falling back to keyword-only search\u001b[0m { error: 'Embedding generation timeout' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.426Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.426Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.426Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.426Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:48.426Z] WARN: Query embedding generation failed:\u001b[0m Error: Embedding generation timeout\n        at /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/ParallelSearchManager.js:235:16\n        at callTimer (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:744:24)\n        at doTickInner (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1312:29)\n        at doTick (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1393:20)\n        at Object.tick (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/@sinonjs/fake-timers/src/fake-timers-src.js:1401:20)\n        at FakeTimers.advanceTimersByTime (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/@jest/fake-timers/build/modernFakeTimers.js:94:19)\n        at Object.advanceTimersByTime (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runtime/build/index.js:2027:26)\n        at Object.advanceTimersByTime (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/ParallelSearchManager.test.js:278:12)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n          at async Promise.allSettled (index 0)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:48.426Z] WARN: Embedding generation failed, falling back to keyword-only search\u001b[0m { error: 'Embedding generation timeout' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.428Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.428Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.428Z] INFO: Initializing Parallel Search Manager...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.428Z] INFO: Parallel Search Manager initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:47.428Z] WARN: Vector search failed:\u001b[0m Error: Vector search timeout\n        at Object.<anonymous> (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/ParallelSearchManager.test.js:299:67)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/rag/performance/ParallelSearchManager.test.js\n  ParallelSearchManager\n    constructor\n      ✓ should initialize with default options\n      ✓ should initialize with custom options (1 ms)\n    initialize\n      ✓ should initialize successfully (4 ms)\n      ✓ should throw error if document retriever is missing (11 ms)\n    performParallelSearch\n      ✓ should throw error if not initialized (3 ms)\n      ✓ should throw error for invalid query (2 ms)\n      ✓ should throw error for missing user auth (1 ms)\n      ✓ should perform parallel search successfully (2 ms)\n      ✓ should handle embedding generation failure gracefully (1 ms)\n      ✓ should handle vector search failure gracefully (2 ms)\n      ✓ should respect custom limit from filters (1 ms)\n      ✓ should handle timeout during parallel search (12 ms)\n      ✓ should handle embedding generation timeout (2 ms)\n      ✓ should handle vector search timeout (1 ms)\n    calculateParallelEfficiency\n      ✓ should calculate efficiency correctly\n      ✓ should handle zero results\n    getPerformanceStats\n      ✓ should return performance statistics\n    getStatus\n      ✓ should return status information (1 ms)\n      ✓ should indicate missing document retriever\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.551Z] INFO: CostDAO: Database connection established\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.554Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.554Z] ERROR: CostDAO: Failed to initialize database connection\u001b[0m { error: 'Connection failed' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.558Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.559Z] INFO: CostDAO: Database connection established\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.559Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.559Z] INFO: CostDAO: Database connection established\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.560Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.560Z] INFO: CostDAO: Database connection established\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.560Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.561Z] INFO: CostDAO: Database connection established\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.561Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.562Z] INFO: CostDAO: Database connection established\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.564Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.565Z] INFO: CostDAO: Database connection established\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.565Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.566Z] INFO: CostDAO: Database connection established\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.566Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.566Z] INFO: CostDAO: Database connection established\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.568Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.569Z] INFO: CostDAO: Database connection established\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.569Z] INFO: CostDAO: Cleaned up old cost events\u001b[0m {\n      deletedCount: 5,\n      cutoffDate: 2025-03-08T02:02:47.569Z,\n      retentionDays: 90\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.569Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.569Z] INFO: CostDAO: Database connection established\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.570Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.570Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.570Z] ERROR: CostDAO: Failed to save cost event\u001b[0m {\n      error: 'Connection failed',\n      costEvent: {\n        provider: 'openai',\n        model: 'gpt-4',\n        operation: 'completion',\n        inputTokens: 100,\n        outputTokens: 50,\n        inputCost: 0.03,\n        outputCost: 0.06,\n        totalCost: 0.09\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.570Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:47.571Z] ERROR: CostDAO: Failed to get cost events\u001b[0m {\n      error: 'Query execution failed',\n      startDate: 2025-06-06T01:02:47.571Z,\n      endDate: 2025-06-06T01:02:47.571Z,\n      filters: {}\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:47.571Z] INFO: CostDAO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/monitoring/CostDAO.test.js\n  CostDAO\n    Initialization\n      ✓ should initialize database connection (3 ms)\n      ✓ should handle initialization failure (4 ms)\n    Cost Event Operations\n      ✓ should save cost event successfully (1 ms)\n      ✓ should get cost events with date range (1 ms)\n      ✓ should get cost events with filters (1 ms)\n      ✓ should get cost summary\n    Budget Operations\n      ✓ should get active budgets (3 ms)\n      ✓ should get budget spending (1 ms)\n    Alert Operations\n      ✓ should save cost alert successfully (1 ms)\n    Report Operations\n      ✓ should save cost report successfully (2 ms)\n    Data Management\n      ✓ should cleanup old events (1 ms)\n      ✓ should close database connection (1 ms)\n    Error Handling\n      ✓ should handle connection errors gracefully\n      ✓ should handle query errors gracefully (1 ms)\n\n  console.error\n    [Migration [object Object] (undefined)] BEGIN Non-Concurrent Transaction\n\n      155 |         // Original behavior: wrap DDL and recording in a single transaction.\n      156 |         await client.query('BEGIN');\n    > 157 |         console.error(`[Migration ${version} (${name})] BEGIN Non-Concurrent Transaction`);\n          |                 ^\n      158 |         if (forwardScript) {\n      159 |           console.error(`[Migration ${version} (${name})] Executing Non-Concurrent Script (first 300 chars): ${forwardScript.substring(0, 300).replace(/\\n/g, ' ')}...`);\n      160 |           try {\n\n      at MigrationManager.error [as applyMigration] (src/database/MigrationManager.js:157:17)\n      at Object.<anonymous> (tests/unit/database/MigrationManager.test.js:177:7)\n\n  console.error\n    [Migration [object Object] (undefined)] COMMIT Non-Concurrent Transaction\n\n      174 |         );\n      175 |         await client.query('COMMIT');\n    > 176 |         console.error(`[Migration ${version} (${name})] COMMIT Non-Concurrent Transaction`);\n          |                 ^\n      177 |\n      178 |         // **** BEGIN NEW DIAGNOSTIC ****\n      179 |         try {\n\n      at MigrationManager.error [as applyMigration] (src/database/MigrationManager.js:176:17)\n      at Object.<anonymous> (tests/unit/database/MigrationManager.test.js:177:7)\n\n  console.error\n    [Migration [object Object] (undefined)] Session state discarded after non-concurrent commit.\n\n      193 |         try {\n      194 |           await client.query('DISCARD ALL;');\n    > 195 |           console.error(`[Migration ${version} (${name})] Session state discarded after non-concurrent commit.`);\n          |                   ^\n      196 |         } catch (discardError) {\n      197 |           console.error(`[Migration ${version} (${name})] FAILED to DISCARD ALL: ${discardError.message}`);\n      198 |           // Decide if this should be a fatal error for the migration\n\n      at MigrationManager.error [as applyMigration] (src/database/MigrationManager.js:195:19)\n      at Object.<anonymous> (tests/unit/database/MigrationManager.test.js:177:7)\n\n  console.error\n    [Migration [object Object] (undefined)] Successfully applied and recorded.\n\n      199 |         }\n      200 |       }\n    > 201 |       console.error(`[Migration ${version} (${name})] Successfully applied and recorded.`);\n          |               ^\n      202 |     } catch (error) {\n      203 |       // Attempt to rollback only if we explicitly started a transaction for non-concurrent or recording part.\n      204 |       if (client && client.activeQuery === null) { // Check if client is not busy and can issue rollback\n\n      at MigrationManager.error [as applyMigration] (src/database/MigrationManager.js:201:15)\n      at Object.<anonymous> (tests/unit/database/MigrationManager.test.js:177:7)\n\n  console.error\n    [Migration [object Object] (undefined)] BEGIN Non-Concurrent Transaction\n\n      155 |         // Original behavior: wrap DDL and recording in a single transaction.\n      156 |         await client.query('BEGIN');\n    > 157 |         console.error(`[Migration ${version} (${name})] BEGIN Non-Concurrent Transaction`);\n          |                 ^\n      158 |         if (forwardScript) {\n      159 |           console.error(`[Migration ${version} (${name})] Executing Non-Concurrent Script (first 300 chars): ${forwardScript.substring(0, 300).replace(/\\n/g, ' ')}...`);\n      160 |           try {\n\n      at MigrationManager.error [as applyMigration] (src/database/MigrationManager.js:157:17)\n      at Object.<anonymous> (tests/unit/database/MigrationManager.test.js:203:7)\n\n  console.error\n    [Migration [object Object] (undefined)] COMMIT Non-Concurrent Transaction\n\n      174 |         );\n      175 |         await client.query('COMMIT');\n    > 176 |         console.error(`[Migration ${version} (${name})] COMMIT Non-Concurrent Transaction`);\n          |                 ^\n      177 |\n      178 |         // **** BEGIN NEW DIAGNOSTIC ****\n      179 |         try {\n\n      at MigrationManager.error [as applyMigration] (src/database/MigrationManager.js:176:17)\n      at Object.<anonymous> (tests/unit/database/MigrationManager.test.js:203:7)\n\n  console.error\n    [Migration [object Object] (undefined)] Session state discarded after non-concurrent commit.\n\n      193 |         try {\n      194 |           await client.query('DISCARD ALL;');\n    > 195 |           console.error(`[Migration ${version} (${name})] Session state discarded after non-concurrent commit.`);\n          |                   ^\n      196 |         } catch (discardError) {\n      197 |           console.error(`[Migration ${version} (${name})] FAILED to DISCARD ALL: ${discardError.message}`);\n      198 |           // Decide if this should be a fatal error for the migration\n\n      at MigrationManager.error [as applyMigration] (src/database/MigrationManager.js:195:19)\n      at Object.<anonymous> (tests/unit/database/MigrationManager.test.js:203:7)\n\n  console.error\n    [Migration [object Object] (undefined)] Successfully applied and recorded.\n\n      199 |         }\n      200 |       }\n    > 201 |       console.error(`[Migration ${version} (${name})] Successfully applied and recorded.`);\n          |               ^\n      202 |     } catch (error) {\n      203 |       // Attempt to rollback only if we explicitly started a transaction for non-concurrent or recording part.\n      204 |       if (client && client.activeQuery === null) { // Check if client is not busy and can issue rollback\n\n      at MigrationManager.error [as applyMigration] (src/database/MigrationManager.js:201:15)\n      at Object.<anonymous> (tests/unit/database/MigrationManager.test.js:203:7)\n\n  console.log\n    Applying 2 pending migrations...\n\n      at MigrationManager.log [as migrate] (src/database/MigrationManager.js:267:13)\n\n  console.error\n    [MigrationManager.migrate] DIAGNOSTIC: Pausing for 200ms after applying 0001\n\n      271 |       await this.applyMigration(migration.version, migration.name, scriptContent);\n      272 |       // DIAGNOSTIC DELAY\n    > 273 |       console.error(`[MigrationManager.migrate] DIAGNOSTIC: Pausing for 200ms after applying ${migration.version}`);\n          |               ^\n      274 |       await new Promise(resolve => setTimeout(resolve, 200));\n      275 |     }\n      276 |         \n\n      at MigrationManager.error [as migrate] (src/database/MigrationManager.js:273:15)\n      at Object.<anonymous> (tests/unit/database/MigrationManager.test.js:267:7)\n\n  console.error\n    [MigrationManager.migrate] DIAGNOSTIC: Pausing for 200ms after applying 0002\n\n      271 |       await this.applyMigration(migration.version, migration.name, scriptContent);\n      272 |       // DIAGNOSTIC DELAY\n    > 273 |       console.error(`[MigrationManager.migrate] DIAGNOSTIC: Pausing for 200ms after applying ${migration.version}`);\n          |               ^\n      274 |       await new Promise(resolve => setTimeout(resolve, 200));\n      275 |     }\n      276 |         \n\n      at MigrationManager.error [as migrate] (src/database/MigrationManager.js:273:15)\n      at Object.<anonymous> (tests/unit/database/MigrationManager.test.js:267:7)\n\n  console.log\n    All migrations applied successfully\n\n      at MigrationManager.log [as migrate] (src/database/MigrationManager.js:277:13)\n\n  console.log\n    No pending migrations\n\n      at MigrationManager.log [as migrate] (src/database/MigrationManager.js:263:15)\n\n  console.log\n    Created migration file: 0002_add_new_feature.sql\n\n      at MigrationManager.log [as createMigration] (src/database/MigrationManager.js:386:13)\n\n  console.log\n    Created migration file: 0001_initial_migration.sql\n\n      at MigrationManager.log [as createMigration] (src/database/MigrationManager.js:386:13)\n\nFAIL tests/unit/database/MigrationManager.test.js\n  MigrationManager\n    initializeMigrationTable\n      ✓ should create migration tracking table (1 ms)\n    getAvailableMigrations\n      ✓ should return sorted list of migration files\n      ✓ should return empty array when migrations directory does not exist (1 ms)\n      ✓ should throw error for other filesystem errors (4 ms)\n    getAppliedMigrations\n      ✓ should return list of applied migrations\n    getPendingMigrations\n      ✓ should return migrations not yet applied (1 ms)\n    calculateChecksum\n      ✓ should calculate SHA256 checksum of content\n    parseMigrationFile\n      ✕ should parse migration file into forward and rollback scripts (1 ms)\n      ✕ should handle migration with no rollback section\n    applyMigration\n      ✕ should apply migration successfully (5 ms)\n      ✕ should rollback transaction on error (1 ms)\n    rollbackMigration\n      ✕ should rollback migration successfully\n      ✕ should throw error if migration not found (1 ms)\n      ✕ should throw error if rollback script is empty (1 ms)\n    migrate\n      ✕ should apply all pending migrations (403 ms)\n      ✓ should do nothing if no pending migrations (1 ms)\n    getStatus\n      ✓ should return migration status summary\n    validateMigrations\n      ✓ should detect checksum mismatches (1 ms)\n      ✓ should detect missing migration files\n    createMigration\n      ✓ should create new migration file with incremented version (6 ms)\n      ✓ should start with version 0001 if no migrations exist\n\n  ● MigrationManager › parseMigrationFile › should parse migration file into forward and rollback scripts\n\n    TypeError: migrationManager.parseMigrationFile is not a function\n\n      143 | DROP TABLE test;`;\n      144 |\n    > 145 |       const result = migrationManager.parseMigrationFile(content);\n          |                                       ^\n      146 |\n      147 |       expect(result.forward).toContain('CREATE TABLE test');\n      148 |       expect(result.rollback).toContain('DROP TABLE test');\n\n      at Object.parseMigrationFile (tests/unit/database/MigrationManager.test.js:145:39)\n\n  ● MigrationManager › parseMigrationFile › should handle migration with no rollback section\n\n    TypeError: migrationManager.parseMigrationFile is not a function\n\n      152 |       const content = 'CREATE TABLE test (id INTEGER);';\n      153 |\n    > 154 |       const result = migrationManager.parseMigrationFile(content);\n          |                                       ^\n      155 |\n      156 |       expect(result.forward).toContain('CREATE TABLE test');\n      157 |       expect(result.rollback).toBe('');\n\n      at Object.parseMigrationFile (tests/unit/database/MigrationManager.test.js:154:39)\n\n  ● MigrationManager › applyMigration › should apply migration successfully\n\n    expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\n    Expected: \"CREATE TABLE test (id INTEGER);\"\n    Received\n           1: \"BEGIN\"\n           2: \"INSERT INTO schema_migrations (version, name, rollback_script, checksum)·\n                       VALUES ($1, $2, $3, $4)\", [{\"filename\": \"0001_test_migration.sql\", \"name\": \"test_migration\", \"version\": \"0001\"}, undefined, \"\", \"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\"]\n           3: \"COMMIT\"\n\n    Number of calls: 4\n\n      178 |\n      179 |       expect(mockClient.query).toHaveBeenCalledWith('BEGIN');\n    > 180 |       expect(mockClient.query).toHaveBeenCalledWith('CREATE TABLE test (id INTEGER);');\n          |                                ^\n      181 |       expect(mockClient.query).toHaveBeenCalledWith(\n      182 |         expect.stringContaining('INSERT INTO schema_migrations'),\n      183 |         expect.arrayContaining(['0001', 'test_migration'])\n\n      at Object.toHaveBeenCalledWith (tests/unit/database/MigrationManager.test.js:180:32)\n\n  ● MigrationManager › applyMigration › should rollback transaction on error\n\n    expect(received).rejects.toThrow()\n\n    Received promise resolved instead of rejected\n    Resolved to value: undefined\n\n      201 |       });\n      202 |\n    > 203 |       await expect(migrationManager.applyMigration(migration)).rejects.toThrow('Failed to apply migration');\n          |             ^\n      204 |\n      205 |       expect(mockClient.query).toHaveBeenCalledWith('ROLLBACK');\n      206 |       expect(mockClient.release).toHaveBeenCalled();\n\n      at expect (node_modules/expect/build/index.js:113:15)\n      at Object.expect (tests/unit/database/MigrationManager.test.js:203:13)\n\n  ● MigrationManager › rollbackMigration › should rollback migration successfully\n\n    Empty rollback script provided for migration 0001 (undefined)\n\n      225 |   async rollbackMigration(version, name, rollbackScriptContent) {\n      226 |     if (!rollbackScriptContent || rollbackScriptContent.trim() === '') {\n    > 227 |       throw new Error(`Empty rollback script provided for migration ${version} (${name})`);\n          |             ^\n      228 |     }\n      229 |\n      230 |     const client = await this.db.getClient();\n\n      at MigrationManager.rollbackMigration (src/database/MigrationManager.js:227:13)\n      at Object.rollbackMigration (tests/unit/database/MigrationManager.test.js:222:30)\n\n  ● MigrationManager › rollbackMigration › should throw error if migration not found\n\n    expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"Migration 0001 not found in applied migrations\"\n    Received message:   \"Empty rollback script provided for migration 0001 (undefined)\"\n\n          225 |   async rollbackMigration(version, name, rollbackScriptContent) {\n          226 |     if (!rollbackScriptContent || rollbackScriptContent.trim() === '') {\n        > 227 |       throw new Error(`Empty rollback script provided for migration ${version} (${name})`);\n              |             ^\n          228 |     }\n          229 |\n          230 |     const client = await this.db.getClient();\n\n      at MigrationManager.rollbackMigration (src/database/MigrationManager.js:227:13)\n      at Object.rollbackMigration (tests/unit/database/MigrationManager.test.js:236:37)\n      at Object.toThrow (node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (tests/unit/database/MigrationManager.test.js:236:72)\n\n  ● MigrationManager › rollbackMigration › should throw error if rollback script is empty\n\n    expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"Empty rollback script for migration 0001\"\n    Received message:   \"Empty rollback script provided for migration 0001 (undefined)\"\n\n          225 |   async rollbackMigration(version, name, rollbackScriptContent) {\n          226 |     if (!rollbackScriptContent || rollbackScriptContent.trim() === '') {\n        > 227 |       throw new Error(`Empty rollback script provided for migration ${version} (${name})`);\n              |             ^\n          228 |     }\n          229 |\n          230 |     const client = await this.db.getClient();\n\n      at MigrationManager.rollbackMigration (src/database/MigrationManager.js:227:13)\n      at Object.rollbackMigration (tests/unit/database/MigrationManager.test.js:251:37)\n      at Object.toThrow (node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (tests/unit/database/MigrationManager.test.js:251:72)\n\n  ● MigrationManager › migrate › should apply all pending migrations\n\n    expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\n    Expected: {\"filename\": \"0001_migration1.sql\", \"name\": \"migration1\", \"version\": \"0001\"}\n    Received\n           1: \"0001\", \"migration1\", \"CREATE TABLE test (id INTEGER);\"\n           2: \"0002\", \"migration2\", \"CREATE TABLE test (id INTEGER);\"\n\n    Number of calls: 2\n\n      268 |\n      269 |       expect(migrationManager.applyMigration).toHaveBeenCalledTimes(2);\n    > 270 |       expect(migrationManager.applyMigration).toHaveBeenCalledWith(pendingMigrations[0]);\n          |                                               ^\n      271 |       expect(migrationManager.applyMigration).toHaveBeenCalledWith(pendingMigrations[1]);\n      272 |     });\n      273 |\n\n      at Object.toHaveBeenCalledWith (tests/unit/database/MigrationManager.test.js:270:47)\n\nPASS tests/unit/monitoring/QualityDAO.test.js\n  QualityDAO\n    saveQualityReport\n      ✓ should save quality report successfully (1 ms)\n      ✓ should handle database error (5 ms)\n    getQualityReports\n      ✓ should retrieve quality reports with default parameters (1 ms)\n      ✓ should filter by window period\n      ✓ should handle pagination (2 ms)\n    saveSLOViolation\n      ✓ should save SLO violation successfully (1 ms)\n      ✓ should handle missing optional fields\n    getSLOViolations\n      ✓ should retrieve SLO violations with default parameters\n      ✓ should filter by SLO ID (1 ms)\n      ✓ should filter by compliance status\n      ✓ should filter by time range\n    saveMetricDataPoint\n      ✓ should save metric data point successfully (1 ms)\n      ✓ should handle missing labels\n      ✓ should handle missing optional fields\n    getMetricDataPoints\n      ✓ should retrieve metric data points with default parameters (1 ms)\n      ✓ should filter by metric type\n      ✓ should filter by time range\n      ✓ should filter by labels\n    cleanupOldData\n      ✓ should cleanup old quality reports (1 ms)\n      ✓ should use default retention period\n      ✓ should handle cleanup errors gracefully (3 ms)\n    Error Handling\n      ✓ should handle JSON parsing errors in getQualityReports\n      ✓ should handle JSON parsing errors in getSLOViolations\n\nPASS tests/unit/cache/QueryCache.test.js\n  QueryCache\n    Initialization\n      ✓ should initialize with default TTL configuration (1 ms)\n      ✓ should initialize with custom TTL configuration\n      ✓ should initialize query statistics (1 ms)\n    Cache Key Generation\n      ✓ should generate query key with basic parameters\n      ✓ should generate consistent keys for same query (1 ms)\n      ✓ should generate different keys for different queries (1 ms)\n      ✓ should generate different keys for different options (1 ms)\n      ✓ should normalize query options for consistent keys\n    Query Caching\n      ✓ should cache query results (1 ms)\n      ✓ should get cached query results\n      ✓ should return null for cache miss (1 ms)\n      ✓ should update query statistics on cache hit\n      ✓ should update query statistics on cache miss (1 ms)\n    Search Results Caching\n      ✓ should cache search results\n      ✓ should get cached search results\n    TTL Determination\n      ✓ should return default TTL for simple queries (1 ms)\n      ✓ should return longer TTL for complex queries\n      ✓ should return shorter TTL for real-time queries\n      ✓ should respect suggested TTL (2 ms)\n      ✓ should use search results TTL for search queries (1 ms)\n    Cache Invalidation\n      ✓ should invalidate queries by pattern\n      ✓ should invalidate queries by source (1 ms)\n      ✓ should invalidate queries by document\n    Cache Warming\n      ✓ should preload common queries (1 ms)\n      ✓ should identify already cached queries\n    Statistics\n      ✓ should get query-specific statistics\n      ✓ should calculate cache efficiency\n    Error Handling\n      ✓ should handle cache set errors gracefully\n      ✓ should handle cache get errors gracefully (1 ms)\n      ✓ should handle invalidation errors gracefully\n    Integration with CacheManager\n      ✓ should extend CacheManager functionality\n      ✓ should call parent methods (1 ms)\n\nPASS tests/unit/ingestion/handlers/DynamicConsistentSourceHandler.test.js\n  DynamicConsistentSourceHandler\n    Configuration Validation\n      ✓ should validate valid configuration\n      ✓ should reject configuration without sources (8 ms)\n      ✓ should reject configuration with empty sources array (1 ms)\n      ✓ should validate source configurations\n      ✓ should validate supported source types\n    Initialization\n      ✓ should initialize successfully with valid configuration (1 ms)\n      ✓ should initialize source processors\n    Discovery\n      ✓ should discover documents from RSS feeds (1 ms)\n      ✓ should discover documents from API endpoints (1 ms)\n      ✓ should handle source discovery errors gracefully\n      ✓ should apply deduplication (3 ms)\n    Content Extraction\n      ✓ should extract RSS item content (1 ms)\n      ✓ should extract API content directly\n      ✓ should handle extraction errors\n    Content Transformation\n      ✓ should transform RSS content (1 ms)\n      ✓ should transform API content\n    RSS Processing\n      ✓ should parse RSS feed correctly (1 ms)\n      ✓ should handle malformed RSS\n    API Processing\n      ✓ should process API response correctly\n    Helper Methods\n      ✓ should setup authentication for API sources\n      ✓ should generate document ID consistently\n      ✓ should deduplicate documents\n      ✓ should clean HTML content (1 ms)\n      ✓ should count words correctly\n    Cleanup\n      ✓ should cleanup resources\n\nPASS tests/unit/rag/components/OutputFormatter.test.js\n  OutputFormatter\n    constructor\n      ✓ should initialize with default options (1 ms)\n      ✓ should initialize with custom options\n    initialize\n      ✓ should initialize successfully\n    format\n      ✓ should format response as JSON by default (1 ms)\n      ✓ should format response as text\n      ✓ should format response as markdown (1 ms)\n      ✓ should exclude sources when includeSources is false\n      ✓ should exclude metadata when includeMetadata is false (1 ms)\n      ✓ should handle missing response sources (4 ms)\n      ✓ should handle empty documents array\n      ✓ should handle missing confidence score (1 ms)\n    formatSources\n      ✓ should format sources correctly\n      ✓ should limit sources to top 10\n      ✓ should handle missing titles and URLs (1 ms)\n    formatMetadata\n      ✓ should format metadata correctly\n      ✓ should handle missing metadata fields (1 ms)\n    calculateAverageRelevance\n      ✓ should calculate average relevance correctly\n      ✓ should handle empty documents array\n      ✓ should handle documents without search metadata (1 ms)\n    formatError\n      ✓ should format error response correctly\n      ✓ should handle error without name\n      ✓ should handle error without message\n    getStatus\n      ✓ should return status when not initialized (1 ms)\n      ✓ should return status when initialized (2 ms)\n    shutdown\n      ✓ should shutdown successfully\n      ✓ should handle shutdown when not initialized\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.825Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.827Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.828Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.829Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.830Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.830Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.831Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.831Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.831Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.832Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.832Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.832Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.833Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.833Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.833Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.833Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.834Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.834Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.834Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.835Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.835Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.835Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.836Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.836Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.836Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.836Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.837Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.837Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.840Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.840Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.840Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.841Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.841Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.841Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.842Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.842Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.842Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.842Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.843Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.843Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.843Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.843Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.844Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.844Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.844Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.844Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.845Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.845Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.845Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.845Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.846Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.846Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.847Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.847Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.847Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.847Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.848Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.848Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.848Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.848Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.850Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.850Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.851Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.851Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.852Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.852Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.852Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.852Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.853Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.853Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.853Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.854Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.854Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.854Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.854Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.855Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.855Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.855Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.856Z] INFO: Initializing Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.856Z] INFO: Prometheus Exporter initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.856Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.856Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.856Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.856Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.857Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.858Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.858Z] INFO: Shutting down Prometheus Exporter...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.858Z] INFO: Prometheus Exporter shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/monitoring/PrometheusExporter.test.js\n  PrometheusExporter\n    Initialization\n      ✓ should initialize with default configuration (3 ms)\n      ✓ should initialize with custom configuration (2 ms)\n      ✓ should initialize custom metrics\n    Cost Tracking\n      ✓ should record cost metrics (2 ms)\n      ✓ should record token metrics (1 ms)\n      ✓ should update budget utilization (1 ms)\n    Quality Tracking\n      ✓ should record API response metrics (1 ms)\n      ✓ should update error rate (2 ms)\n      ✓ should update SLO compliance (3 ms)\n      ✓ should record document processing time (1 ms)\n    System Tracking\n      ✓ should update active connections (1 ms)\n      ✓ should update queue size (2 ms)\n      ✓ should update cache hit rate (1 ms)\n      ✓ should record document ingestion (1 ms)\n    Integration\n      ✓ should integrate with cost tracker (1 ms)\n      ✓ should integrate with quality metrics (1 ms)\n      ✓ should handle missing integrations gracefully (3 ms)\n    Status and Health\n      ✓ should return status when not initialized\n      ✓ should return status when initialized\n      ✓ should return content type (1 ms)\n    Metrics Export\n      ✓ should export metrics (1 ms)\n      ✓ should export metrics as string (1 ms)\n    Shutdown\n      ✓ should shutdown gracefully (2 ms)\n      ✓ should handle shutdown when not initialized (1 ms)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.976Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.979Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 90, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.980Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.980Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.981Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 60, enablePersistence: false }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.981Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.981Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.982Z] INFO: CostTracker: Loaded budgets from database\u001b[0m { count: 0 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.982Z] INFO: CostTracker: Loaded recent events from database\u001b[0m { count: 0 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.982Z] INFO: CostTracker: Initialization complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.982Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.983Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.983Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.984Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.985Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.985Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[33m[2025-06-06T01:02:48.985Z] WARN: Unknown provider/model combination for cost calculation\u001b[0m { provider: 'unknown', model: 'model' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.986Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.986Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.987Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.987Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.987Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.988Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.988Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.989Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.989Z] INFO: CostTracker: Cleanup completed\u001b[0m { databaseDeleted: 5, memoryDeleted: 0, retentionDays: 30 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.990Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.990Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.991Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.991Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.991Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.992Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.994Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.994Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.994Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.995Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:48.995Z] ERROR: Failed to track cost event\u001b[0m {\n      error: 'Save failed',\n      event: {\n        provider: 'openai',\n        model: 'gpt-4',\n        inputTokens: 1000,\n        outputTokens: 500,\n        documentId: 'doc-123',\n        sourceType: 'pdf',\n        operation: 'enrichment'\n      }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.998Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.998Z] INFO: CostTracker: Initialized with persistence enabled\u001b[0m { retentionDays: 30, enablePersistence: true }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:48.999Z] ERROR: CostTracker: Failed to initialize\u001b[0m { error: 'DB connection failed' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:48.999Z] INFO: CostTracker: Closed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/monitoring/CostTracker.test.js\n  CostTracker\n    Initialization\n      ✓ should initialize with default configuration (5 ms)\n      ✓ should initialize with custom configuration (1 ms)\n      ✓ should initialize DAO and load data when persistence enabled (1 ms)\n    Cost Calculation\n      ✓ should calculate cost for OpenAI GPT-4 (1 ms)\n      ✓ should calculate cost for Anthropic Claude (1 ms)\n      ✓ should handle unknown provider/model with zero cost (1 ms)\n    Cost Tracking\n      ✓ should track cost event successfully (1 ms)\n      ✓ should update in-memory caches when tracking cost (1 ms)\n      ✓ should emit cost event after tracking (1 ms)\n    Data Management\n      ✓ should cleanup old records (1 ms)\n      ✓ should get cost summary (1 ms)\n      ✓ should get daily totals\n      ✓ should get monthly totals (3 ms)\n      ✓ should get provider totals\n    Error Handling\n      ✓ should handle cost tracking failure gracefully (4 ms)\n      ✓ should handle initialization failure gracefully (1 ms)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.123Z] INFO: Document created\u001b[0m { document_id: 'doc-123' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.126Z] ERROR: Failed to create document\u001b[0m { error: 'Database error', documentData: { title: 'Test' } }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.130Z] INFO: Document created\u001b[0m { document_id: 'doc-123' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.133Z] ERROR: Failed to find document by ID\u001b[0m { error: 'Database error', id: 'doc-123' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.134Z] ERROR: Failed to search documents\u001b[0m { error: 'Search error', searchTerm: 'test', options: {} }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.135Z] INFO: Document updated\u001b[0m { document_id: 'doc-123' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.136Z] ERROR: Failed to update document\u001b[0m { error: 'No fields to update', id: 'doc-123', updateData: {} }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.138Z] ERROR: Failed to update document\u001b[0m {\n      error: 'Document not found',\n      id: 'doc-123',\n      updateData: { title: 'New Title' }\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.139Z] INFO: Document deleted\u001b[0m { document_id: 'doc-123' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.139Z] ERROR: Failed to delete document\u001b[0m { error: 'Document not found', id: 'nonexistent' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.143Z] INFO: Bulk document creation completed\u001b[0m { count: 2 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.143Z] ERROR: Failed to bulk create documents\u001b[0m { error: 'Transaction error' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/database/DocumentDAO.test.js\n  DocumentDAO\n    create\n      ✓ should create a document successfully (2 ms)\n      ✓ should handle creation errors (4 ms)\n      ✓ should use default values for optional fields (3 ms)\n    findById\n      ✓ should find document by ID\n      ✓ should return null when document not found\n      ✓ should handle query errors (1 ms)\n    findByHash\n      ✓ should find document by hash\n      ✓ should return null when hash not found\n    search\n      ✓ should search documents with basic query (1 ms)\n      ✓ should search with filters\n      ✓ should handle search errors (1 ms)\n    findBySource\n      ✓ should find documents by source\n      ✓ should use custom options\n    update\n      ✓ should update document successfully (1 ms)\n      ✓ should throw error when no fields to update (2 ms)\n      ✓ should throw error when document not found (1 ms)\n    delete\n      ✓ should delete document successfully\n      ✓ should throw error when document not found\n    findPendingReview\n      ✓ should find documents pending review (1 ms)\n      ✓ should use custom options (1 ms)\n    getStats\n      ✓ should return document statistics\n    bulkCreate\n      ✓ should create multiple documents in transaction (1 ms)\n      ✓ should handle bulk creation errors\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.256Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.258Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.259Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.259Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.261Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.262Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.262Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.262Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.263Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.263Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.263Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.264Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.264Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.264Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.264Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.265Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.265Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.265Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.265Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.265Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.265Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.266Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.266Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.266Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.267Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.267Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.267Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.267Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.268Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.268Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.269Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.269Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.270Z] ERROR: Request throttling error:\u001b[0m TypeError: res.set is not a function\n        at RequestThrottler.set [as queueRequest] (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/RequestThrottler.js:189:9)\n        at queueRequest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/src/rag/performance/RequestThrottler.js:91:22)\n        at Object.middleware (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/rag/performance/RequestThrottler.test.js:113:13)\n        at Promise.then.completed (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:298:28)\n        at new Promise (<anonymous>)\n        at callAsyncCircusFn (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/utils.js:231:10)\n        at _callCircusTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:316:40)\n        at _runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:252:3)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:126:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at _runTestsForDescribeBlock (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:121:9)\n        at run (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/run.js:71:3)\n        at runAndTransformResultsToJestFormat (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n        at jestAdapter (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n        at runTestInternal (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:367:16)\n        at runTest (/Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/node_modules/jest-runner/build/runTest.js:444:34)\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.275Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.275Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.275Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.276Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.278Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.278Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.279Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.279Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.279Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 10, maxQueueSize: 50, rateLimitPerMinute: 1 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.279Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.280Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.280Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.280Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.280Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.280Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.281Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.281Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.281Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.282Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.282Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.283Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.283Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.283Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.284Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.284Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.284Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.284Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.285Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.285Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.285Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.285Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.285Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.286Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.286Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.286Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.286Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.287Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.287Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.287Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.287Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.287Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.287Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.288Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.288Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.288Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.290Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.290Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.290Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.291Z] INFO: Initializing Request Throttler...\u001b[0m { maxConcurrentRequests: 2, maxQueueSize: 3, rateLimitPerMinute: 60 }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.291Z] INFO: Request Throttler initialized successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.291Z] INFO: Shutting down Request Throttler...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.291Z] INFO: Request Throttler shutdown complete\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/rag/performance/RequestThrottler.test.js\n  RequestThrottler\n    constructor\n      ✓ should initialize with default options (4 ms)\n      ✓ should initialize with custom options (3 ms)\n    initialize\n      ✓ should initialize successfully (1 ms)\n      ✓ should not initialize twice (2 ms)\n    middleware\n      ✓ should create middleware function (1 ms)\n      ✓ should process request when under limits (1 ms)\n      ✓ should queue request when at concurrent limit (6 ms)\n      ✓ should reject request when queue is full (3 ms)\n      ✓ should handle rate limiting (2 ms)\n    getMetrics\n      ✓ should return metrics (2 ms)\n    getStatus\n      ✓ should return status when not initialized (1 ms)\n      ✓ should return status when initialized (1 ms)\n    shutdown\n      ✓ should shutdown gracefully (1 ms)\n      ✓ should handle shutdown when not initialized (2 ms)\n    client identification\n      ✓ should identify client by API key (1 ms)\n      ✓ should identify client by user ID (3 ms)\n      ✓ should identify client by IP address (1 ms)\n\nPASS tests/unit/ingestion/queue/IngestionJobProcessor.test.js\n  IngestionJobProcessor\n    Initialization\n      ✓ should initialize successfully\n      ✓ should handle initialization errors (5 ms)\n    Single Job Processing\n      ✓ should process job successfully (1 ms)\n      ✓ should handle existing source\n      ✓ should handle document processing errors (1 ms)\n      ✓ should stop on error when configured (2 ms)\n      ✓ should fail without source configuration\n      ✓ should fail when not initialized (1 ms)\n      ✓ should cleanup on error\n    Batch Processing\n      ✓ should process batch successfully (1 ms)\n      ✓ should handle batch with failed sources\n      ✓ should stop batch on error when configured (1 ms)\n      ✓ should fail with empty sources\n      ✓ should fail without sources array\n      ✓ should generate batch ID if not provided (1 ms)\n    Shutdown\n      ✓ should shutdown successfully\n      ✓ should handle shutdown when not initialized (1 ms)\n      ✓ should handle shutdown errors\n    Progress Reporting\n      ✓ should report progress during job processing\n      ✓ should report progress during batch processing (1 ms)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.563Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.566Z] ERROR: Failed to initialize database connection\u001b[0m { error: 'Connection failed' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.572Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.573Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.573Z] ERROR: Database query failed\u001b[0m { query: 'INVALID SQL', duration: 0, error: 'Syntax error' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.573Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.575Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.575Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.576Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.576Z] INFO: Applying database schema...\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.576Z] INFO: Database schema applied successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.577Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.577Z] ERROR: Failed to apply database schema\u001b[0m { error: 'File not found' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.577Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.577Z] INFO: Running migration: 001_initial.sql\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.577Z] INFO: Migration completed: 001_initial.sql\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.578Z] INFO: Running migration: 002_add_indexes.sql\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.578Z] INFO: Migration completed: 002_add_indexes.sql\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.578Z] INFO: All migrations completed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.578Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.578Z] INFO: All migrations completed successfully\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.579Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.579Z] INFO: No migrations directory found, skipping migrations\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.579Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.580Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[31m[2025-06-06T01:02:49.581Z] ERROR: Database query failed\u001b[0m {\n      query: 'SELECT NOW() as current_time, version() as version',\n      duration: 0,\n      error: 'Connection lost'\n    }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.582Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.583Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.583Z] INFO: Cleaned up 100 old job logs\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.583Z] INFO: Cleaned up 50 old completed jobs\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.583Z] INFO: Cleaned up 25 old audit logs\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.583Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.583Z] INFO: Database connection closed\u001b[0m {}\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\n  console.log\n    \u001b[36m[2025-06-06T01:02:49.584Z] INFO: Database connection established successfully\u001b[0m { host: 'localhost', port: 5432, database: 'test_db' }\n\n      at Logger.log [as _formatMessage] (src/utils/logger.js:44:15)\n\nPASS tests/unit/database/DatabaseManager.test.js\n  DatabaseManager\n    constructor\n      ✓ should initialize with default configuration (1 ms)\n      ✓ should use DATABASE_URL when available\n      ✓ should use provided configuration\n      ✓ should use environment variables when available (1 ms)\n    initialize\n      ✓ should successfully initialize connection (2 ms)\n      ✓ should handle connection failure (5 ms)\n    query\n      ✓ should execute query successfully (2 ms)\n      ✓ should handle query errors (1 ms)\n      ✓ should throw error when not connected (1 ms)\n    transaction\n      ✓ should execute transaction successfully\n      ✓ should rollback on error (1 ms)\n    applySchema\n      ✓ should apply schema successfully\n      ✓ should handle schema file read error (1 ms)\n    runMigrations\n      ✓ should create migrations table and run migrations (1 ms)\n      ✓ should skip already applied migrations\n      ✓ should handle missing migrations directory (1 ms)\n    healthCheck\n      ✓ should return healthy status (1 ms)\n      ✓ should return unhealthy status on error (1 ms)\n    getStats\n      ✓ should return database statistics\n    cleanup\n      ✓ should cleanup old data (1 ms)\n    close\n      ✓ should close connection (1 ms)\n      ✓ should handle close when pool is null\n    getClient\n      ✓ should return a client\n\nPASS tests/unit/ingestion/handlers/SemiStaticSourceHandler.test.js\n  SemiStaticSourceHandler\n    Configuration Validation\n      ✓ should validate valid configuration (1 ms)\n      ✓ should reject configuration without baseUrl (7 ms)\n      ✓ should reject configuration without endpoints (1 ms)\n      ✓ should validate authentication configuration (2 ms)\n      ✓ should validate endpoint accessibility\n    Initialization\n      ✓ should initialize successfully with valid configuration\n      ✓ should fail initialization with invalid endpoints\n    Discovery\n      ✓ should discover documents from all endpoints\n      ✓ should handle endpoints with no ETag (1 ms)\n      ✓ should skip inaccessible endpoints\n    Content Extraction\n      ✓ should extract content from endpoint (1 ms)\n      ✓ should handle text content\n      ✓ should handle extraction errors (1 ms)\n    Content Transformation\n      ✓ should transform JSON content\n      ✓ should transform HTML content (1 ms)\n      ✓ should handle plain text content\n    Change Detection\n      ✓ should detect changes using ETag\n      ✓ should detect no changes with same ETag (1 ms)\n      ✓ should fallback to last-modified when no ETag\n    Helper Methods\n      ✓ should setup authentication headers (2 ms)\n      ✓ should handle basic authentication\n      ✓ should handle API key authentication\n      ✓ should extract title from JSON content (1 ms)\n      ✓ should extract title from HTML content\n      ✓ should clean HTML content (1 ms)\n      ✓ should generate document ID\n      ✓ should count words correctly\n    Cleanup\n      ✓ should cleanup resources (1 ms)\n\nPASS tests/unit/monitoring/QualityMiddleware.test.js\n  QualityMiddleware\n    apiMonitoring middleware\n      ✓ should record API request metrics (1 ms)\n      ✓ should handle requests without user\n      ✓ should handle requests without route\n      ✓ should handle metrics recording errors gracefully (1 ms)\n    wrapDatabaseOperation\n      ✓ should record successful database operation\n      ✓ should record failed database operation (6 ms)\n      ✓ should handle metrics recording errors gracefully (1 ms)\n    wrapLLMProcessing\n      ✓ should record successful LLM processing\n      ✓ should record failed LLM processing (1 ms)\n    wrapOperation\n      ✓ should record successful generic operation\n      ✓ should record failed generic operation (1 ms)\n    errorMonitoring middleware\n      ✓ should record error metrics\n      ✓ should handle errors without status\n    healthCheck endpoint\n      ✓ should return healthy status (1 ms)\n      ✓ should return degraded status for critical violations (2 ms)\n      ✓ should handle errors gracefully\n    metricsEndpoint\n      ✓ should return specific metric data\n      ✓ should return quality report when no specific metric requested\n      ✓ should handle errors gracefully\n    sloEndpoint\n      ✓ should return specific SLO compliance (1 ms)\n      ✓ should return all SLO compliance when no specific SLO requested\n      ✓ should handle errors gracefully\n\nPASS tests/unit/ingestion/types.test.js\n  Ingestion Types\n    SOURCE_TYPES\n      ✓ should have all required source types (1 ms)\n      ✓ should have exactly 4 source types\n    VISIBILITY_LEVELS\n      ✓ should have all required visibility levels (1 ms)\n      ✓ should have exactly 3 visibility levels\n    PROCESSING_STATUS\n      ✓ should have all required processing statuses (1 ms)\n      ✓ should have exactly 7 processing statuses\n    BaseSourceHandler\n      ✓ should initialize with correct configuration\n      ✓ should throw error when calling abstract methods (5 ms)\n      ✓ should accept any configuration without validation\n      ✓ should store configuration as provided (1 ms)\n\nPASS tests/unit/tracing/TracingManager.test.js\n  TracingManager\n    constructor\n      ✓ should initialize with default options\n      ✓ should initialize with custom options\n    startSpan\n      ✓ should start a new span when enabled (1 ms)\n      ✓ should return no-op span when disabled\n    RAG-specific spans\n      ✓ should create query span with correct attributes (1 ms)\n      ✓ should create retrieval span with correct attributes\n      ✓ should create generation span with correct attributes\n    generateTraceId\n      ✓ should generate a valid UUID (1 ms)\n      ✓ should generate unique IDs (2 ms)\n\nSummary of all failing tests\nFAIL tests/unit/web/routes/reliability.test.js\n  ● Reliability Routes › GET /sources/:sourceId › should force recalculation when requested\n\n    expected 200 \"OK\", got 401 \"Unauthorized\"\n\n      101 |       const response = await request(app)\n      102 |         .get('/api/v1/reliability/sources/source-1?recalculate=true')\n    > 103 |         .expect(200);\n          |          ^\n      104 |\n      105 |       expect(response.body.success).toBe(true);\n      106 |       expect(response.body.data).toEqual(mockScore);\n\n      at Object.expect (tests/unit/web/routes/reliability.test.js:103:10)\n      ----\n      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)\n      at node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)\n\nFAIL tests/unit/web/components/CurationBoard.test.js\n  ● Test suite failed to run\n\n    Jest encountered an unexpected token\n\n    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.\n\n    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.\n\n    By default \"node_modules\" folder is ignored by transformers.\n\n    Here's what you can do:\n     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.\n     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript\n     • To have some of your \"node_modules\" files transformed, you can specify a custom \"transformIgnorePatterns\" in your config.\n     • If you need a custom transformation specify a \"transform\" option in your config.\n     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the \"moduleNameMapper\" config option.\n\n    You'll find more details and examples of these config options in the docs:\n    https://jestjs.io/docs/configuration\n    For information about custom transformations, see:\n    https://jestjs.io/docs/code-transformation\n\n    Details:\n\n    SyntaxError: /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/components/CurationBoard.test.js: Unexpected token (8:6)\n\n       6 | const { render, screen, fireEvent, waitFor, within } = require('@testing-library/react');\n       7 | const userEvent = require('@testing-library/user-event');\n    >  8 | const '@testing-library/jest-dom';\n         |       ^\n       9 | const CurationBoard = require('../../../../src/web/components/curation/CurationBoard');\n      10 |\n      11 | // Mock fetch\n\n      at constructor (node_modules/@babel/parser/src/parse-error.ts:95:45)\n      at Parser.toParseError [as raise] (node_modules/@babel/parser/src/tokenizer/index.ts:1503:19)\n      at Parser.raise [as unexpected] (node_modules/@babel/parser/src/tokenizer/index.ts:1543:16)\n      at Parser.unexpected [as parseIdentifierName] (node_modules/@babel/parser/src/parser/expression.ts:2790:12)\n      at Parser.parseIdentifierName [as parseIdentifier] (node_modules/@babel/parser/src/parser/expression.ts:2759:23)\n      at Parser.parseIdentifier [as parseBindingAtom] (node_modules/@babel/parser/src/parser/lval.ts:391:17)\n      at Parser.parseBindingAtom [as parseVarId] (node_modules/@babel/parser/src/parser/statement.ts:1603:21)\n      at Parser.parseVarId [as parseVar] (node_modules/@babel/parser/src/parser/statement.ts:1562:12)\n      at Parser.parseVar [as parseVarStatement] (node_modules/@babel/parser/src/parser/statement.ts:1231:10)\n      at Parser.parseVarStatement [as parseStatementContent] (node_modules/@babel/parser/src/parser/statement.ts:587:21)\n      at Parser.parseStatementContent [as parseStatementLike] (node_modules/@babel/parser/src/parser/statement.ts:456:17)\n      at Parser.parseStatementLike [as parseModuleItem] (node_modules/@babel/parser/src/parser/statement.ts:393:17)\n      at Parser.parseModuleItem [as parseBlockOrModuleBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1423:16)\n      at Parser.parseBlockOrModuleBlockBody [as parseBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1397:10)\n      at Parser.parseBlockBody [as parseProgram] (node_modules/@babel/parser/src/parser/statement.ts:225:10)\n      at Parser.parseProgram [as parseTopLevel] (node_modules/@babel/parser/src/parser/statement.ts:203:25)\n      at Parser.parseTopLevel [as parse] (node_modules/@babel/parser/src/parser/index.ts:93:10)\n      at parse (node_modules/@babel/parser/src/index.ts:92:38)\n      at parser (node_modules/@babel/core/src/parser/index.ts:28:19)\n          at parser.next (<anonymous>)\n      at normalizeFile (node_modules/@babel/core/src/transformation/normalize-file.ts:49:24)\n          at normalizeFile.next (<anonymous>)\n      at run (node_modules/@babel/core/src/transformation/index.ts:40:36)\n          at run.next (<anonymous>)\n      at transform (node_modules/@babel/core/src/transform.ts:29:20)\n          at transform.next (<anonymous>)\n      at evaluateSync (node_modules/gensync/index.js:251:28)\n      at sync (node_modules/gensync/index.js:89:14)\n      at fn (node_modules/@babel/core/src/errors/rewrite-stack-trace.ts:99:14)\n      at transformSync (node_modules/@babel/core/src/transform.ts:66:52)\n      at ScriptTransformer.transformSource (node_modules/@jest/transform/build/ScriptTransformer.js:545:31)\n      at ScriptTransformer._transformAndBuildScript (node_modules/@jest/transform/build/ScriptTransformer.js:674:40)\n      at ScriptTransformer.transform (node_modules/@jest/transform/build/ScriptTransformer.js:726:19)\n\nFAIL tests/unit/web/components/AdminDashboard.test.js\n  ● Test suite failed to run\n\n    Jest encountered an unexpected token\n\n    Jest failed to parse a file. This happens e.g. when your code or its dependencies use non-standard JavaScript syntax, or when Jest is not configured to support such syntax.\n\n    Out of the box Jest supports Babel, which will be used to transform your files into valid JS based on your Babel configuration.\n\n    By default \"node_modules\" folder is ignored by transformers.\n\n    Here's what you can do:\n     • If you are trying to use ECMAScript Modules, see https://jestjs.io/docs/ecmascript-modules for how to enable it.\n     • If you are trying to use TypeScript, see https://jestjs.io/docs/getting-started#using-typescript\n     • To have some of your \"node_modules\" files transformed, you can specify a custom \"transformIgnorePatterns\" in your config.\n     • If you need a custom transformation specify a \"transform\" option in your config.\n     • If you simply want to mock your non-JS modules (e.g. binary assets) you can stub them out with the \"moduleNameMapper\" config option.\n\n    You'll find more details and examples of these config options in the docs:\n    https://jestjs.io/docs/configuration\n    For information about custom transformations, see:\n    https://jestjs.io/docs/code-transformation\n\n    Details:\n\n    SyntaxError: /Users/charlieirwin/Documents/GitHub/TheWell_Pipeline/tests/unit/web/components/AdminDashboard.test.js: Unexpected token (7:6)\n\n       5 | const React = require('react');\n       6 | const { render, screen, fireEvent, waitFor } = require('@testing-library/react');\n    >  7 | const '@testing-library/jest-dom';\n         |       ^\n       8 | const AdminDashboard = require('../../../../src/web/components/admin/AdminDashboard');\n       9 |\n      10 | // Mock the fetch API\n\n      at constructor (node_modules/@babel/parser/src/parse-error.ts:95:45)\n      at Parser.toParseError [as raise] (node_modules/@babel/parser/src/tokenizer/index.ts:1503:19)\n      at Parser.raise [as unexpected] (node_modules/@babel/parser/src/tokenizer/index.ts:1543:16)\n      at Parser.unexpected [as parseIdentifierName] (node_modules/@babel/parser/src/parser/expression.ts:2790:12)\n      at Parser.parseIdentifierName [as parseIdentifier] (node_modules/@babel/parser/src/parser/expression.ts:2759:23)\n      at Parser.parseIdentifier [as parseBindingAtom] (node_modules/@babel/parser/src/parser/lval.ts:391:17)\n      at Parser.parseBindingAtom [as parseVarId] (node_modules/@babel/parser/src/parser/statement.ts:1603:21)\n      at Parser.parseVarId [as parseVar] (node_modules/@babel/parser/src/parser/statement.ts:1562:12)\n      at Parser.parseVar [as parseVarStatement] (node_modules/@babel/parser/src/parser/statement.ts:1231:10)\n      at Parser.parseVarStatement [as parseStatementContent] (node_modules/@babel/parser/src/parser/statement.ts:587:21)\n      at Parser.parseStatementContent [as parseStatementLike] (node_modules/@babel/parser/src/parser/statement.ts:456:17)\n      at Parser.parseStatementLike [as parseModuleItem] (node_modules/@babel/parser/src/parser/statement.ts:393:17)\n      at Parser.parseModuleItem [as parseBlockOrModuleBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1423:16)\n      at Parser.parseBlockOrModuleBlockBody [as parseBlockBody] (node_modules/@babel/parser/src/parser/statement.ts:1397:10)\n      at Parser.parseBlockBody [as parseProgram] (node_modules/@babel/parser/src/parser/statement.ts:225:10)\n      at Parser.parseProgram [as parseTopLevel] (node_modules/@babel/parser/src/parser/statement.ts:203:25)\n      at Parser.parseTopLevel [as parse] (node_modules/@babel/parser/src/parser/index.ts:93:10)\n      at parse (node_modules/@babel/parser/src/index.ts:92:38)\n      at parser (node_modules/@babel/core/src/parser/index.ts:28:19)\n          at parser.next (<anonymous>)\n      at normalizeFile (node_modules/@babel/core/src/transformation/normalize-file.ts:49:24)\n          at normalizeFile.next (<anonymous>)\n      at run (node_modules/@babel/core/src/transformation/index.ts:40:36)\n          at run.next (<anonymous>)\n      at transform (node_modules/@babel/core/src/transform.ts:29:20)\n          at transform.next (<anonymous>)\n      at evaluateSync (node_modules/gensync/index.js:251:28)\n      at sync (node_modules/gensync/index.js:89:14)\n      at fn (node_modules/@babel/core/src/errors/rewrite-stack-trace.ts:99:14)\n      at transformSync (node_modules/@babel/core/src/transform.ts:66:52)\n      at ScriptTransformer.transformSource (node_modules/@jest/transform/build/ScriptTransformer.js:545:31)\n      at ScriptTransformer._transformAndBuildScript (node_modules/@jest/transform/build/ScriptTransformer.js:674:40)\n      at ScriptTransformer.transform (node_modules/@jest/transform/build/ScriptTransformer.js:726:19)\n\nFAIL tests/unit/cache/CacheManager.test.js\n  ● CacheManager › Initialization › should initialize with default configuration\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: \"localhost\"\n    Received: \"redis\"\n\n      89 |       const cache = new CacheManager();\n      90 |       expect(cache.config).toBeDefined();\n    > 91 |       expect(cache.config.redis.host).toBe('localhost');\n         |                                       ^\n      92 |       expect(cache.config.redis.port).toBe(6379);\n      93 |       expect(cache.config.ttl.default).toBe(3600);\n      94 |     });\n\n      at Object.toBe (tests/unit/cache/CacheManager.test.js:91:39)\n\nFAIL tests/unit/ingestion/queue/QueueManager.test.js\n  ● QueueManager › Initialization › should initialize successfully\n\n    expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\n    Expected: \"ingestion-queue\", ObjectContaining {\"defaultJobOptions\": Any<Object>, \"redis\": ObjectContaining {\"socket\": {\"host\": \"localhost\", \"port\": 6379}}}\n    Received: \"ingestion-queue\", {\"defaultJobOptions\": {\"attempts\": 3, \"backoff\": {\"delay\": 2000, \"type\": \"exponential\"}, \"removeOnComplete\": 100, \"removeOnFail\": 50}, \"redis\": \"redis://localhost:6379\"}\n\n    Number of calls: 1\n\n      68 |       });\n      69 |       expect(mockRedisClient.connect).toHaveBeenCalled();\n    > 70 |       expect(Bull).toHaveBeenCalledWith('ingestion-queue', expect.objectContaining({\n         |                    ^\n      71 |         redis: expect.objectContaining({\n      72 |           socket: {\n      73 |             host: 'localhost',\n\n      at Object.toHaveBeenCalledWith (tests/unit/ingestion/queue/QueueManager.test.js:70:20)\n\nFAIL tests/unit/database/MigrationManager.test.js\n  ● MigrationManager › parseMigrationFile › should parse migration file into forward and rollback scripts\n\n    TypeError: migrationManager.parseMigrationFile is not a function\n\n      143 | DROP TABLE test;`;\n      144 |\n    > 145 |       const result = migrationManager.parseMigrationFile(content);\n          |                                       ^\n      146 |\n      147 |       expect(result.forward).toContain('CREATE TABLE test');\n      148 |       expect(result.rollback).toContain('DROP TABLE test');\n\n      at Object.parseMigrationFile (tests/unit/database/MigrationManager.test.js:145:39)\n\n  ● MigrationManager › parseMigrationFile › should handle migration with no rollback section\n\n    TypeError: migrationManager.parseMigrationFile is not a function\n\n      152 |       const content = 'CREATE TABLE test (id INTEGER);';\n      153 |\n    > 154 |       const result = migrationManager.parseMigrationFile(content);\n          |                                       ^\n      155 |\n      156 |       expect(result.forward).toContain('CREATE TABLE test');\n      157 |       expect(result.rollback).toBe('');\n\n      at Object.parseMigrationFile (tests/unit/database/MigrationManager.test.js:154:39)\n\n  ● MigrationManager › applyMigration › should apply migration successfully\n\n    expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\n    Expected: \"CREATE TABLE test (id INTEGER);\"\n    Received\n           1: \"BEGIN\"\n           2: \"INSERT INTO schema_migrations (version, name, rollback_script, checksum)·\n                       VALUES ($1, $2, $3, $4)\", [{\"filename\": \"0001_test_migration.sql\", \"name\": \"test_migration\", \"version\": \"0001\"}, undefined, \"\", \"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\"]\n           3: \"COMMIT\"\n\n    Number of calls: 4\n\n      178 |\n      179 |       expect(mockClient.query).toHaveBeenCalledWith('BEGIN');\n    > 180 |       expect(mockClient.query).toHaveBeenCalledWith('CREATE TABLE test (id INTEGER);');\n          |                                ^\n      181 |       expect(mockClient.query).toHaveBeenCalledWith(\n      182 |         expect.stringContaining('INSERT INTO schema_migrations'),\n      183 |         expect.arrayContaining(['0001', 'test_migration'])\n\n      at Object.toHaveBeenCalledWith (tests/unit/database/MigrationManager.test.js:180:32)\n\n  ● MigrationManager › applyMigration › should rollback transaction on error\n\n    expect(received).rejects.toThrow()\n\n    Received promise resolved instead of rejected\n    Resolved to value: undefined\n\n      201 |       });\n      202 |\n    > 203 |       await expect(migrationManager.applyMigration(migration)).rejects.toThrow('Failed to apply migration');\n          |             ^\n      204 |\n      205 |       expect(mockClient.query).toHaveBeenCalledWith('ROLLBACK');\n      206 |       expect(mockClient.release).toHaveBeenCalled();\n\n      at expect (node_modules/expect/build/index.js:113:15)\n      at Object.expect (tests/unit/database/MigrationManager.test.js:203:13)\n\n  ● MigrationManager › rollbackMigration › should rollback migration successfully\n\n    Empty rollback script provided for migration 0001 (undefined)\n\n      225 |   async rollbackMigration(version, name, rollbackScriptContent) {\n      226 |     if (!rollbackScriptContent || rollbackScriptContent.trim() === '') {\n    > 227 |       throw new Error(`Empty rollback script provided for migration ${version} (${name})`);\n          |             ^\n      228 |     }\n      229 |\n      230 |     const client = await this.db.getClient();\n\n      at MigrationManager.rollbackMigration (src/database/MigrationManager.js:227:13)\n      at Object.rollbackMigration (tests/unit/database/MigrationManager.test.js:222:30)\n\n  ● MigrationManager › rollbackMigration › should throw error if migration not found\n\n    expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"Migration 0001 not found in applied migrations\"\n    Received message:   \"Empty rollback script provided for migration 0001 (undefined)\"\n\n          225 |   async rollbackMigration(version, name, rollbackScriptContent) {\n          226 |     if (!rollbackScriptContent || rollbackScriptContent.trim() === '') {\n        > 227 |       throw new Error(`Empty rollback script provided for migration ${version} (${name})`);\n              |             ^\n          228 |     }\n          229 |\n          230 |     const client = await this.db.getClient();\n\n      at MigrationManager.rollbackMigration (src/database/MigrationManager.js:227:13)\n      at Object.rollbackMigration (tests/unit/database/MigrationManager.test.js:236:37)\n      at Object.toThrow (node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (tests/unit/database/MigrationManager.test.js:236:72)\n\n  ● MigrationManager › rollbackMigration › should throw error if rollback script is empty\n\n    expect(received).rejects.toThrow(expected)\n\n    Expected substring: \"Empty rollback script for migration 0001\"\n    Received message:   \"Empty rollback script provided for migration 0001 (undefined)\"\n\n          225 |   async rollbackMigration(version, name, rollbackScriptContent) {\n          226 |     if (!rollbackScriptContent || rollbackScriptContent.trim() === '') {\n        > 227 |       throw new Error(`Empty rollback script provided for migration ${version} (${name})`);\n              |             ^\n          228 |     }\n          229 |\n          230 |     const client = await this.db.getClient();\n\n      at MigrationManager.rollbackMigration (src/database/MigrationManager.js:227:13)\n      at Object.rollbackMigration (tests/unit/database/MigrationManager.test.js:251:37)\n      at Object.toThrow (node_modules/expect/build/index.js:218:22)\n      at Object.toThrow (tests/unit/database/MigrationManager.test.js:251:72)\n\n  ● MigrationManager › migrate › should apply all pending migrations\n\n    expect(jest.fn()).toHaveBeenCalledWith(...expected)\n\n    Expected: {\"filename\": \"0001_migration1.sql\", \"name\": \"migration1\", \"version\": \"0001\"}\n    Received\n           1: \"0001\", \"migration1\", \"CREATE TABLE test (id INTEGER);\"\n           2: \"0002\", \"migration2\", \"CREATE TABLE test (id INTEGER);\"\n\n    Number of calls: 2\n\n      268 |\n      269 |       expect(migrationManager.applyMigration).toHaveBeenCalledTimes(2);\n    > 270 |       expect(migrationManager.applyMigration).toHaveBeenCalledWith(pendingMigrations[0]);\n          |                                               ^\n      271 |       expect(migrationManager.applyMigration).toHaveBeenCalledWith(pendingMigrations[1]);\n      272 |     });\n      273 |\n\n      at Object.toHaveBeenCalledWith (tests/unit/database/MigrationManager.test.js:270:47)\n\n\nTest Suites: 6 failed, 58 passed, 64 total\nTests:       11 failed, 2 skipped, 1477 passed, 1490 total\nSnapshots:   0 total\nTime:        38.723 s\nRan all test suites matching /tests\\/unit/i.\nTest results written to: test-results.json\n"
  },
  "performance": {
    "healthCheckMs": 2.508,
    "apiAvailable": true
  },
  "build": {
    "success": true,
    "durationMs": 106,
    "durationMinutes": 0.0017666666666666666
  },
  "api": {
    "compatible": true,
    "endpoints": 0,
    "breaking": 0,
    "note": "No contract tests found"
  },
  "database": {
    "migrationsUpToDate": true,
    "connectionHealthy": true
  },
  "docker": {
    "imageSize": "",
    "available": true
  }
}