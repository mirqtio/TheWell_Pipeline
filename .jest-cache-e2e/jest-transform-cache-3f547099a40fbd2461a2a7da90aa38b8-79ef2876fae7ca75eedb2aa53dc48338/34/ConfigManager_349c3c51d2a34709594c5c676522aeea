41919f030a2413485616039b3ab84306
const chokidar = require('chokidar');
const path = require('path');
const fs = require('fs').promises;
const EventEmitter = require('events');
const Joi = require('joi');
const logger = require('../utils/logger');

/**
 * ConfigManager handles hot-reloading of configuration files
 * Monitors configuration directory and applies changes at runtime
 */
class ConfigManager extends EventEmitter {
  constructor(options = {}) {
    super();
    this.configDir = options.configDir || path.join(process.cwd(), 'config');
    this.watchOptions = options.watchOptions || {};
    this.watcher = null;
    this.isWatching = false;
    this.validators = new Map();
    this.loadedConfigs = new Map();

    // Default configuration schema
    this.registerValidator('sources', this.getSourceConfigSchema());
    this.registerValidator('ingestion', this.getIngestionConfigSchema());
    this.registerValidator('queue', this.getQueueConfigSchema());
  }

  /**
   * Backward compatibility getter for configs
   */
  get configs() {
    return this.loadedConfigs;
  }

  /**
   * Start watching configuration files for changes
   */
  async startWatching() {
    if (this.isWatching) {
      logger.warn('ConfigManager is already watching');
      return;
    }
    try {
      await this.ensureConfigDirectory();

      // Create watcher for configuration directory
      this.watcher = chokidar.watch(this.configDir, {
        ignored: /(^|[\\])\../,
        // ignore dotfiles
        persistent: true,
        ...this.watchOptions
      });

      // Debug: log what we're watching
      logger.debug('Creating watcher for directory', {
        configDir: this.configDir,
        watchOptions: {
          persistent: true,
          ...this.watchOptions
        }
      });

      // Ensure watcher was created successfully
      if (!this.watcher) {
        throw new Error('Failed to create file watcher');
      }

      // Set up event handlers
      this.watcher.on('add', filePath => {
        logger.debug('Watcher detected file add', {
          filePath
        });
        this.handleFileChange('add', filePath);
      }).on('change', filePath => {
        logger.debug('Watcher detected file change', {
          filePath
        });
        this.handleFileChange('change', filePath);
      }).on('unlink', filePath => {
        logger.debug('Watcher detected file unlink', {
          filePath
        });
        this.handleFileChange('unlink', filePath);
      }).on('error', error => this.handleWatcherError(error)).on('all', (eventType, filePath) => {
        logger.debug('Watcher detected any event', {
          eventType,
          filePath
        });
      });

      // Wait for watcher to be ready
      await new Promise((resolve, reject) => {
        const timeout = setTimeout(() => {
          reject(new Error('Watcher ready timeout'));
        }, 5000);
        this.watcher.on('ready', () => {
          clearTimeout(timeout);
          this.isWatching = true;
          logger.info('ConfigManager: Started watching configuration files', {
            configDir: this.configDir
          });
          this.emit('ready');
          resolve();
        });
      });
    } catch (error) {
      logger.error('Failed to start ConfigManager watcher', {
        error: error.message
      });
      if (this.watcher) {
        await this.watcher.close();
        this.watcher = null;
      }
      throw error;
    }
  }

  /**
   * Stop watching configuration files
   */
  async stopWatching() {
    if (!this.isWatching && !this.watcher) {
      return;
    }
    try {
      this.isWatching = false;
      if (this.watcher) {
        // Remove all listeners to prevent memory leaks
        this.watcher.removeAllListeners();
        await this.watcher.close();
        this.watcher = null;
      }
      logger.info('ConfigManager: Stopped watching configuration files');
      this.emit('stopped');
    } catch (error) {
      logger.error('Error stopping ConfigManager watcher', {
        error: error.message
      });
      // Force cleanup even if close() fails
      if (this.watcher) {
        this.watcher.removeAllListeners();
        this.watcher = null;
      }
      this.isWatching = false;
      throw error;
    }
  }

  /**
   * Register a configuration validator
   */
  registerValidator(configType, schema) {
    if (!configType || !schema) {
      throw new Error('Config type and schema are required');
    }
    this.validators.set(configType, schema);
    logger.debug('Registered validator for config type', {
      configType
    });
  }

  /**
   * Get current configuration for a specific type
   */
  getConfig(configType) {
    return this.loadedConfigs.get(configType);
  }

  /**
   * Get all current configurations
   */
  getAllConfigs() {
    return Object.fromEntries(this.loadedConfigs);
  }

  /**
   * Manually load a configuration file
   */
  async loadConfig(filePath) {
    try {
      const configType = this.getConfigTypeFromPath(filePath);
      const config = await this.readConfigFile(filePath);
      if (config) {
        const validatedConfig = await this.validateConfig(configType, config);
        await this.applyConfigChange(configType, validatedConfig, filePath);
      }
    } catch (error) {
      logger.error('Failed to load configuration', {
        filePath,
        error: error.message
      });
      throw error;
    }
  }

  /**
   * Handle file system changes
   */
  async handleFileChange(eventType, filePath) {
    try {
      const configType = this.getConfigTypeFromPath(filePath);
      if (!configType) {
        logger.debug('Ignoring non-config file', {
          filePath,
          eventType
        });
        return;
      }
      logger.info('Configuration file changed', {
        eventType,
        filePath,
        configType
      });
      switch (eventType) {
        case 'add':
        case 'change':
          await this.handleConfigUpdate(configType, filePath);
          break;
        case 'unlink':
          await this.handleConfigRemoval(configType, filePath);
          break;
      }
    } catch (error) {
      logger.error('Error handling configuration file change', {
        eventType,
        filePath,
        error: error.message
      });
      this.emit('error', {
        type: 'config-change-error',
        eventType,
        filePath,
        error
      });
    }
  }

  /**
   * Handle configuration file updates
   */
  async handleConfigUpdate(configType, filePath) {
    try {
      const config = await this.readConfigFile(filePath);
      if (!config) {
        logger.warn('Empty or invalid configuration file', {
          filePath
        });
        return;
      }

      // Substitute environment variables
      const configWithEnvVars = this.substituteEnvironmentVariables(config);

      // Validate configuration
      const validatedConfig = await this.validateConfig(configType, configWithEnvVars);

      // Apply changes
      await this.applyConfigChange(configType, validatedConfig, filePath);
    } catch (error) {
      logger.error('Failed to update configuration', {
        configType,
        filePath,
        error: error.message
      });
      throw error;
    }
  }

  /**
   * Handle configuration file removal
   */
  async handleConfigRemoval(configType, filePath) {
    try {
      const previousConfig = this.loadedConfigs.get(configType);
      if (previousConfig) {
        this.loadedConfigs.delete(configType);
        logger.info('Configuration removed', {
          configType,
          filePath
        });
        this.emit('config-removed', {
          configType,
          filePath,
          previousConfig
        });
      }
    } catch (error) {
      logger.error('Error handling configuration removal', {
        configType,
        filePath,
        error: error.message
      });
      throw error;
    }
  }

  /**
   * Apply validated configuration changes
   */
  async applyConfigChange(configType, newConfig, filePath) {
    try {
      const previousConfig = this.loadedConfigs.get(configType);

      // Store new configuration
      this.loadedConfigs.set(configType, newConfig);
      logger.info('Configuration updated successfully', {
        configType,
        filePath,
        hasChanges: JSON.stringify(previousConfig) !== JSON.stringify(newConfig)
      });

      // Emit configuration change event
      this.emit('config-changed', {
        configType,
        filePath,
        newConfig,
        previousConfig
      });
    } catch (error) {
      logger.error('Failed to apply configuration change', {
        configType,
        filePath,
        error: error.message
      });
      throw error;
    }
  }

  /**
   * Validate configuration against registered schema
   */
  async validateConfig(configType, config) {
    const validator = this.validators.get(configType);
    if (!validator) {
      logger.warn('No validator found for config type', {
        configType
      });
      return config;
    }
    try {
      const {
        error,
        value
      } = validator.validate(config, {
        abortEarly: false,
        allowUnknown: true
      });
      if (error) {
        const validationError = new Error(`Configuration validation failed: ${error.message}`);
        validationError.details = error.details;
        throw validationError;
      }
      return value;
    } catch (error) {
      logger.error('Configuration validation failed', {
        configType,
        error: error.message,
        details: error.details
      });
      throw error;
    }
  }

  /**
   * Read and parse configuration file
   */
  async readConfigFile(filePath) {
    try {
      const content = await fs.readFile(filePath, 'utf8');
      if (filePath.endsWith('.json')) {
        return JSON.parse(content);
      } else if (filePath.endsWith('.js')) {
        // Clear require cache for hot reloading
        delete require.cache[require.resolve(filePath)];
        return require(filePath);
      }
      return null;
    } catch (error) {
      if (error.code === 'ENOENT') {
        logger.debug('Configuration file not found', {
          filePath
        });
        return null;
      }
      logger.error('Error reading configuration file', {
        filePath,
        error: error.message
      });
      throw error;
    }
  }

  /**
   * Determine configuration type from file path
   */
  getConfigTypeFromPath(filePath) {
    const basename = path.basename(filePath, path.extname(filePath));
    const validTypes = ['sources', 'ingestion', 'queue', 'enrichment'];
    return validTypes.find(type => basename.includes(type)) || null;
  }

  /**
   * Ensure configuration directory exists
   */
  async ensureConfigDirectory() {
    try {
      await fs.access(this.configDir);
    } catch (error) {
      if (error.code === 'ENOENT') {
        await fs.mkdir(this.configDir, {
          recursive: true
        });
        logger.info('Created configuration directory', {
          configDir: this.configDir
        });
      } else {
        throw error;
      }
    }
  }

  /**
   * Handle watcher errors
   */
  handleWatcherError(error) {
    logger.error('ConfigManager watcher error', {
      error: error.message
    });
    this.emit('error', {
      type: 'watcher-error',
      error
    });
  }

  /**
   * Get source configuration schema
   */
  getSourceConfigSchema() {
    return Joi.object({
      sources: Joi.array().items(Joi.object({
        id: Joi.string().required(),
        type: Joi.string().valid('static', 'semi-static', 'dynamic-consistent', 'dynamic-unstructured').required(),
        name: Joi.string().required(),
        enabled: Joi.boolean().default(true),
        config: Joi.object().required(),
        schedule: Joi.string().when('type', {
          is: Joi.string().valid('semi-static', 'dynamic-consistent', 'dynamic-unstructured'),
          then: Joi.required(),
          otherwise: Joi.optional()
        })
      })).required()
    });
  }

  /**
   * Get ingestion configuration schema
   */
  getIngestionConfigSchema() {
    return Joi.object({
      batchSize: Joi.number().integer().min(1).max(1000).default(100),
      maxRetries: Joi.number().integer().min(0).max(10).default(3),
      retryDelay: Joi.number().integer().min(1000).default(5000),
      timeout: Joi.number().integer().min(5000).default(30000),
      concurrency: Joi.number().integer().min(1).max(10).default(3),
      enableValidation: Joi.boolean().default(true),
      outputFormat: Joi.string().valid('json', 'jsonl').default('json')
    });
  }

  /**
   * Get queue configuration schema
   */
  getQueueConfigSchema() {
    return Joi.object({
      redis: Joi.object({
        host: Joi.string().default('localhost'),
        port: Joi.number().integer().min(1).max(65535).default(6379),
        password: Joi.string().optional(),
        db: Joi.number().integer().min(0).default(0)
      }).default(),
      queues: Joi.object({
        defaultJobOptions: Joi.object({
          removeOnComplete: Joi.number().integer().min(0).default(100),
          removeOnFail: Joi.number().integer().min(0).default(50),
          attempts: Joi.number().integer().min(1).default(3),
          backoff: Joi.object({
            type: Joi.string().valid('fixed', 'exponential').default('exponential'),
            delay: Joi.number().integer().min(1000).default(2000)
          }).default()
        }).default(),
        concurrency: Joi.number().integer().min(1).max(50).default(5)
      }).default()
    });
  }

  /**
   * Get configuration statistics
   */
  getStats() {
    return {
      isWatching: this.isWatching,
      configDir: this.configDir,
      configCount: this.loadedConfigs.size,
      validatorCount: this.validators.size,
      configTypes: Array.from(this.loadedConfigs.keys())
    };
  }

  /**
   * Substitute environment variables in configuration
   */
  substituteEnvironmentVariables(config) {
    const envRegex = /\${([^}]+)}/g;
    return JSON.parse(JSON.stringify(config).replace(envRegex, (match, varName) => process.env[varName] || match));
  }
}
module.exports = ConfigManager;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjaG9raWRhciIsInJlcXVpcmUiLCJwYXRoIiwiZnMiLCJwcm9taXNlcyIsIkV2ZW50RW1pdHRlciIsIkpvaSIsImxvZ2dlciIsIkNvbmZpZ01hbmFnZXIiLCJjb25zdHJ1Y3RvciIsIm9wdGlvbnMiLCJjb25maWdEaXIiLCJqb2luIiwicHJvY2VzcyIsImN3ZCIsIndhdGNoT3B0aW9ucyIsIndhdGNoZXIiLCJpc1dhdGNoaW5nIiwidmFsaWRhdG9ycyIsIk1hcCIsImxvYWRlZENvbmZpZ3MiLCJyZWdpc3RlclZhbGlkYXRvciIsImdldFNvdXJjZUNvbmZpZ1NjaGVtYSIsImdldEluZ2VzdGlvbkNvbmZpZ1NjaGVtYSIsImdldFF1ZXVlQ29uZmlnU2NoZW1hIiwiY29uZmlncyIsInN0YXJ0V2F0Y2hpbmciLCJ3YXJuIiwiZW5zdXJlQ29uZmlnRGlyZWN0b3J5Iiwid2F0Y2giLCJpZ25vcmVkIiwicGVyc2lzdGVudCIsImRlYnVnIiwiRXJyb3IiLCJvbiIsImZpbGVQYXRoIiwiaGFuZGxlRmlsZUNoYW5nZSIsImVycm9yIiwiaGFuZGxlV2F0Y2hlckVycm9yIiwiZXZlbnRUeXBlIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJ0aW1lb3V0Iiwic2V0VGltZW91dCIsImNsZWFyVGltZW91dCIsImluZm8iLCJlbWl0IiwibWVzc2FnZSIsImNsb3NlIiwic3RvcFdhdGNoaW5nIiwicmVtb3ZlQWxsTGlzdGVuZXJzIiwiY29uZmlnVHlwZSIsInNjaGVtYSIsInNldCIsImdldENvbmZpZyIsImdldCIsImdldEFsbENvbmZpZ3MiLCJPYmplY3QiLCJmcm9tRW50cmllcyIsImxvYWRDb25maWciLCJnZXRDb25maWdUeXBlRnJvbVBhdGgiLCJjb25maWciLCJyZWFkQ29uZmlnRmlsZSIsInZhbGlkYXRlZENvbmZpZyIsInZhbGlkYXRlQ29uZmlnIiwiYXBwbHlDb25maWdDaGFuZ2UiLCJoYW5kbGVDb25maWdVcGRhdGUiLCJoYW5kbGVDb25maWdSZW1vdmFsIiwidHlwZSIsImNvbmZpZ1dpdGhFbnZWYXJzIiwic3Vic3RpdHV0ZUVudmlyb25tZW50VmFyaWFibGVzIiwicHJldmlvdXNDb25maWciLCJkZWxldGUiLCJuZXdDb25maWciLCJoYXNDaGFuZ2VzIiwiSlNPTiIsInN0cmluZ2lmeSIsInZhbGlkYXRvciIsInZhbHVlIiwidmFsaWRhdGUiLCJhYm9ydEVhcmx5IiwiYWxsb3dVbmtub3duIiwidmFsaWRhdGlvbkVycm9yIiwiZGV0YWlscyIsImNvbnRlbnQiLCJyZWFkRmlsZSIsImVuZHNXaXRoIiwicGFyc2UiLCJjYWNoZSIsImNvZGUiLCJiYXNlbmFtZSIsImV4dG5hbWUiLCJ2YWxpZFR5cGVzIiwiZmluZCIsImluY2x1ZGVzIiwiYWNjZXNzIiwibWtkaXIiLCJyZWN1cnNpdmUiLCJvYmplY3QiLCJzb3VyY2VzIiwiYXJyYXkiLCJpdGVtcyIsImlkIiwic3RyaW5nIiwicmVxdWlyZWQiLCJ2YWxpZCIsIm5hbWUiLCJlbmFibGVkIiwiYm9vbGVhbiIsImRlZmF1bHQiLCJzY2hlZHVsZSIsIndoZW4iLCJpcyIsInRoZW4iLCJvdGhlcndpc2UiLCJvcHRpb25hbCIsImJhdGNoU2l6ZSIsIm51bWJlciIsImludGVnZXIiLCJtaW4iLCJtYXgiLCJtYXhSZXRyaWVzIiwicmV0cnlEZWxheSIsImNvbmN1cnJlbmN5IiwiZW5hYmxlVmFsaWRhdGlvbiIsIm91dHB1dEZvcm1hdCIsInJlZGlzIiwiaG9zdCIsInBvcnQiLCJwYXNzd29yZCIsImRiIiwicXVldWVzIiwiZGVmYXVsdEpvYk9wdGlvbnMiLCJyZW1vdmVPbkNvbXBsZXRlIiwicmVtb3ZlT25GYWlsIiwiYXR0ZW1wdHMiLCJiYWNrb2ZmIiwiZGVsYXkiLCJnZXRTdGF0cyIsImNvbmZpZ0NvdW50Iiwic2l6ZSIsInZhbGlkYXRvckNvdW50IiwiY29uZmlnVHlwZXMiLCJBcnJheSIsImZyb20iLCJrZXlzIiwiZW52UmVnZXgiLCJyZXBsYWNlIiwibWF0Y2giLCJ2YXJOYW1lIiwiZW52IiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIkNvbmZpZ01hbmFnZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgY2hva2lkYXIgPSByZXF1aXJlKCdjaG9raWRhcicpO1xuY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTtcbmNvbnN0IGZzID0gcmVxdWlyZSgnZnMnKS5wcm9taXNlcztcbmNvbnN0IEV2ZW50RW1pdHRlciA9IHJlcXVpcmUoJ2V2ZW50cycpO1xuY29uc3QgSm9pID0gcmVxdWlyZSgnam9pJyk7XG5jb25zdCBsb2dnZXIgPSByZXF1aXJlKCcuLi91dGlscy9sb2dnZXInKTtcblxuLyoqXG4gKiBDb25maWdNYW5hZ2VyIGhhbmRsZXMgaG90LXJlbG9hZGluZyBvZiBjb25maWd1cmF0aW9uIGZpbGVzXG4gKiBNb25pdG9ycyBjb25maWd1cmF0aW9uIGRpcmVjdG9yeSBhbmQgYXBwbGllcyBjaGFuZ2VzIGF0IHJ1bnRpbWVcbiAqL1xuY2xhc3MgQ29uZmlnTWFuYWdlciBleHRlbmRzIEV2ZW50RW1pdHRlciB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSkge1xuICAgIHN1cGVyKCk7XG4gICAgXG4gICAgdGhpcy5jb25maWdEaXIgPSBvcHRpb25zLmNvbmZpZ0RpciB8fCBwYXRoLmpvaW4ocHJvY2Vzcy5jd2QoKSwgJ2NvbmZpZycpO1xuICAgIHRoaXMud2F0Y2hPcHRpb25zID0gb3B0aW9ucy53YXRjaE9wdGlvbnMgfHwge307XG4gICAgdGhpcy53YXRjaGVyID0gbnVsbDtcbiAgICB0aGlzLmlzV2F0Y2hpbmcgPSBmYWxzZTtcbiAgICB0aGlzLnZhbGlkYXRvcnMgPSBuZXcgTWFwKCk7XG4gICAgdGhpcy5sb2FkZWRDb25maWdzID0gbmV3IE1hcCgpO1xuICAgIFxuICAgIC8vIERlZmF1bHQgY29uZmlndXJhdGlvbiBzY2hlbWFcbiAgICB0aGlzLnJlZ2lzdGVyVmFsaWRhdG9yKCdzb3VyY2VzJywgdGhpcy5nZXRTb3VyY2VDb25maWdTY2hlbWEoKSk7XG4gICAgdGhpcy5yZWdpc3RlclZhbGlkYXRvcignaW5nZXN0aW9uJywgdGhpcy5nZXRJbmdlc3Rpb25Db25maWdTY2hlbWEoKSk7XG4gICAgdGhpcy5yZWdpc3RlclZhbGlkYXRvcigncXVldWUnLCB0aGlzLmdldFF1ZXVlQ29uZmlnU2NoZW1hKCkpO1xuICB9XG5cbiAgLyoqXG4gICAqIEJhY2t3YXJkIGNvbXBhdGliaWxpdHkgZ2V0dGVyIGZvciBjb25maWdzXG4gICAqL1xuICBnZXQgY29uZmlncygpIHtcbiAgICByZXR1cm4gdGhpcy5sb2FkZWRDb25maWdzO1xuICB9XG5cbiAgLyoqXG4gICAqIFN0YXJ0IHdhdGNoaW5nIGNvbmZpZ3VyYXRpb24gZmlsZXMgZm9yIGNoYW5nZXNcbiAgICovXG4gIGFzeW5jIHN0YXJ0V2F0Y2hpbmcoKSB7XG4gICAgaWYgKHRoaXMuaXNXYXRjaGluZykge1xuICAgICAgbG9nZ2VyLndhcm4oJ0NvbmZpZ01hbmFnZXIgaXMgYWxyZWFkeSB3YXRjaGluZycpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBhd2FpdCB0aGlzLmVuc3VyZUNvbmZpZ0RpcmVjdG9yeSgpO1xuICAgICAgXG4gICAgICAvLyBDcmVhdGUgd2F0Y2hlciBmb3IgY29uZmlndXJhdGlvbiBkaXJlY3RvcnlcbiAgICAgIHRoaXMud2F0Y2hlciA9IGNob2tpZGFyLndhdGNoKHRoaXMuY29uZmlnRGlyLCB7XG4gICAgICAgIGlnbm9yZWQ6IC8oXnxbXFxcXF0pXFwuLi8sIC8vIGlnbm9yZSBkb3RmaWxlc1xuICAgICAgICBwZXJzaXN0ZW50OiB0cnVlLFxuICAgICAgICAuLi50aGlzLndhdGNoT3B0aW9uc1xuICAgICAgfSk7XG5cbiAgICAgIC8vIERlYnVnOiBsb2cgd2hhdCB3ZSdyZSB3YXRjaGluZ1xuICAgICAgbG9nZ2VyLmRlYnVnKCdDcmVhdGluZyB3YXRjaGVyIGZvciBkaXJlY3RvcnknLCB7IFxuICAgICAgICBjb25maWdEaXI6IHRoaXMuY29uZmlnRGlyLFxuICAgICAgICB3YXRjaE9wdGlvbnM6IHsgcGVyc2lzdGVudDogdHJ1ZSwgLi4udGhpcy53YXRjaE9wdGlvbnMgfVxuICAgICAgfSk7XG5cbiAgICAgIC8vIEVuc3VyZSB3YXRjaGVyIHdhcyBjcmVhdGVkIHN1Y2Nlc3NmdWxseVxuICAgICAgaWYgKCF0aGlzLndhdGNoZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGYWlsZWQgdG8gY3JlYXRlIGZpbGUgd2F0Y2hlcicpO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXQgdXAgZXZlbnQgaGFuZGxlcnNcbiAgICAgIHRoaXMud2F0Y2hlclxuICAgICAgICAub24oJ2FkZCcsIChmaWxlUGF0aCkgPT4ge1xuICAgICAgICAgIGxvZ2dlci5kZWJ1ZygnV2F0Y2hlciBkZXRlY3RlZCBmaWxlIGFkZCcsIHsgZmlsZVBhdGggfSk7XG4gICAgICAgICAgdGhpcy5oYW5kbGVGaWxlQ2hhbmdlKCdhZGQnLCBmaWxlUGF0aCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5vbignY2hhbmdlJywgKGZpbGVQYXRoKSA9PiB7XG4gICAgICAgICAgbG9nZ2VyLmRlYnVnKCdXYXRjaGVyIGRldGVjdGVkIGZpbGUgY2hhbmdlJywgeyBmaWxlUGF0aCB9KTtcbiAgICAgICAgICB0aGlzLmhhbmRsZUZpbGVDaGFuZ2UoJ2NoYW5nZScsIGZpbGVQYXRoKTtcbiAgICAgICAgfSlcbiAgICAgICAgLm9uKCd1bmxpbmsnLCAoZmlsZVBhdGgpID0+IHtcbiAgICAgICAgICBsb2dnZXIuZGVidWcoJ1dhdGNoZXIgZGV0ZWN0ZWQgZmlsZSB1bmxpbmsnLCB7IGZpbGVQYXRoIH0pO1xuICAgICAgICAgIHRoaXMuaGFuZGxlRmlsZUNoYW5nZSgndW5saW5rJywgZmlsZVBhdGgpO1xuICAgICAgICB9KVxuICAgICAgICAub24oJ2Vycm9yJywgKGVycm9yKSA9PiB0aGlzLmhhbmRsZVdhdGNoZXJFcnJvcihlcnJvcikpXG4gICAgICAgIC5vbignYWxsJywgKGV2ZW50VHlwZSwgZmlsZVBhdGgpID0+IHtcbiAgICAgICAgICBsb2dnZXIuZGVidWcoJ1dhdGNoZXIgZGV0ZWN0ZWQgYW55IGV2ZW50JywgeyBldmVudFR5cGUsIGZpbGVQYXRoIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgLy8gV2FpdCBmb3Igd2F0Y2hlciB0byBiZSByZWFkeVxuICAgICAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgICBjb25zdCB0aW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignV2F0Y2hlciByZWFkeSB0aW1lb3V0JykpO1xuICAgICAgICB9LCA1MDAwKTtcblxuICAgICAgICB0aGlzLndhdGNoZXIub24oJ3JlYWR5JywgKCkgPT4ge1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgICB0aGlzLmlzV2F0Y2hpbmcgPSB0cnVlO1xuICAgICAgICAgIGxvZ2dlci5pbmZvKCdDb25maWdNYW5hZ2VyOiBTdGFydGVkIHdhdGNoaW5nIGNvbmZpZ3VyYXRpb24gZmlsZXMnLCB7XG4gICAgICAgICAgICBjb25maWdEaXI6IHRoaXMuY29uZmlnRGlyXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgdGhpcy5lbWl0KCdyZWFkeScpO1xuICAgICAgICAgIHJlc29sdmUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBzdGFydCBDb25maWdNYW5hZ2VyIHdhdGNoZXInLCB7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgICAgaWYgKHRoaXMud2F0Y2hlcikge1xuICAgICAgICBhd2FpdCB0aGlzLndhdGNoZXIuY2xvc2UoKTtcbiAgICAgICAgdGhpcy53YXRjaGVyID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIHRocm93IGVycm9yO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTdG9wIHdhdGNoaW5nIGNvbmZpZ3VyYXRpb24gZmlsZXNcbiAgICovXG4gIGFzeW5jIHN0b3BXYXRjaGluZygpIHtcbiAgICBpZiAoIXRoaXMuaXNXYXRjaGluZyAmJiAhdGhpcy53YXRjaGVyKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuaXNXYXRjaGluZyA9IGZhbHNlO1xuICAgICAgXG4gICAgICBpZiAodGhpcy53YXRjaGVyKSB7XG4gICAgICAgIC8vIFJlbW92ZSBhbGwgbGlzdGVuZXJzIHRvIHByZXZlbnQgbWVtb3J5IGxlYWtzXG4gICAgICAgIHRoaXMud2F0Y2hlci5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgYXdhaXQgdGhpcy53YXRjaGVyLmNsb3NlKCk7XG4gICAgICAgIHRoaXMud2F0Y2hlciA9IG51bGw7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGxvZ2dlci5pbmZvKCdDb25maWdNYW5hZ2VyOiBTdG9wcGVkIHdhdGNoaW5nIGNvbmZpZ3VyYXRpb24gZmlsZXMnKTtcbiAgICAgIHRoaXMuZW1pdCgnc3RvcHBlZCcpO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRXJyb3Igc3RvcHBpbmcgQ29uZmlnTWFuYWdlciB3YXRjaGVyJywgeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9KTtcbiAgICAgIC8vIEZvcmNlIGNsZWFudXAgZXZlbiBpZiBjbG9zZSgpIGZhaWxzXG4gICAgICBpZiAodGhpcy53YXRjaGVyKSB7XG4gICAgICAgIHRoaXMud2F0Y2hlci5yZW1vdmVBbGxMaXN0ZW5lcnMoKTtcbiAgICAgICAgdGhpcy53YXRjaGVyID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIHRoaXMuaXNXYXRjaGluZyA9IGZhbHNlO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJlZ2lzdGVyIGEgY29uZmlndXJhdGlvbiB2YWxpZGF0b3JcbiAgICovXG4gIHJlZ2lzdGVyVmFsaWRhdG9yKGNvbmZpZ1R5cGUsIHNjaGVtYSkge1xuICAgIGlmICghY29uZmlnVHlwZSB8fCAhc2NoZW1hKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvbmZpZyB0eXBlIGFuZCBzY2hlbWEgYXJlIHJlcXVpcmVkJyk7XG4gICAgfVxuICAgIFxuICAgIHRoaXMudmFsaWRhdG9ycy5zZXQoY29uZmlnVHlwZSwgc2NoZW1hKTtcbiAgICBsb2dnZXIuZGVidWcoJ1JlZ2lzdGVyZWQgdmFsaWRhdG9yIGZvciBjb25maWcgdHlwZScsIHsgY29uZmlnVHlwZSB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBjb25maWd1cmF0aW9uIGZvciBhIHNwZWNpZmljIHR5cGVcbiAgICovXG4gIGdldENvbmZpZyhjb25maWdUeXBlKSB7XG4gICAgcmV0dXJuIHRoaXMubG9hZGVkQ29uZmlncy5nZXQoY29uZmlnVHlwZSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGFsbCBjdXJyZW50IGNvbmZpZ3VyYXRpb25zXG4gICAqL1xuICBnZXRBbGxDb25maWdzKCkge1xuICAgIHJldHVybiBPYmplY3QuZnJvbUVudHJpZXModGhpcy5sb2FkZWRDb25maWdzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNYW51YWxseSBsb2FkIGEgY29uZmlndXJhdGlvbiBmaWxlXG4gICAqL1xuICBhc3luYyBsb2FkQ29uZmlnKGZpbGVQYXRoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbmZpZ1R5cGUgPSB0aGlzLmdldENvbmZpZ1R5cGVGcm9tUGF0aChmaWxlUGF0aCk7XG4gICAgICBjb25zdCBjb25maWcgPSBhd2FpdCB0aGlzLnJlYWRDb25maWdGaWxlKGZpbGVQYXRoKTtcbiAgICAgIFxuICAgICAgaWYgKGNvbmZpZykge1xuICAgICAgICBjb25zdCB2YWxpZGF0ZWRDb25maWcgPSBhd2FpdCB0aGlzLnZhbGlkYXRlQ29uZmlnKGNvbmZpZ1R5cGUsIGNvbmZpZyk7XG4gICAgICAgIGF3YWl0IHRoaXMuYXBwbHlDb25maWdDaGFuZ2UoY29uZmlnVHlwZSwgdmFsaWRhdGVkQ29uZmlnLCBmaWxlUGF0aCk7XG4gICAgICB9XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdGYWlsZWQgdG8gbG9hZCBjb25maWd1cmF0aW9uJywgeyBcbiAgICAgICAgZmlsZVBhdGgsIFxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSBcbiAgICAgIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBmaWxlIHN5c3RlbSBjaGFuZ2VzXG4gICAqL1xuICBhc3luYyBoYW5kbGVGaWxlQ2hhbmdlKGV2ZW50VHlwZSwgZmlsZVBhdGgpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY29uZmlnVHlwZSA9IHRoaXMuZ2V0Q29uZmlnVHlwZUZyb21QYXRoKGZpbGVQYXRoKTtcbiAgICAgIFxuICAgICAgaWYgKCFjb25maWdUeXBlKSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnSWdub3Jpbmcgbm9uLWNvbmZpZyBmaWxlJywgeyBmaWxlUGF0aCwgZXZlbnRUeXBlIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGxvZ2dlci5pbmZvKCdDb25maWd1cmF0aW9uIGZpbGUgY2hhbmdlZCcsIHsgXG4gICAgICAgIGV2ZW50VHlwZSwgXG4gICAgICAgIGZpbGVQYXRoLCBcbiAgICAgICAgY29uZmlnVHlwZSBcbiAgICAgIH0pO1xuXG4gICAgICBzd2l0Y2ggKGV2ZW50VHlwZSkge1xuICAgICAgY2FzZSAnYWRkJzpcbiAgICAgIGNhc2UgJ2NoYW5nZSc6XG4gICAgICAgIGF3YWl0IHRoaXMuaGFuZGxlQ29uZmlnVXBkYXRlKGNvbmZpZ1R5cGUsIGZpbGVQYXRoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICAgICAgXG4gICAgICBjYXNlICd1bmxpbmsnOlxuICAgICAgICBhd2FpdCB0aGlzLmhhbmRsZUNvbmZpZ1JlbW92YWwoY29uZmlnVHlwZSwgZmlsZVBhdGgpO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIFxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIGhhbmRsaW5nIGNvbmZpZ3VyYXRpb24gZmlsZSBjaGFuZ2UnLCB7XG4gICAgICAgIGV2ZW50VHlwZSxcbiAgICAgICAgZmlsZVBhdGgsXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlXG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgdGhpcy5lbWl0KCdlcnJvcicsIHtcbiAgICAgICAgdHlwZTogJ2NvbmZpZy1jaGFuZ2UtZXJyb3InLFxuICAgICAgICBldmVudFR5cGUsXG4gICAgICAgIGZpbGVQYXRoLFxuICAgICAgICBlcnJvclxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBjb25maWd1cmF0aW9uIGZpbGUgdXBkYXRlc1xuICAgKi9cbiAgYXN5bmMgaGFuZGxlQ29uZmlnVXBkYXRlKGNvbmZpZ1R5cGUsIGZpbGVQYXRoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNvbmZpZyA9IGF3YWl0IHRoaXMucmVhZENvbmZpZ0ZpbGUoZmlsZVBhdGgpO1xuICAgICAgXG4gICAgICBpZiAoIWNvbmZpZykge1xuICAgICAgICBsb2dnZXIud2FybignRW1wdHkgb3IgaW52YWxpZCBjb25maWd1cmF0aW9uIGZpbGUnLCB7IGZpbGVQYXRoIH0pO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIFN1YnN0aXR1dGUgZW52aXJvbm1lbnQgdmFyaWFibGVzXG4gICAgICBjb25zdCBjb25maWdXaXRoRW52VmFycyA9IHRoaXMuc3Vic3RpdHV0ZUVudmlyb25tZW50VmFyaWFibGVzKGNvbmZpZyk7XG5cbiAgICAgIC8vIFZhbGlkYXRlIGNvbmZpZ3VyYXRpb25cbiAgICAgIGNvbnN0IHZhbGlkYXRlZENvbmZpZyA9IGF3YWl0IHRoaXMudmFsaWRhdGVDb25maWcoY29uZmlnVHlwZSwgY29uZmlnV2l0aEVudlZhcnMpO1xuICAgICAgXG4gICAgICAvLyBBcHBseSBjaGFuZ2VzXG4gICAgICBhd2FpdCB0aGlzLmFwcGx5Q29uZmlnQ2hhbmdlKGNvbmZpZ1R5cGUsIHZhbGlkYXRlZENvbmZpZywgZmlsZVBhdGgpO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIHVwZGF0ZSBjb25maWd1cmF0aW9uJywge1xuICAgICAgICBjb25maWdUeXBlLFxuICAgICAgICBmaWxlUGF0aCxcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcbiAgICAgIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSBjb25maWd1cmF0aW9uIGZpbGUgcmVtb3ZhbFxuICAgKi9cbiAgYXN5bmMgaGFuZGxlQ29uZmlnUmVtb3ZhbChjb25maWdUeXBlLCBmaWxlUGF0aCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwcmV2aW91c0NvbmZpZyA9IHRoaXMubG9hZGVkQ29uZmlncy5nZXQoY29uZmlnVHlwZSk7XG4gICAgICBcbiAgICAgIGlmIChwcmV2aW91c0NvbmZpZykge1xuICAgICAgICB0aGlzLmxvYWRlZENvbmZpZ3MuZGVsZXRlKGNvbmZpZ1R5cGUpO1xuICAgICAgICBcbiAgICAgICAgbG9nZ2VyLmluZm8oJ0NvbmZpZ3VyYXRpb24gcmVtb3ZlZCcsIHsgY29uZmlnVHlwZSwgZmlsZVBhdGggfSk7XG4gICAgICAgIFxuICAgICAgICB0aGlzLmVtaXQoJ2NvbmZpZy1yZW1vdmVkJywge1xuICAgICAgICAgIGNvbmZpZ1R5cGUsXG4gICAgICAgICAgZmlsZVBhdGgsXG4gICAgICAgICAgcHJldmlvdXNDb25maWdcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciBoYW5kbGluZyBjb25maWd1cmF0aW9uIHJlbW92YWwnLCB7XG4gICAgICAgIGNvbmZpZ1R5cGUsXG4gICAgICAgIGZpbGVQYXRoLFxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZVxuICAgICAgfSk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQXBwbHkgdmFsaWRhdGVkIGNvbmZpZ3VyYXRpb24gY2hhbmdlc1xuICAgKi9cbiAgYXN5bmMgYXBwbHlDb25maWdDaGFuZ2UoY29uZmlnVHlwZSwgbmV3Q29uZmlnLCBmaWxlUGF0aCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBwcmV2aW91c0NvbmZpZyA9IHRoaXMubG9hZGVkQ29uZmlncy5nZXQoY29uZmlnVHlwZSk7XG4gICAgICBcbiAgICAgIC8vIFN0b3JlIG5ldyBjb25maWd1cmF0aW9uXG4gICAgICB0aGlzLmxvYWRlZENvbmZpZ3Muc2V0KGNvbmZpZ1R5cGUsIG5ld0NvbmZpZyk7XG4gICAgICBcbiAgICAgIGxvZ2dlci5pbmZvKCdDb25maWd1cmF0aW9uIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5Jywge1xuICAgICAgICBjb25maWdUeXBlLFxuICAgICAgICBmaWxlUGF0aCxcbiAgICAgICAgaGFzQ2hhbmdlczogSlNPTi5zdHJpbmdpZnkocHJldmlvdXNDb25maWcpICE9PSBKU09OLnN0cmluZ2lmeShuZXdDb25maWcpXG4gICAgICB9KTtcblxuICAgICAgLy8gRW1pdCBjb25maWd1cmF0aW9uIGNoYW5nZSBldmVudFxuICAgICAgdGhpcy5lbWl0KCdjb25maWctY2hhbmdlZCcsIHtcbiAgICAgICAgY29uZmlnVHlwZSxcbiAgICAgICAgZmlsZVBhdGgsXG4gICAgICAgIG5ld0NvbmZpZyxcbiAgICAgICAgcHJldmlvdXNDb25maWdcbiAgICAgIH0pO1xuICAgICAgXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGFwcGx5IGNvbmZpZ3VyYXRpb24gY2hhbmdlJywge1xuICAgICAgICBjb25maWdUeXBlLFxuICAgICAgICBmaWxlUGF0aCxcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcbiAgICAgIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlIGNvbmZpZ3VyYXRpb24gYWdhaW5zdCByZWdpc3RlcmVkIHNjaGVtYVxuICAgKi9cbiAgYXN5bmMgdmFsaWRhdGVDb25maWcoY29uZmlnVHlwZSwgY29uZmlnKSB7XG4gICAgY29uc3QgdmFsaWRhdG9yID0gdGhpcy52YWxpZGF0b3JzLmdldChjb25maWdUeXBlKTtcbiAgICBcbiAgICBpZiAoIXZhbGlkYXRvcikge1xuICAgICAgbG9nZ2VyLndhcm4oJ05vIHZhbGlkYXRvciBmb3VuZCBmb3IgY29uZmlnIHR5cGUnLCB7IGNvbmZpZ1R5cGUgfSk7XG4gICAgICByZXR1cm4gY29uZmlnO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGVycm9yLCB2YWx1ZSB9ID0gdmFsaWRhdG9yLnZhbGlkYXRlKGNvbmZpZywgeyBcbiAgICAgICAgYWJvcnRFYXJseTogZmFsc2UsXG4gICAgICAgIGFsbG93VW5rbm93bjogdHJ1ZSBcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgY29uc3QgdmFsaWRhdGlvbkVycm9yID0gbmV3IEVycm9yKGBDb25maWd1cmF0aW9uIHZhbGlkYXRpb24gZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgIHZhbGlkYXRpb25FcnJvci5kZXRhaWxzID0gZXJyb3IuZGV0YWlscztcbiAgICAgICAgdGhyb3cgdmFsaWRhdGlvbkVycm9yO1xuICAgICAgfVxuICAgICAgXG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgbG9nZ2VyLmVycm9yKCdDb25maWd1cmF0aW9uIHZhbGlkYXRpb24gZmFpbGVkJywge1xuICAgICAgICBjb25maWdUeXBlLFxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgZGV0YWlsczogZXJyb3IuZGV0YWlsc1xuICAgICAgfSk7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVhZCBhbmQgcGFyc2UgY29uZmlndXJhdGlvbiBmaWxlXG4gICAqL1xuICBhc3luYyByZWFkQ29uZmlnRmlsZShmaWxlUGF0aCkge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb250ZW50ID0gYXdhaXQgZnMucmVhZEZpbGUoZmlsZVBhdGgsICd1dGY4Jyk7XG4gICAgICBcbiAgICAgIGlmIChmaWxlUGF0aC5lbmRzV2l0aCgnLmpzb24nKSkge1xuICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShjb250ZW50KTtcbiAgICAgIH0gZWxzZSBpZiAoZmlsZVBhdGguZW5kc1dpdGgoJy5qcycpKSB7XG4gICAgICAgIC8vIENsZWFyIHJlcXVpcmUgY2FjaGUgZm9yIGhvdCByZWxvYWRpbmdcbiAgICAgICAgZGVsZXRlIHJlcXVpcmUuY2FjaGVbcmVxdWlyZS5yZXNvbHZlKGZpbGVQYXRoKV07XG4gICAgICAgIHJldHVybiByZXF1aXJlKGZpbGVQYXRoKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgICBcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdFTk9FTlQnKSB7XG4gICAgICAgIGxvZ2dlci5kZWJ1ZygnQ29uZmlndXJhdGlvbiBmaWxlIG5vdCBmb3VuZCcsIHsgZmlsZVBhdGggfSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgXG4gICAgICBsb2dnZXIuZXJyb3IoJ0Vycm9yIHJlYWRpbmcgY29uZmlndXJhdGlvbiBmaWxlJywge1xuICAgICAgICBmaWxlUGF0aCxcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2VcbiAgICAgIH0pO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIERldGVybWluZSBjb25maWd1cmF0aW9uIHR5cGUgZnJvbSBmaWxlIHBhdGhcbiAgICovXG4gIGdldENvbmZpZ1R5cGVGcm9tUGF0aChmaWxlUGF0aCkge1xuICAgIGNvbnN0IGJhc2VuYW1lID0gcGF0aC5iYXNlbmFtZShmaWxlUGF0aCwgcGF0aC5leHRuYW1lKGZpbGVQYXRoKSk7XG4gICAgY29uc3QgdmFsaWRUeXBlcyA9IFsnc291cmNlcycsICdpbmdlc3Rpb24nLCAncXVldWUnLCAnZW5yaWNobWVudCddO1xuICAgIFxuICAgIHJldHVybiB2YWxpZFR5cGVzLmZpbmQodHlwZSA9PiBiYXNlbmFtZS5pbmNsdWRlcyh0eXBlKSkgfHwgbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBFbnN1cmUgY29uZmlndXJhdGlvbiBkaXJlY3RvcnkgZXhpc3RzXG4gICAqL1xuICBhc3luYyBlbnN1cmVDb25maWdEaXJlY3RvcnkoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGZzLmFjY2Vzcyh0aGlzLmNvbmZpZ0Rpcik7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGlmIChlcnJvci5jb2RlID09PSAnRU5PRU5UJykge1xuICAgICAgICBhd2FpdCBmcy5ta2Rpcih0aGlzLmNvbmZpZ0RpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgICAgIGxvZ2dlci5pbmZvKCdDcmVhdGVkIGNvbmZpZ3VyYXRpb24gZGlyZWN0b3J5JywgeyBjb25maWdEaXI6IHRoaXMuY29uZmlnRGlyIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEhhbmRsZSB3YXRjaGVyIGVycm9yc1xuICAgKi9cbiAgaGFuZGxlV2F0Y2hlckVycm9yKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKCdDb25maWdNYW5hZ2VyIHdhdGNoZXIgZXJyb3InLCB7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0pO1xuICAgIHRoaXMuZW1pdCgnZXJyb3InLCB7XG4gICAgICB0eXBlOiAnd2F0Y2hlci1lcnJvcicsXG4gICAgICBlcnJvclxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBzb3VyY2UgY29uZmlndXJhdGlvbiBzY2hlbWFcbiAgICovXG4gIGdldFNvdXJjZUNvbmZpZ1NjaGVtYSgpIHtcbiAgICByZXR1cm4gSm9pLm9iamVjdCh7XG4gICAgICBzb3VyY2VzOiBKb2kuYXJyYXkoKS5pdGVtcyhcbiAgICAgICAgSm9pLm9iamVjdCh7XG4gICAgICAgICAgaWQ6IEpvaS5zdHJpbmcoKS5yZXF1aXJlZCgpLFxuICAgICAgICAgIHR5cGU6IEpvaS5zdHJpbmcoKS52YWxpZCgnc3RhdGljJywgJ3NlbWktc3RhdGljJywgJ2R5bmFtaWMtY29uc2lzdGVudCcsICdkeW5hbWljLXVuc3RydWN0dXJlZCcpLnJlcXVpcmVkKCksXG4gICAgICAgICAgbmFtZTogSm9pLnN0cmluZygpLnJlcXVpcmVkKCksXG4gICAgICAgICAgZW5hYmxlZDogSm9pLmJvb2xlYW4oKS5kZWZhdWx0KHRydWUpLFxuICAgICAgICAgIGNvbmZpZzogSm9pLm9iamVjdCgpLnJlcXVpcmVkKCksXG4gICAgICAgICAgc2NoZWR1bGU6IEpvaS5zdHJpbmcoKS53aGVuKCd0eXBlJywge1xuICAgICAgICAgICAgaXM6IEpvaS5zdHJpbmcoKS52YWxpZCgnc2VtaS1zdGF0aWMnLCAnZHluYW1pYy1jb25zaXN0ZW50JywgJ2R5bmFtaWMtdW5zdHJ1Y3R1cmVkJyksXG4gICAgICAgICAgICB0aGVuOiBKb2kucmVxdWlyZWQoKSxcbiAgICAgICAgICAgIG90aGVyd2lzZTogSm9pLm9wdGlvbmFsKClcbiAgICAgICAgICB9KVxuICAgICAgICB9KVxuICAgICAgKS5yZXF1aXJlZCgpXG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IGluZ2VzdGlvbiBjb25maWd1cmF0aW9uIHNjaGVtYVxuICAgKi9cbiAgZ2V0SW5nZXN0aW9uQ29uZmlnU2NoZW1hKCkge1xuICAgIHJldHVybiBKb2kub2JqZWN0KHtcbiAgICAgIGJhdGNoU2l6ZTogSm9pLm51bWJlcigpLmludGVnZXIoKS5taW4oMSkubWF4KDEwMDApLmRlZmF1bHQoMTAwKSxcbiAgICAgIG1heFJldHJpZXM6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCkubWluKDApLm1heCgxMCkuZGVmYXVsdCgzKSxcbiAgICAgIHJldHJ5RGVsYXk6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCkubWluKDEwMDApLmRlZmF1bHQoNTAwMCksXG4gICAgICB0aW1lb3V0OiBKb2kubnVtYmVyKCkuaW50ZWdlcigpLm1pbig1MDAwKS5kZWZhdWx0KDMwMDAwKSxcbiAgICAgIGNvbmN1cnJlbmN5OiBKb2kubnVtYmVyKCkuaW50ZWdlcigpLm1pbigxKS5tYXgoMTApLmRlZmF1bHQoMyksXG4gICAgICBlbmFibGVWYWxpZGF0aW9uOiBKb2kuYm9vbGVhbigpLmRlZmF1bHQodHJ1ZSksXG4gICAgICBvdXRwdXRGb3JtYXQ6IEpvaS5zdHJpbmcoKS52YWxpZCgnanNvbicsICdqc29ubCcpLmRlZmF1bHQoJ2pzb24nKVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBxdWV1ZSBjb25maWd1cmF0aW9uIHNjaGVtYVxuICAgKi9cbiAgZ2V0UXVldWVDb25maWdTY2hlbWEoKSB7XG4gICAgcmV0dXJuIEpvaS5vYmplY3Qoe1xuICAgICAgcmVkaXM6IEpvaS5vYmplY3Qoe1xuICAgICAgICBob3N0OiBKb2kuc3RyaW5nKCkuZGVmYXVsdCgnbG9jYWxob3N0JyksXG4gICAgICAgIHBvcnQ6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCkubWluKDEpLm1heCg2NTUzNSkuZGVmYXVsdCg2Mzc5KSxcbiAgICAgICAgcGFzc3dvcmQ6IEpvaS5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgICBkYjogSm9pLm51bWJlcigpLmludGVnZXIoKS5taW4oMCkuZGVmYXVsdCgwKVxuICAgICAgfSkuZGVmYXVsdCgpLFxuICAgICAgcXVldWVzOiBKb2kub2JqZWN0KHtcbiAgICAgICAgZGVmYXVsdEpvYk9wdGlvbnM6IEpvaS5vYmplY3Qoe1xuICAgICAgICAgIHJlbW92ZU9uQ29tcGxldGU6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCkubWluKDApLmRlZmF1bHQoMTAwKSxcbiAgICAgICAgICByZW1vdmVPbkZhaWw6IEpvaS5udW1iZXIoKS5pbnRlZ2VyKCkubWluKDApLmRlZmF1bHQoNTApLFxuICAgICAgICAgIGF0dGVtcHRzOiBKb2kubnVtYmVyKCkuaW50ZWdlcigpLm1pbigxKS5kZWZhdWx0KDMpLFxuICAgICAgICAgIGJhY2tvZmY6IEpvaS5vYmplY3Qoe1xuICAgICAgICAgICAgdHlwZTogSm9pLnN0cmluZygpLnZhbGlkKCdmaXhlZCcsICdleHBvbmVudGlhbCcpLmRlZmF1bHQoJ2V4cG9uZW50aWFsJyksXG4gICAgICAgICAgICBkZWxheTogSm9pLm51bWJlcigpLmludGVnZXIoKS5taW4oMTAwMCkuZGVmYXVsdCgyMDAwKVxuICAgICAgICAgIH0pLmRlZmF1bHQoKVxuICAgICAgICB9KS5kZWZhdWx0KCksXG4gICAgICAgIGNvbmN1cnJlbmN5OiBKb2kubnVtYmVyKCkuaW50ZWdlcigpLm1pbigxKS5tYXgoNTApLmRlZmF1bHQoNSlcbiAgICAgIH0pLmRlZmF1bHQoKVxuICAgIH0pO1xuICB9XG5cbiAgLyoqXG4gICAqIEdldCBjb25maWd1cmF0aW9uIHN0YXRpc3RpY3NcbiAgICovXG4gIGdldFN0YXRzKCkge1xuICAgIHJldHVybiB7XG4gICAgICBpc1dhdGNoaW5nOiB0aGlzLmlzV2F0Y2hpbmcsXG4gICAgICBjb25maWdEaXI6IHRoaXMuY29uZmlnRGlyLFxuICAgICAgY29uZmlnQ291bnQ6IHRoaXMubG9hZGVkQ29uZmlncy5zaXplLFxuICAgICAgdmFsaWRhdG9yQ291bnQ6IHRoaXMudmFsaWRhdG9ycy5zaXplLFxuICAgICAgY29uZmlnVHlwZXM6IEFycmF5LmZyb20odGhpcy5sb2FkZWRDb25maWdzLmtleXMoKSlcbiAgICB9O1xuICB9XG5cbiAgLyoqXG4gICAqIFN1YnN0aXR1dGUgZW52aXJvbm1lbnQgdmFyaWFibGVzIGluIGNvbmZpZ3VyYXRpb25cbiAgICovXG4gIHN1YnN0aXR1dGVFbnZpcm9ubWVudFZhcmlhYmxlcyhjb25maWcpIHtcbiAgICBjb25zdCBlbnZSZWdleCA9IC9cXCR7KFtefV0rKX0vZztcbiAgICByZXR1cm4gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShjb25maWcpLnJlcGxhY2UoZW52UmVnZXgsIChtYXRjaCwgdmFyTmFtZSkgPT4gcHJvY2Vzcy5lbnZbdmFyTmFtZV0gfHwgbWF0Y2gpKTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IENvbmZpZ01hbmFnZXI7Il0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxRQUFRLEdBQUdDLE9BQU8sQ0FBQyxVQUFVLENBQUM7QUFDcEMsTUFBTUMsSUFBSSxHQUFHRCxPQUFPLENBQUMsTUFBTSxDQUFDO0FBQzVCLE1BQU1FLEVBQUUsR0FBR0YsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDRyxRQUFRO0FBQ2pDLE1BQU1DLFlBQVksR0FBR0osT0FBTyxDQUFDLFFBQVEsQ0FBQztBQUN0QyxNQUFNSyxHQUFHLEdBQUdMLE9BQU8sQ0FBQyxLQUFLLENBQUM7QUFDMUIsTUFBTU0sTUFBTSxHQUFHTixPQUFPLENBQUMsaUJBQWlCLENBQUM7O0FBRXpDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTU8sYUFBYSxTQUFTSCxZQUFZLENBQUM7RUFDdkNJLFdBQVdBLENBQUNDLE9BQU8sR0FBRyxDQUFDLENBQUMsRUFBRTtJQUN4QixLQUFLLENBQUMsQ0FBQztJQUVQLElBQUksQ0FBQ0MsU0FBUyxHQUFHRCxPQUFPLENBQUNDLFNBQVMsSUFBSVQsSUFBSSxDQUFDVSxJQUFJLENBQUNDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLENBQUMsRUFBRSxRQUFRLENBQUM7SUFDeEUsSUFBSSxDQUFDQyxZQUFZLEdBQUdMLE9B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